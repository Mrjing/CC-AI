'use strict';function _0x2b75(){var _0x3bb085=['onQueueDrained','midjourneyService','metadata','\x20jobs\x20of\x20type\x20','Logger','onQueueActive','23640RUPZWQ','1566520WkjdeA','MJDRAW','Queue\x20failed:\x20','__decorate','decorate','OnQueuePaused','4058418AQIWjI','9wbgwTR','design:returntype','35565PTggQv','队列发生错误','759CzOcQp','390101Jogxas','design:type','OnQueueDrained','2oyDCDF','22380gNwvyo','message','onQueueProgress','length','队列恢复的时候调用','mjDraw','logger','OnQueueFailed','__esModule','design:paramtypes','Queue\x20cleaned:\x20','534OiiZOm','3140630RQXJlx','onQueueCleaned','defineProperty','../midjourney/midjourney.service','\x20were\x20cleaned.','Process','__metadata','draw','object','256CARcXQ','Processor','drawFailed','onQueueCompleted','onQueueResumed','QueueProcessor','function','handleJob','CONCURRENCY','OnQueueError','OnQueueCleaned','@nestjs/bull','onQueuePaused','OnQueueResumed','prototype','onQueueFailed',':\x20绘画失败\x20','log','MidjourneyService','env','error','队列暂停的时候调用'];_0x2b75=function(){return _0x3bb085;};return _0x2b75();}var _0x4ed6a4=_0x4710;(function(_0x272b86,_0x1a50ef){var _0x45f398=_0x4710,_0x5c4d25=_0x272b86();while(!![]){try{var _0x2b5586=-parseInt(_0x45f398(0xe1))/0x1*(-parseInt(_0x45f398(0xe4))/0x2)+-parseInt(_0x45f398(0xd4))/0x3*(-parseInt(_0x45f398(0xfa))/0x4)+-parseInt(_0x45f398(0xde))/0x5*(parseInt(_0x45f398(0xf0))/0x6)+-parseInt(_0x45f398(0xdb))/0x7+parseInt(_0x45f398(0xd5))/0x8+-parseInt(_0x45f398(0xdc))/0x9*(-parseInt(_0x45f398(0xf1))/0xa)+-parseInt(_0x45f398(0xe0))/0xb*(-parseInt(_0x45f398(0xe5))/0xc);if(_0x2b5586===_0x1a50ef)break;else _0x5c4d25['push'](_0x5c4d25['shift']());}catch(_0x45f241){_0x5c4d25['push'](_0x5c4d25['shift']());}}}(_0x2b75,0x4e299));var __decorate=this&&this[_0x4ed6a4(0xd8)]||function(_0x2864e0,_0x59d545,_0x3fe146,_0x3b15ac){var _0x61c765=_0x4ed6a4,_0x3c87e2=arguments[_0x61c765(0xe8)],_0x3bb491=_0x3c87e2<0x3?_0x59d545:_0x3b15ac===null?_0x3b15ac=Object['getOwnPropertyDescriptor'](_0x59d545,_0x3fe146):_0x3b15ac,_0x3ed2a0;if(typeof Reflect==='object'&&typeof Reflect[_0x61c765(0xd9)]===_0x61c765(0xbe))_0x3bb491=Reflect[_0x61c765(0xd9)](_0x2864e0,_0x59d545,_0x3fe146,_0x3b15ac);else{for(var _0xe0f325=_0x2864e0['length']-0x1;_0xe0f325>=0x0;_0xe0f325--)if(_0x3ed2a0=_0x2864e0[_0xe0f325])_0x3bb491=(_0x3c87e2<0x3?_0x3ed2a0(_0x3bb491):_0x3c87e2>0x3?_0x3ed2a0(_0x59d545,_0x3fe146,_0x3bb491):_0x3ed2a0(_0x59d545,_0x3fe146))||_0x3bb491;}return _0x3c87e2>0x3&&_0x3bb491&&Object[_0x61c765(0xf3)](_0x59d545,_0x3fe146,_0x3bb491),_0x3bb491;},__metadata=this&&this[_0x4ed6a4(0xf7)]||function(_0xc74128,_0x133df7){var _0x21cccb=_0x4ed6a4;if(typeof Reflect===_0x21cccb(0xf9)&&typeof Reflect[_0x21cccb(0xd0)]===_0x21cccb(0xbe))return Reflect[_0x21cccb(0xd0)](_0xc74128,_0x133df7);},QueueProcessor_1;Object[_0x4ed6a4(0xf3)](exports,_0x4ed6a4(0xed),{'value':!![]}),exports['QueueProcessor']=void 0x0;const bull_1=require(_0x4ed6a4(0xc3)),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x4ed6a4(0xf4));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x1043d9){var _0x1cbf71=_0x4ed6a4;this[_0x1cbf71(0xcf)]=_0x1043d9,this[_0x1cbf71(0xeb)]=new common_1['Logger'](QueueProcessor_1['name']);}async[_0x4ed6a4(0xbf)](_0x102d22){var _0x485a9e=_0x4ed6a4;const _0x39a83a=await this[_0x485a9e(0xcf)][_0x485a9e(0xf8)](_0x102d22['data'],_0x102d22['id']);return _0x39a83a;}[_0x4ed6a4(0xd3)](_0x3f11d8){}['onQueueError'](_0x12697d){var _0x3d392b=_0x4ed6a4;console[_0x3d392b(0xc9)](_0x3d392b(0xdf),_0x12697d);}['onQueueProgress'](_0x29e810,_0x529acf){var _0x5b23a8=_0x4ed6a4;console[_0x5b23a8(0xc9)]('队列任务的一个回调用于通知当前进度',_0x29e810['id'],_0x529acf);}[_0x4ed6a4(0xfd)](_0x419cf2,_0xc5495c){}[_0x4ed6a4(0xc7)](_0x29fc4f,_0x371dfc){var _0x485872=_0x4ed6a4;common_1[_0x485872(0xd2)][_0x485872(0xcc)](_0x485872(0xd7)+_0x371dfc[_0x485872(0xe6)]+_0x485872(0xc8)+_0x29fc4f['id'],'QueueProcessor'),this['midjourneyService'][_0x485872(0xfc)](_0x29fc4f['data']);}[_0x4ed6a4(0xc4)](){var _0x2dbbea=_0x4ed6a4;console[_0x2dbbea(0xc9)](_0x2dbbea(0xcd));}[_0x4ed6a4(0xfe)](){var _0x52af31=_0x4ed6a4;console[_0x52af31(0xc9)](_0x52af31(0xe9));}[_0x4ed6a4(0xf2)](_0x60aa64,_0x31413c){var _0x44ee71=_0x4ed6a4;common_1['Logger'][_0x44ee71(0xc9)](_0x44ee71(0xef)+_0x60aa64[_0x44ee71(0xe8)]+_0x44ee71(0xd1)+_0x31413c+_0x44ee71(0xf5),_0x44ee71(0xbd));}[_0x4ed6a4(0xce)](){}};function _0x4710(_0x18f6a6,_0x2a3647){var _0x2b753d=_0x2b75();return _0x4710=function(_0x471034,_0x31f83d){_0x471034=_0x471034-0xbd;var _0xf5baab=_0x2b753d[_0x471034];return _0xf5baab;},_0x4710(_0x18f6a6,_0x2a3647);}__decorate([(0x0,bull_1[_0x4ed6a4(0xf6)])({'name':_0x4ed6a4(0xea),'concurrency':process[_0x4ed6a4(0xcb)][_0x4ed6a4(0xc0)]?+process['env'][_0x4ed6a4(0xc0)]:0x3}),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Object]),__metadata(_0x4ed6a4(0xdd),Promise)],QueueProcessor[_0x4ed6a4(0xc6)],'handleJob',null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata('design:type',Function),__metadata(_0x4ed6a4(0xee),[Object]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor[_0x4ed6a4(0xc6)],'onQueueActive',null),__decorate([(0x0,bull_1[_0x4ed6a4(0xc1)])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Error]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor['prototype'],'onQueueError',null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Object,Number]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor[_0x4ed6a4(0xc6)],_0x4ed6a4(0xe7),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x4ed6a4(0xfd),null),__decorate([(0x0,bull_1[_0x4ed6a4(0xec)])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Object,Error]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor[_0x4ed6a4(0xc6)],_0x4ed6a4(0xc7),null),__decorate([(0x0,bull_1[_0x4ed6a4(0xda)])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],'onQueuePaused',null),__decorate([(0x0,bull_1[_0x4ed6a4(0xc5)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor[_0x4ed6a4(0xc6)],_0x4ed6a4(0xfe),null),__decorate([(0x0,bull_1[_0x4ed6a4(0xc2)])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata(_0x4ed6a4(0xee),[Array,String]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x4ed6a4(0xc6)],_0x4ed6a4(0xf2),null),__decorate([(0x0,bull_1[_0x4ed6a4(0xe3)])(),__metadata(_0x4ed6a4(0xe2),Function),__metadata('design:paramtypes',[]),__metadata(_0x4ed6a4(0xdd),void 0x0)],QueueProcessor['prototype'],_0x4ed6a4(0xce),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x4ed6a4(0xfb)])(_0x4ed6a4(0xd6)),__metadata(_0x4ed6a4(0xee),[midjourney_service_1[_0x4ed6a4(0xca)]])],QueueProcessor),exports[_0x4ed6a4(0xbd)]=QueueProcessor;