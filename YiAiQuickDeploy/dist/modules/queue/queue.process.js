'use strict';var _0x1e8830=_0xae2a;(function(_0x3ef476,_0x4d1259){var _0x40a8af=_0xae2a,_0x58c215=_0x3ef476();while(!![]){try{var _0x56b375=-parseInt(_0x40a8af(0x175))/0x1+-parseInt(_0x40a8af(0x169))/0x2*(-parseInt(_0x40a8af(0x16c))/0x3)+-parseInt(_0x40a8af(0x147))/0x4*(parseInt(_0x40a8af(0x173))/0x5)+parseInt(_0x40a8af(0x172))/0x6*(parseInt(_0x40a8af(0x177))/0x7)+-parseInt(_0x40a8af(0x158))/0x8*(-parseInt(_0x40a8af(0x15f))/0x9)+parseInt(_0x40a8af(0x151))/0xa+-parseInt(_0x40a8af(0x168))/0xb;if(_0x56b375===_0x4d1259)break;else _0x58c215['push'](_0x58c215['shift']());}catch(_0x1064df){_0x58c215['push'](_0x58c215['shift']());}}}(_0x4a65,0xf40bc));function _0x4a65(){var _0x54aee1=['onQueueProgress','drawFailed','__esModule','handleJob','9dFfSwI','function','onQueueCompleted','__metadata','@nestjs/bull','onQueueFailed','logger','\x20jobs\x20of\x20type\x20','prototype','19001510erGRiB','422cqPpfi','message',':\x20绘画失败\x20','2577LrqOir','Processor','onQueueError','Queue\x20cleaned:\x20','error','design:type','3036QNEPki','4517860DbRdtD','队列暂停的时候调用','371723yNUCMg','metadata','22778NorVqs','OnQueueResumed','onQueueActive','data','@nestjs/common','onQueuePaused','log','onQueueCleaned','object','队列发生错误','MidjourneyService','OnQueueCleaned','design:returntype','QueueProcessor','onQueueResumed','4zljFIi','draw','env','onQueueDrained','Logger','MJDRAW','OnQueueDrained','defineProperty','getOwnPropertyDescriptor','length','19145170hLjoEQ','design:paramtypes','OnQueueCompleted','decorate','Queue\x20failed:\x20','midjourneyService','OnQueueProgress','2080216uzqpjl','__decorate','name'];_0x4a65=function(){return _0x54aee1;};return _0x4a65();}function _0xae2a(_0x15778d,_0x67dd01){var _0x4a65e7=_0x4a65();return _0xae2a=function(_0xae2abd,_0x189302){_0xae2abd=_0xae2abd-0x147;var _0xb22b65=_0x4a65e7[_0xae2abd];return _0xb22b65;},_0xae2a(_0x15778d,_0x67dd01);}var __decorate=this&&this[_0x1e8830(0x159)]||function(_0x502982,_0xe9551b,_0x274c07,_0x1d2e88){var _0x4ab404=_0x1e8830,_0x572b20=arguments[_0x4ab404(0x150)],_0x1a8017=_0x572b20<0x3?_0xe9551b:_0x1d2e88===null?_0x1d2e88=Object[_0x4ab404(0x14f)](_0xe9551b,_0x274c07):_0x1d2e88,_0x172b22;if(typeof Reflect===_0x4ab404(0x17f)&&typeof Reflect[_0x4ab404(0x154)]===_0x4ab404(0x160))_0x1a8017=Reflect['decorate'](_0x502982,_0xe9551b,_0x274c07,_0x1d2e88);else{for(var _0xf843a9=_0x502982[_0x4ab404(0x150)]-0x1;_0xf843a9>=0x0;_0xf843a9--)if(_0x172b22=_0x502982[_0xf843a9])_0x1a8017=(_0x572b20<0x3?_0x172b22(_0x1a8017):_0x572b20>0x3?_0x172b22(_0xe9551b,_0x274c07,_0x1a8017):_0x172b22(_0xe9551b,_0x274c07))||_0x1a8017;}return _0x572b20>0x3&&_0x1a8017&&Object['defineProperty'](_0xe9551b,_0x274c07,_0x1a8017),_0x1a8017;},__metadata=this&&this[_0x1e8830(0x162)]||function(_0x2a0585,_0x5f0c97){var _0x9e49c3=_0x1e8830;if(typeof Reflect===_0x9e49c3(0x17f)&&typeof Reflect['metadata']===_0x9e49c3(0x160))return Reflect[_0x9e49c3(0x176)](_0x2a0585,_0x5f0c97);},QueueProcessor_1;Object[_0x1e8830(0x14e)](exports,_0x1e8830(0x15d),{'value':!![]}),exports[_0x1e8830(0x184)]=void 0x0;const bull_1=require(_0x1e8830(0x163)),common_1=require(_0x1e8830(0x17b)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x998abc){var _0x323821=_0x1e8830;this[_0x323821(0x156)]=_0x998abc,this[_0x323821(0x165)]=new common_1['Logger'](QueueProcessor_1[_0x323821(0x15a)]);}async[_0x1e8830(0x15e)](_0x2b9502){var _0x579a67=_0x1e8830;const _0x14a9ab=await this[_0x579a67(0x156)][_0x579a67(0x148)](_0x2b9502[_0x579a67(0x17a)],_0x2b9502['id']);return _0x14a9ab;}[_0x1e8830(0x179)](_0x75b489){}['onQueueError'](_0x2402e4){var _0x1cd04a=_0x1e8830;console['log'](_0x1cd04a(0x180),_0x2402e4);}[_0x1e8830(0x15b)](_0x5123f2,_0x230f2f){var _0x155024=_0x1e8830;console[_0x155024(0x17d)]('队列任务的一个回调用于通知当前进度',_0x5123f2['id'],_0x230f2f);}[_0x1e8830(0x161)](_0x4959a7,_0x321328){}[_0x1e8830(0x164)](_0x31ba14,_0x2fe618){var _0x5f1f34=_0x1e8830;common_1['Logger'][_0x5f1f34(0x170)](_0x5f1f34(0x155)+_0x2fe618[_0x5f1f34(0x16a)]+_0x5f1f34(0x16b)+_0x31ba14['id'],_0x5f1f34(0x184)),this[_0x5f1f34(0x156)][_0x5f1f34(0x15c)](_0x31ba14[_0x5f1f34(0x17a)]);}[_0x1e8830(0x17c)](){var _0x23ba47=_0x1e8830;console['log'](_0x23ba47(0x174));}[_0x1e8830(0x185)](){var _0x4965d1=_0x1e8830;console[_0x4965d1(0x17d)]('队列恢复的时候调用');}[_0x1e8830(0x17e)](_0x145e10,_0xf2d1ba){var _0x5b28be=_0x1e8830;common_1[_0x5b28be(0x14b)]['log'](_0x5b28be(0x16f)+_0x145e10[_0x5b28be(0x150)]+_0x5b28be(0x166)+_0xf2d1ba+'\x20were\x20cleaned.','QueueProcessor');}[_0x1e8830(0x14a)](){}};__decorate([(0x0,bull_1['Process'])({'name':'mjDraw','concurrency':process[_0x1e8830(0x149)]['CONCURRENCY']?+process[_0x1e8830(0x149)]['CONCURRENCY']:0x3}),__metadata(_0x1e8830(0x171),Function),__metadata(_0x1e8830(0x152),[Object]),__metadata(_0x1e8830(0x183),Promise)],QueueProcessor[_0x1e8830(0x167)],_0x1e8830(0x15e),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x1e8830(0x171),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],'onQueueActive',null),__decorate([(0x0,bull_1['OnQueueError'])(),__metadata(_0x1e8830(0x171),Function),__metadata(_0x1e8830(0x152),[Error]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],_0x1e8830(0x16e),null),__decorate([(0x0,bull_1[_0x1e8830(0x157)])(),__metadata(_0x1e8830(0x171),Function),__metadata(_0x1e8830(0x152),[Object,Number]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x1e8830(0x153)])(),__metadata('design:type',Function),__metadata(_0x1e8830(0x152),[Object,Object]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],_0x1e8830(0x161),null),__decorate([(0x0,bull_1['OnQueueFailed'])(),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,Error]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],_0x1e8830(0x164),null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata(_0x1e8830(0x171),Function),__metadata('design:paramtypes',[]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor['prototype'],_0x1e8830(0x17c),null),__decorate([(0x0,bull_1[_0x1e8830(0x178)])(),__metadata(_0x1e8830(0x171),Function),__metadata(_0x1e8830(0x152),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x1e8830(0x167)],_0x1e8830(0x185),null),__decorate([(0x0,bull_1[_0x1e8830(0x182)])(),__metadata(_0x1e8830(0x171),Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor['prototype'],'onQueueCleaned',null),__decorate([(0x0,bull_1[_0x1e8830(0x14d)])(),__metadata(_0x1e8830(0x171),Function),__metadata(_0x1e8830(0x152),[]),__metadata(_0x1e8830(0x183),void 0x0)],QueueProcessor[_0x1e8830(0x167)],'onQueueDrained',null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x1e8830(0x16d)])(_0x1e8830(0x14c)),__metadata(_0x1e8830(0x152),[midjourney_service_1[_0x1e8830(0x181)]])],QueueProcessor),exports[_0x1e8830(0x184)]=QueueProcessor;