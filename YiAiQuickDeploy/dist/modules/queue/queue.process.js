'use strict';function _0x4d20(){var _0x504f5b=['prototype','logger','log','onQueueProgress','4181664hKmzib','onQueueResumed','onQueuePaused','4337883spPZFX','78NntySl','design:type','design:returntype','CONCURRENCY',':\x20绘画失败\x20','decorate','OnQueueError','21638kjJmaA','onQueueFailed','OnQueueActive','handleJob','OnQueueDrained','346878AsbVki','\x20were\x20cleaned.','mjDraw','__esModule','OnQueueCompleted','draw','56rwMsdv','OnQueueCleaned','Queue\x20cleaned:\x20','MJDRAW','env','midjourneyService','10295136RbKtGi','message','QueueProcessor','onQueueActive','93xsoYTi','\x20jobs\x20of\x20type\x20','onQueueError','getOwnPropertyDescriptor','object','204115yBHDuF','@nestjs/common','队列暂停的时候调用','OnQueuePaused','MidjourneyService','error','length','Process','design:paramtypes','drawFailed','onQueueCleaned','Logger','function','metadata','队列恢复的时候调用','23412770YOnnvY','__metadata','onQueueCompleted'];_0x4d20=function(){return _0x504f5b;};return _0x4d20();}function _0x5187(_0x4019f2,_0x10ce57){var _0x4d2069=_0x4d20();return _0x5187=function(_0x51878e,_0x38bd8b){_0x51878e=_0x51878e-0x6d;var _0x2ef3e1=_0x4d2069[_0x51878e];return _0x2ef3e1;},_0x5187(_0x4019f2,_0x10ce57);}var _0x4c7876=_0x5187;(function(_0x2b49b,_0x299415){var _0x27ee6a=_0x5187,_0x492fc5=_0x2b49b();while(!![]){try{var _0x594137=parseInt(_0x27ee6a(0x81))/0x1*(-parseInt(_0x27ee6a(0xa7))/0x2)+-parseInt(_0x27ee6a(0x9c))/0x3+-parseInt(_0x27ee6a(0x77))/0x4*(parseInt(_0x27ee6a(0x86))/0x5)+parseInt(_0x27ee6a(0xa0))/0x6*(parseInt(_0x27ee6a(0x71))/0x7)+parseInt(_0x27ee6a(0x7d))/0x8+-parseInt(_0x27ee6a(0x9f))/0x9+parseInt(_0x27ee6a(0x95))/0xa;if(_0x594137===_0x299415)break;else _0x492fc5['push'](_0x492fc5['shift']());}catch(_0x508eca){_0x492fc5['push'](_0x492fc5['shift']());}}}(_0x4d20,0xc7e77));var __decorate=this&&this['__decorate']||function(_0x363be0,_0x3a7448,_0x12e367,_0xad046){var _0x475386=_0x5187,_0x4f5bb2=arguments['length'],_0x1823b9=_0x4f5bb2<0x3?_0x3a7448:_0xad046===null?_0xad046=Object[_0x475386(0x84)](_0x3a7448,_0x12e367):_0xad046,_0xe2c297;if(typeof Reflect===_0x475386(0x85)&&typeof Reflect[_0x475386(0xa5)]===_0x475386(0x92))_0x1823b9=Reflect[_0x475386(0xa5)](_0x363be0,_0x3a7448,_0x12e367,_0xad046);else{for(var _0x54ed19=_0x363be0['length']-0x1;_0x54ed19>=0x0;_0x54ed19--)if(_0xe2c297=_0x363be0[_0x54ed19])_0x1823b9=(_0x4f5bb2<0x3?_0xe2c297(_0x1823b9):_0x4f5bb2>0x3?_0xe2c297(_0x3a7448,_0x12e367,_0x1823b9):_0xe2c297(_0x3a7448,_0x12e367))||_0x1823b9;}return _0x4f5bb2>0x3&&_0x1823b9&&Object['defineProperty'](_0x3a7448,_0x12e367,_0x1823b9),_0x1823b9;},__metadata=this&&this[_0x4c7876(0x96)]||function(_0x517099,_0x67f795){var _0x6d4652=_0x4c7876;if(typeof Reflect==='object'&&typeof Reflect[_0x6d4652(0x93)]==='function')return Reflect['metadata'](_0x517099,_0x67f795);},QueueProcessor_1;Object['defineProperty'](exports,_0x4c7876(0x74),{'value':!![]}),exports[_0x4c7876(0x7f)]=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require(_0x4c7876(0x87)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x13ee49){var _0xb50937=_0x4c7876;this[_0xb50937(0x7c)]=_0x13ee49,this[_0xb50937(0x99)]=new common_1[(_0xb50937(0x91))](QueueProcessor_1['name']);}async[_0x4c7876(0x6f)](_0x5c276c){var _0x305703=_0x4c7876;const _0x59ac0b=await this[_0x305703(0x7c)][_0x305703(0x76)](_0x5c276c['data'],_0x5c276c['id']);return _0x59ac0b;}['onQueueActive'](_0x425b73){}[_0x4c7876(0x83)](_0x4e7462){var _0x535c5d=_0x4c7876;console[_0x535c5d(0x9a)]('队列发生错误',_0x4e7462);}['onQueueProgress'](_0x55e247,_0xca4912){var _0x625b98=_0x4c7876;console[_0x625b98(0x9a)]('队列任务的一个回调用于通知当前进度',_0x55e247['id'],_0xca4912);}['onQueueCompleted'](_0x2b1018,_0x4ff655){}[_0x4c7876(0x6d)](_0x3f69e5,_0x606e2a){var _0x332a7c=_0x4c7876;common_1[_0x332a7c(0x91)][_0x332a7c(0x8b)]('Queue\x20failed:\x20'+_0x606e2a[_0x332a7c(0x7e)]+_0x332a7c(0xa4)+_0x3f69e5['id'],_0x332a7c(0x7f)),this['midjourneyService'][_0x332a7c(0x8f)](_0x3f69e5['data']);}[_0x4c7876(0x9e)](){var _0x394906=_0x4c7876;console['log'](_0x394906(0x88));}[_0x4c7876(0x9d)](){var _0x44abd7=_0x4c7876;console[_0x44abd7(0x9a)](_0x44abd7(0x94));}[_0x4c7876(0x90)](_0x133f31,_0x5419e9){var _0x25dee1=_0x4c7876;common_1[_0x25dee1(0x91)][_0x25dee1(0x9a)](_0x25dee1(0x79)+_0x133f31[_0x25dee1(0x8c)]+_0x25dee1(0x82)+_0x5419e9+_0x25dee1(0x72),_0x25dee1(0x7f));}['onQueueDrained'](){}};__decorate([(0x0,bull_1[_0x4c7876(0x8d)])({'name':_0x4c7876(0x73),'concurrency':process[_0x4c7876(0x7b)][_0x4c7876(0xa3)]?+process['env'][_0x4c7876(0xa3)]:0x3}),__metadata('design:type',Function),__metadata(_0x4c7876(0x8e),[Object]),__metadata(_0x4c7876(0xa2),Promise)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x6f),null),__decorate([(0x0,bull_1[_0x4c7876(0x6e)])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[Object]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor['prototype'],_0x4c7876(0x80),null),__decorate([(0x0,bull_1[_0x4c7876(0xa6)])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[Error]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x83),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[Object,Number]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x9b),null),__decorate([(0x0,bull_1[_0x4c7876(0x75)])(),__metadata('design:type',Function),__metadata(_0x4c7876(0x8e),[Object,Object]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x97),null),__decorate([(0x0,bull_1['OnQueueFailed'])(),__metadata('design:type',Function),__metadata(_0x4c7876(0x8e),[Object,Error]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x6d),null),__decorate([(0x0,bull_1[_0x4c7876(0x89)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor['prototype'],'onQueuePaused',null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],'onQueueResumed',null),__decorate([(0x0,bull_1[_0x4c7876(0x78)])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[Array,String]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x4c7876(0x98)],_0x4c7876(0x90),null),__decorate([(0x0,bull_1[_0x4c7876(0x70)])(),__metadata(_0x4c7876(0xa1),Function),__metadata(_0x4c7876(0x8e),[]),__metadata(_0x4c7876(0xa2),void 0x0)],QueueProcessor[_0x4c7876(0x98)],'onQueueDrained',null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x4c7876(0x7a)),__metadata(_0x4c7876(0x8e),[midjourney_service_1[_0x4c7876(0x8a)]])],QueueProcessor),exports[_0x4c7876(0x7f)]=QueueProcessor;