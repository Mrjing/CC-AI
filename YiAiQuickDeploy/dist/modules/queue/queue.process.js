'use strict';var _0x2d2a58=_0x3193;(function(_0x6ead25,_0x5e2cbe){var _0x307fb5=_0x3193,_0x5e2fc4=_0x6ead25();while(!![]){try{var _0x1cddef=parseInt(_0x307fb5(0x72))/0x1+-parseInt(_0x307fb5(0x73))/0x2*(-parseInt(_0x307fb5(0x77))/0x3)+-parseInt(_0x307fb5(0x84))/0x4*(parseInt(_0x307fb5(0x8b))/0x5)+parseInt(_0x307fb5(0x89))/0x6*(parseInt(_0x307fb5(0x99))/0x7)+parseInt(_0x307fb5(0x85))/0x8*(parseInt(_0x307fb5(0x7d))/0x9)+parseInt(_0x307fb5(0xa6))/0xa+-parseInt(_0x307fb5(0xa4))/0xb;if(_0x1cddef===_0x5e2cbe)break;else _0x5e2fc4['push'](_0x5e2fc4['shift']());}catch(_0x5a9013){_0x5e2fc4['push'](_0x5e2fc4['shift']());}}}(_0x22bc,0xb2588));var __decorate=this&&this[_0x2d2a58(0x68)]||function(_0x529d64,_0x59ee13,_0x4754b4,_0x24a069){var _0x418b31=_0x2d2a58,_0x55512c=arguments[_0x418b31(0x8a)],_0x1aa63d=_0x55512c<0x3?_0x59ee13:_0x24a069===null?_0x24a069=Object['getOwnPropertyDescriptor'](_0x59ee13,_0x4754b4):_0x24a069,_0x3b83b0;if(typeof Reflect==='object'&&typeof Reflect[_0x418b31(0x7e)]==='function')_0x1aa63d=Reflect[_0x418b31(0x7e)](_0x529d64,_0x59ee13,_0x4754b4,_0x24a069);else{for(var _0x22a1f0=_0x529d64[_0x418b31(0x8a)]-0x1;_0x22a1f0>=0x0;_0x22a1f0--)if(_0x3b83b0=_0x529d64[_0x22a1f0])_0x1aa63d=(_0x55512c<0x3?_0x3b83b0(_0x1aa63d):_0x55512c>0x3?_0x3b83b0(_0x59ee13,_0x4754b4,_0x1aa63d):_0x3b83b0(_0x59ee13,_0x4754b4))||_0x1aa63d;}return _0x55512c>0x3&&_0x1aa63d&&Object[_0x418b31(0x96)](_0x59ee13,_0x4754b4,_0x1aa63d),_0x1aa63d;},__metadata=this&&this[_0x2d2a58(0x92)]||function(_0x453b12,_0x370504){var _0x3eac12=_0x2d2a58;if(typeof Reflect===_0x3eac12(0x6f)&&typeof Reflect[_0x3eac12(0x6b)]===_0x3eac12(0x98))return Reflect[_0x3eac12(0x6b)](_0x453b12,_0x370504);},QueueProcessor_1;Object[_0x2d2a58(0x96)](exports,_0x2d2a58(0xa5),{'value':!![]}),exports[_0x2d2a58(0x79)]=void 0x0;function _0x22bc(){var _0x424ec3=['design:type','function','2488444gxTUEp','log','Processor','design:returntype','@nestjs/bull','Logger','OnQueueProgress','onQueueCompleted','draw','OnQueueActive','onQueueProgress','43304591OSjLho','__esModule','13806580ZDLpNg','__decorate','\x20were\x20cleaned.','mjDraw','metadata','OnQueueCleaned','error','Queue\x20failed:\x20','object','CONCURRENCY','design:paramtypes','1262556Ksfbsp','63452EirQqo','onQueueError','onQueueDrained','MidjourneyService','93WtGBXM','OnQueuePaused','QueueProcessor','OnQueueDrained','队列暂停的时候调用','data','18459GccCQJ','decorate','Queue\x20cleaned:\x20','handleJob','OnQueueError','midjourneyService','\x20jobs\x20of\x20type\x20','81976DEkigg','3656YCRQJD','onQueueResumed','队列发生错误','env','18avczin','length','235WwvzGP','prototype','队列恢复的时候调用','logger','onQueuePaused','onQueueActive',':\x20绘画失败\x20','__metadata','drawFailed','onQueueCleaned','onQueueFailed','defineProperty'];_0x22bc=function(){return _0x424ec3;};return _0x22bc();}const bull_1=require(_0x2d2a58(0x9d)),common_1=require('@nestjs/common'),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x1f9f39){var _0x2d1e35=_0x2d2a58;this[_0x2d1e35(0x82)]=_0x1f9f39,this[_0x2d1e35(0x8e)]=new common_1['Logger'](QueueProcessor_1['name']);}async['handleJob'](_0x50636e){var _0x40ad5f=_0x2d2a58;const _0x2a3099=await this[_0x40ad5f(0x82)][_0x40ad5f(0xa1)](_0x50636e[_0x40ad5f(0x7c)],_0x50636e['id']);return _0x2a3099;}[_0x2d2a58(0x90)](_0x494586){}[_0x2d2a58(0x74)](_0x2b577a){var _0x3e0619=_0x2d2a58;console[_0x3e0619(0x9a)](_0x3e0619(0x87),_0x2b577a);}[_0x2d2a58(0xa3)](_0x2ac528,_0x3c82f8){var _0x2a19e0=_0x2d2a58;console[_0x2a19e0(0x9a)]('队列任务的一个回调用于通知当前进度',_0x2ac528['id'],_0x3c82f8);}['onQueueCompleted'](_0x175666,_0x14dfdf){}[_0x2d2a58(0x95)](_0x35200c,_0x28e293){var _0x1e12cd=_0x2d2a58;common_1['Logger'][_0x1e12cd(0x6d)](_0x1e12cd(0x6e)+_0x28e293['message']+_0x1e12cd(0x91)+_0x35200c['id'],_0x1e12cd(0x79)),this[_0x1e12cd(0x82)][_0x1e12cd(0x93)](_0x35200c[_0x1e12cd(0x7c)]);}[_0x2d2a58(0x8f)](){var _0x533268=_0x2d2a58;console[_0x533268(0x9a)](_0x533268(0x7b));}['onQueueResumed'](){var _0x3bb877=_0x2d2a58;console[_0x3bb877(0x9a)](_0x3bb877(0x8d));}[_0x2d2a58(0x94)](_0x3132ca,_0x6c8f42){var _0x141d49=_0x2d2a58;common_1[_0x141d49(0x9e)][_0x141d49(0x9a)](_0x141d49(0x7f)+_0x3132ca[_0x141d49(0x8a)]+_0x141d49(0x83)+_0x6c8f42+_0x141d49(0x69),_0x141d49(0x79));}['onQueueDrained'](){}};function _0x3193(_0x205ece,_0x40ff7d){var _0x22bc63=_0x22bc();return _0x3193=function(_0x3193e9,_0x536a85){_0x3193e9=_0x3193e9-0x68;var _0x1a2074=_0x22bc63[_0x3193e9];return _0x1a2074;},_0x3193(_0x205ece,_0x40ff7d);}__decorate([(0x0,bull_1['Process'])({'name':_0x2d2a58(0x6a),'concurrency':process[_0x2d2a58(0x88)]['CONCURRENCY']?+process[_0x2d2a58(0x88)][_0x2d2a58(0x70)]:0x3}),__metadata(_0x2d2a58(0x97),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2d2a58(0x9c),Promise)],QueueProcessor['prototype'],_0x2d2a58(0x80),null),__decorate([(0x0,bull_1[_0x2d2a58(0xa2)])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[Object]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0x90),null),__decorate([(0x0,bull_1[_0x2d2a58(0x81)])(),__metadata('design:type',Function),__metadata(_0x2d2a58(0x71),[Error]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor['prototype'],_0x2d2a58(0x74),null),__decorate([(0x0,bull_1[_0x2d2a58(0x9f)])(),__metadata(_0x2d2a58(0x97),Function),__metadata('design:paramtypes',[Object,Number]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0xa3),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[Object,Object]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0xa0),null),__decorate([(0x0,bull_1['OnQueueFailed'])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[Object,Error]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0x95),null),__decorate([(0x0,bull_1[_0x2d2a58(0x78)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor['prototype'],_0x2d2a58(0x8f),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0x86),null),__decorate([(0x0,bull_1[_0x2d2a58(0x6c)])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[Array,String]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor[_0x2d2a58(0x8c)],_0x2d2a58(0x94),null),__decorate([(0x0,bull_1[_0x2d2a58(0x7a)])(),__metadata(_0x2d2a58(0x97),Function),__metadata(_0x2d2a58(0x71),[]),__metadata(_0x2d2a58(0x9c),void 0x0)],QueueProcessor['prototype'],_0x2d2a58(0x75),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x2d2a58(0x9b)])('MJDRAW'),__metadata(_0x2d2a58(0x71),[midjourney_service_1[_0x2d2a58(0x76)]])],QueueProcessor),exports[_0x2d2a58(0x79)]=QueueProcessor;