'use strict';var _0x39c3a0=_0xe8a6;(function(_0x4fd177,_0x371463){var _0x52d26b=_0xe8a6,_0x1ef435=_0x4fd177();while(!![]){try{var _0x4179f9=parseInt(_0x52d26b(0x196))/0x1*(-parseInt(_0x52d26b(0x1aa))/0x2)+-parseInt(_0x52d26b(0x193))/0x3*(-parseInt(_0x52d26b(0x185))/0x4)+parseInt(_0x52d26b(0x182))/0x5*(-parseInt(_0x52d26b(0x1ab))/0x6)+parseInt(_0x52d26b(0x18c))/0x7+parseInt(_0x52d26b(0x1a3))/0x8*(-parseInt(_0x52d26b(0x1a7))/0x9)+parseInt(_0x52d26b(0x1a5))/0xa*(-parseInt(_0x52d26b(0x190))/0xb)+-parseInt(_0x52d26b(0x186))/0xc*(-parseInt(_0x52d26b(0x189))/0xd);if(_0x4179f9===_0x371463)break;else _0x1ef435['push'](_0x1ef435['shift']());}catch(_0x58626d){_0x1ef435['push'](_0x1ef435['shift']());}}}(_0x7bd3,0xa405f));var __decorate=this&&this[_0x39c3a0(0x1ad)]||function(_0x164a45,_0x515f75,_0x1fb5fb,_0x1c77a6){var _0x5f271b=_0x39c3a0,_0x11433a=arguments[_0x5f271b(0x1b5)],_0x477e0f=_0x11433a<0x3?_0x515f75:_0x1c77a6===null?_0x1c77a6=Object['getOwnPropertyDescriptor'](_0x515f75,_0x1fb5fb):_0x1c77a6,_0x251e44;if(typeof Reflect==='object'&&typeof Reflect[_0x5f271b(0x18f)]===_0x5f271b(0x188))_0x477e0f=Reflect[_0x5f271b(0x18f)](_0x164a45,_0x515f75,_0x1fb5fb,_0x1c77a6);else{for(var _0x66c877=_0x164a45[_0x5f271b(0x1b5)]-0x1;_0x66c877>=0x0;_0x66c877--)if(_0x251e44=_0x164a45[_0x66c877])_0x477e0f=(_0x11433a<0x3?_0x251e44(_0x477e0f):_0x11433a>0x3?_0x251e44(_0x515f75,_0x1fb5fb,_0x477e0f):_0x251e44(_0x515f75,_0x1fb5fb))||_0x477e0f;}return _0x11433a>0x3&&_0x477e0f&&Object[_0x5f271b(0x1b8)](_0x515f75,_0x1fb5fb,_0x477e0f),_0x477e0f;},__metadata=this&&this['__metadata']||function(_0x449f94,_0x198f04){var _0x14890f=_0x39c3a0;if(typeof Reflect===_0x14890f(0x1a6)&&typeof Reflect[_0x14890f(0x1b1)]===_0x14890f(0x188))return Reflect[_0x14890f(0x1b1)](_0x449f94,_0x198f04);},QueueProcessor_1;Object[_0x39c3a0(0x1b8)](exports,_0x39c3a0(0x17f),{'value':!![]}),exports[_0x39c3a0(0x199)]=void 0x0;const bull_1=require(_0x39c3a0(0x1a0)),common_1=require(_0x39c3a0(0x1a2)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0xf029fa){var _0x151881=_0x39c3a0;this[_0x151881(0x183)]=_0xf029fa,this['logger']=new common_1[(_0x151881(0x1ae))](QueueProcessor_1[_0x151881(0x195)]);}async[_0x39c3a0(0x1a8)](_0x42346e){var _0x3d2f79=_0x39c3a0;const _0x42f56d=await this['midjourneyService'][_0x3d2f79(0x1a1)](_0x42346e[_0x3d2f79(0x1a4)],_0x42346e['id']);return _0x42f56d;}[_0x39c3a0(0x1b9)](_0x2b7f99){}[_0x39c3a0(0x19a)](_0x7a8677){var _0x1facb1=_0x39c3a0;console[_0x1facb1(0x1b3)]('队列发生错误',_0x7a8677);}[_0x39c3a0(0x19f)](_0x162c68,_0x56488c){var _0x485af4=_0x39c3a0;console[_0x485af4(0x1b3)](_0x485af4(0x1a9),_0x162c68['id'],_0x56488c);}[_0x39c3a0(0x198)](_0x4b293c,_0x4cd55e){}['onQueueFailed'](_0x222856,_0x16755c){var _0x2d7ba5=_0x39c3a0;common_1[_0x2d7ba5(0x1ae)][_0x2d7ba5(0x1ba)](_0x2d7ba5(0x194)+_0x16755c['message']+':\x20绘画失败\x20'+_0x222856['id'],'QueueProcessor'),this['midjourneyService']['drawFailed'](_0x222856[_0x2d7ba5(0x1a4)]);}[_0x39c3a0(0x19b)](){console['log']('队列暂停的时候调用');}['onQueueResumed'](){var _0x2b67db=_0x39c3a0;console[_0x2b67db(0x1b3)](_0x2b67db(0x19e));}[_0x39c3a0(0x1af)](_0x57e002,_0x2ca73f){var _0x479687=_0x39c3a0;common_1[_0x479687(0x1ae)][_0x479687(0x1b3)](_0x479687(0x180)+_0x57e002[_0x479687(0x1b5)]+'\x20jobs\x20of\x20type\x20'+_0x2ca73f+_0x479687(0x191),_0x479687(0x199));}[_0x39c3a0(0x18b)](){}};function _0xe8a6(_0x52c50d,_0x4d2cf6){var _0x7bd3e5=_0x7bd3();return _0xe8a6=function(_0xe8a6bf,_0x16f54e){_0xe8a6bf=_0xe8a6bf-0x17f;var _0x99664=_0x7bd3e5[_0xe8a6bf];return _0x99664;},_0xe8a6(_0x52c50d,_0x4d2cf6);}__decorate([(0x0,bull_1[_0x39c3a0(0x1b0)])({'name':_0x39c3a0(0x19d),'concurrency':process[_0x39c3a0(0x1b2)][_0x39c3a0(0x18d)]?+process[_0x39c3a0(0x1b2)]['CONCURRENCY']:0x3}),__metadata('design:type',Function),__metadata(_0x39c3a0(0x1b6),[Object]),__metadata('design:returntype',Promise)],QueueProcessor['prototype'],'handleJob',null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x39c3a0(0x19c),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor['prototype'],'onQueueActive',null),__decorate([(0x0,bull_1[_0x39c3a0(0x184)])(),__metadata(_0x39c3a0(0x19c),Function),__metadata(_0x39c3a0(0x1b6),[Error]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor['prototype'],'onQueueError',null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata('design:type',Function),__metadata(_0x39c3a0(0x1b6),[Object,Number]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor[_0x39c3a0(0x197)],_0x39c3a0(0x19f),null),__decorate([(0x0,bull_1[_0x39c3a0(0x187)])(),__metadata(_0x39c3a0(0x19c),Function),__metadata(_0x39c3a0(0x1b6),[Object,Object]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor[_0x39c3a0(0x197)],_0x39c3a0(0x198),null),__decorate([(0x0,bull_1[_0x39c3a0(0x192)])(),__metadata(_0x39c3a0(0x19c),Function),__metadata(_0x39c3a0(0x1b6),[Object,Error]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor[_0x39c3a0(0x197)],_0x39c3a0(0x1b7),null),__decorate([(0x0,bull_1[_0x39c3a0(0x1ac)])(),__metadata(_0x39c3a0(0x19c),Function),__metadata('design:paramtypes',[]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor['prototype'],_0x39c3a0(0x19b),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x39c3a0(0x19c),Function),__metadata(_0x39c3a0(0x1b6),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x39c3a0(0x197)],'onQueueResumed',null),__decorate([(0x0,bull_1[_0x39c3a0(0x18e)])(),__metadata(_0x39c3a0(0x19c),Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor[_0x39c3a0(0x197)],'onQueueCleaned',null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata(_0x39c3a0(0x19c),Function),__metadata('design:paramtypes',[]),__metadata(_0x39c3a0(0x1b4),void 0x0)],QueueProcessor['prototype'],_0x39c3a0(0x18b),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x39c3a0(0x181)])('MJDRAW'),__metadata(_0x39c3a0(0x1b6),[midjourney_service_1[_0x39c3a0(0x18a)]])],QueueProcessor),exports[_0x39c3a0(0x199)]=QueueProcessor;function _0x7bd3(){var _0x4417a5=['OnQueuePaused','__decorate','Logger','onQueueCleaned','Process','metadata','env','log','design:returntype','length','design:paramtypes','onQueueFailed','defineProperty','onQueueActive','error','__esModule','Queue\x20cleaned:\x20','Processor','5GKPQZp','midjourneyService','OnQueueError','4qHxPhc','52980264RIFixw','OnQueueCompleted','function','13GDoCnP','MidjourneyService','onQueueDrained','4305679LIAtST','CONCURRENCY','OnQueueCleaned','decorate','1210lhXWxM','\x20were\x20cleaned.','OnQueueFailed','128079eswUTM','Queue\x20failed:\x20','name','38tKfjaY','prototype','onQueueCompleted','QueueProcessor','onQueueError','onQueuePaused','design:type','mjDraw','队列恢复的时候调用','onQueueProgress','@nestjs/bull','draw','@nestjs/common','161072DlbIWh','data','120570rTdFGp','object','513RVDyBD','handleJob','队列任务的一个回调用于通知当前进度','60734orQZZr','4638714VyElSN'];_0x7bd3=function(){return _0x4417a5;};return _0x7bd3();}