'use strict';var _0x16e561=_0x1f8b;(function(_0x1def1d,_0x1e4d4d){var _0x442e59=_0x1f8b,_0x565827=_0x1def1d();while(!![]){try{var _0x244173=-parseInt(_0x442e59(0x196))/0x1*(parseInt(_0x442e59(0x1a6))/0x2)+parseInt(_0x442e59(0x1a7))/0x3*(parseInt(_0x442e59(0x1af))/0x4)+parseInt(_0x442e59(0x193))/0x5+-parseInt(_0x442e59(0x188))/0x6*(parseInt(_0x442e59(0x1b7))/0x7)+-parseInt(_0x442e59(0x1a4))/0x8+parseInt(_0x442e59(0x1b0))/0x9+-parseInt(_0x442e59(0x1aa))/0xa*(parseInt(_0x442e59(0x1bb))/0xb);if(_0x244173===_0x1e4d4d)break;else _0x565827['push'](_0x565827['shift']());}catch(_0x4c2aa3){_0x565827['push'](_0x565827['shift']());}}}(_0x3b67,0xae2ea));var __decorate=this&&this['__decorate']||function(_0x4df19a,_0x55e952,_0x3c63cd,_0x46c0e8){var _0x321fab=_0x1f8b,_0x3c3a48=arguments[_0x321fab(0x1bc)],_0x5cc7d2=_0x3c3a48<0x3?_0x55e952:_0x46c0e8===null?_0x46c0e8=Object[_0x321fab(0x1a0)](_0x55e952,_0x3c63cd):_0x46c0e8,_0x481c76;if(typeof Reflect===_0x321fab(0x183)&&typeof Reflect[_0x321fab(0x1b1)]===_0x321fab(0x1ab))_0x5cc7d2=Reflect[_0x321fab(0x1b1)](_0x4df19a,_0x55e952,_0x3c63cd,_0x46c0e8);else{for(var _0x5bdd35=_0x4df19a[_0x321fab(0x1bc)]-0x1;_0x5bdd35>=0x0;_0x5bdd35--)if(_0x481c76=_0x4df19a[_0x5bdd35])_0x5cc7d2=(_0x3c3a48<0x3?_0x481c76(_0x5cc7d2):_0x3c3a48>0x3?_0x481c76(_0x55e952,_0x3c63cd,_0x5cc7d2):_0x481c76(_0x55e952,_0x3c63cd))||_0x5cc7d2;}return _0x3c3a48>0x3&&_0x5cc7d2&&Object[_0x321fab(0x18c)](_0x55e952,_0x3c63cd,_0x5cc7d2),_0x5cc7d2;},__metadata=this&&this[_0x16e561(0x199)]||function(_0x46a79d,_0xeb5bc1){var _0xf1f3b4=_0x16e561;if(typeof Reflect==='object'&&typeof Reflect[_0xf1f3b4(0x19e)]===_0xf1f3b4(0x1ab))return Reflect['metadata'](_0x46a79d,_0xeb5bc1);},QueueProcessor_1;function _0x3b67(){var _0x45ebd7=['midjourneyService','MidjourneyService','design:returntype','OnQueueCleaned','5023140kEhmSA','onQueueDrained','@nestjs/common','11OOpZoM','drawFailed','onQueueProgress','__metadata','OnQueueFailed','message','OnQueueError','队列暂停的时候调用','metadata','name','getOwnPropertyDescriptor','CONCURRENCY','onQueueResumed','队列任务的一个回调用于通知当前进度','9010856FEyqYY','OnQueueActive','88912nWjOst','3686721tKcfbt','draw','OnQueueDrained','5661370bdfpbc','function','onQueuePaused','onQueueFailed','__esModule','4cCVcju','12280266ccWeRs','decorate','OnQueuePaused','error','QueueProcessor','OnQueueResumed','logger','7mLzXkm','log','handleJob','onQueueCompleted','11GFDtWa','length','design:paramtypes','Queue\x20failed:\x20','Process','design:type','prototype','Logger','mjDraw','object','\x20jobs\x20of\x20type\x20',':\x20绘画失败\x20','OnQueueCompleted','onQueueCleaned','4218294ZZDqOm','\x20were\x20cleaned.','env','MJDRAW','defineProperty','队列发生错误','onQueueError'];_0x3b67=function(){return _0x45ebd7;};return _0x3b67();}Object[_0x16e561(0x18c)](exports,_0x16e561(0x1ae),{'value':!![]}),exports[_0x16e561(0x1b4)]=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require(_0x16e561(0x195)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x569b25){var _0x3f72c5=_0x16e561;this[_0x3f72c5(0x18f)]=_0x569b25,this[_0x3f72c5(0x1b6)]=new common_1['Logger'](QueueProcessor_1[_0x3f72c5(0x19f)]);}async[_0x16e561(0x1b9)](_0x48d1b7){var _0x19b500=_0x16e561;const _0x3f119e=await this[_0x19b500(0x18f)][_0x19b500(0x1a8)](_0x48d1b7['data'],_0x48d1b7['id']);return _0x3f119e;}['onQueueActive'](_0x4b6555){}[_0x16e561(0x18e)](_0x260b57){var _0xeb821c=_0x16e561;console[_0xeb821c(0x1b8)](_0xeb821c(0x18d),_0x260b57);}[_0x16e561(0x198)](_0x3b2476,_0x2b22ab){var _0x5716f0=_0x16e561;console['log'](_0x5716f0(0x1a3),_0x3b2476['id'],_0x2b22ab);}[_0x16e561(0x1ba)](_0x59a756,_0x41ea22){}[_0x16e561(0x1ad)](_0x1040ff,_0x2dd0bb){var _0x501186=_0x16e561;common_1[_0x501186(0x1c2)][_0x501186(0x1b3)](_0x501186(0x1be)+_0x2dd0bb[_0x501186(0x19b)]+_0x501186(0x185)+_0x1040ff['id'],_0x501186(0x1b4)),this[_0x501186(0x18f)][_0x501186(0x197)](_0x1040ff['data']);}[_0x16e561(0x1ac)](){var _0x428304=_0x16e561;console[_0x428304(0x1b8)](_0x428304(0x19d));}[_0x16e561(0x1a2)](){var _0x1daab3=_0x16e561;console[_0x1daab3(0x1b8)]('队列恢复的时候调用');}['onQueueCleaned'](_0x391b95,_0x239433){var _0x563eff=_0x16e561;common_1[_0x563eff(0x1c2)][_0x563eff(0x1b8)]('Queue\x20cleaned:\x20'+_0x391b95[_0x563eff(0x1bc)]+_0x563eff(0x184)+_0x239433+_0x563eff(0x189),_0x563eff(0x1b4));}[_0x16e561(0x194)](){}};function _0x1f8b(_0x46d4e9,_0x2b8644){var _0x3b67fe=_0x3b67();return _0x1f8b=function(_0x1f8b25,_0x4c1edb){_0x1f8b25=_0x1f8b25-0x182;var _0x1ab066=_0x3b67fe[_0x1f8b25];return _0x1ab066;},_0x1f8b(_0x46d4e9,_0x2b8644);}__decorate([(0x0,bull_1[_0x16e561(0x1bf)])({'name':_0x16e561(0x182),'concurrency':process[_0x16e561(0x18a)][_0x16e561(0x1a1)]?+process[_0x16e561(0x18a)]['CONCURRENCY']:0x3}),__metadata('design:type',Function),__metadata(_0x16e561(0x1bd),[Object]),__metadata(_0x16e561(0x191),Promise)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x1b9),null),__decorate([(0x0,bull_1[_0x16e561(0x1a5)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],'onQueueActive',null),__decorate([(0x0,bull_1[_0x16e561(0x19c)])(),__metadata('design:type',Function),__metadata(_0x16e561(0x1bd),[Error]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x18e),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x16e561(0x1c0),Function),__metadata('design:paramtypes',[Object,Number]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor['prototype'],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x16e561(0x186)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x16e561(0x1ba),null),__decorate([(0x0,bull_1[_0x16e561(0x19a)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[Object,Error]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x1ad),null),__decorate([(0x0,bull_1[_0x16e561(0x1b2)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x1ac),null),__decorate([(0x0,bull_1[_0x16e561(0x1b5)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x1a2),null),__decorate([(0x0,bull_1[_0x16e561(0x192)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[Array,String]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor[_0x16e561(0x1c1)],_0x16e561(0x187),null),__decorate([(0x0,bull_1[_0x16e561(0x1a9)])(),__metadata(_0x16e561(0x1c0),Function),__metadata(_0x16e561(0x1bd),[]),__metadata(_0x16e561(0x191),void 0x0)],QueueProcessor['prototype'],_0x16e561(0x194),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x16e561(0x18b)),__metadata('design:paramtypes',[midjourney_service_1[_0x16e561(0x190)]])],QueueProcessor),exports[_0x16e561(0x1b4)]=QueueProcessor;