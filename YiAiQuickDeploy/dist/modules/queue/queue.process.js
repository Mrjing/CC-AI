'use strict';var _0x2d1fbd=_0x516b;(function(_0x32b0da,_0x4c3e43){var _0x22a14e=_0x516b,_0x2089c6=_0x32b0da();while(!![]){try{var _0x2170c0=parseInt(_0x22a14e(0xd4))/0x1*(-parseInt(_0x22a14e(0xbe))/0x2)+parseInt(_0x22a14e(0xcf))/0x3+parseInt(_0x22a14e(0xb3))/0x4+-parseInt(_0x22a14e(0xb7))/0x5*(parseInt(_0x22a14e(0xd1))/0x6)+parseInt(_0x22a14e(0xcd))/0x7*(parseInt(_0x22a14e(0xe2))/0x8)+-parseInt(_0x22a14e(0xc8))/0x9*(parseInt(_0x22a14e(0xde))/0xa)+parseInt(_0x22a14e(0xe7))/0xb;if(_0x2170c0===_0x4c3e43)break;else _0x2089c6['push'](_0x2089c6['shift']());}catch(_0x5d471c){_0x2089c6['push'](_0x2089c6['shift']());}}}(_0x4b23,0x4266a));function _0x516b(_0x477511,_0x737753){var _0x4b232a=_0x4b23();return _0x516b=function(_0x516b8b,_0x443342){_0x516b8b=_0x516b8b-0xab;var _0x41e0e7=_0x4b232a[_0x516b8b];return _0x41e0e7;},_0x516b(_0x477511,_0x737753);}var __decorate=this&&this[_0x2d1fbd(0xbf)]||function(_0x35bf97,_0xa40da4,_0x11a338,_0x20417c){var _0xfbbf5e=_0x2d1fbd,_0x433992=arguments[_0xfbbf5e(0xd3)],_0x52aa6d=_0x433992<0x3?_0xa40da4:_0x20417c===null?_0x20417c=Object['getOwnPropertyDescriptor'](_0xa40da4,_0x11a338):_0x20417c,_0x3d74e8;if(typeof Reflect==='object'&&typeof Reflect[_0xfbbf5e(0xc3)]==='function')_0x52aa6d=Reflect[_0xfbbf5e(0xc3)](_0x35bf97,_0xa40da4,_0x11a338,_0x20417c);else{for(var _0x2e7711=_0x35bf97[_0xfbbf5e(0xd3)]-0x1;_0x2e7711>=0x0;_0x2e7711--)if(_0x3d74e8=_0x35bf97[_0x2e7711])_0x52aa6d=(_0x433992<0x3?_0x3d74e8(_0x52aa6d):_0x433992>0x3?_0x3d74e8(_0xa40da4,_0x11a338,_0x52aa6d):_0x3d74e8(_0xa40da4,_0x11a338))||_0x52aa6d;}return _0x433992>0x3&&_0x52aa6d&&Object[_0xfbbf5e(0xb2)](_0xa40da4,_0x11a338,_0x52aa6d),_0x52aa6d;},__metadata=this&&this['__metadata']||function(_0x5acecd,_0x3385e3){var _0x96e1ef=_0x2d1fbd;if(typeof Reflect===_0x96e1ef(0xdc)&&typeof Reflect[_0x96e1ef(0xc5)]===_0x96e1ef(0xcc))return Reflect[_0x96e1ef(0xc5)](_0x5acecd,_0x3385e3);},QueueProcessor_1;function _0x4b23(){var _0x566ce5=['9238gMMDRf','__decorate','QueueProcessor','MidjourneyService','OnQueueError','decorate','Processor','metadata','onQueueDrained','data','369nFJAMN','onQueueCompleted','drawFailed','Queue\x20failed:\x20','function','7qbCVaJ','OnQueuePaused','1348557ojumys',':\x20绘画失败\x20','110550IMpmOt','design:returntype','length','25HQCAQy','@nestjs/bull','队列任务的一个回调用于通知当前进度','message','队列发生错误','MJDRAW','onQueueFailed','@nestjs/common','object','onQueuePaused','90980nEmqmU','onQueueProgress','logger','midjourneyService','1825736KwARwV','design:type','design:paramtypes','draw','onQueueActive','3171828QUsnFz','onQueueError','队列暂停的时候调用','Process','\x20were\x20cleaned.','prototype','队列恢复的时候调用','onQueueCleaned','defineProperty','430448KUPgCF','__esModule','Logger','CONCURRENCY','85OjKGex','onQueueResumed','OnQueueFailed','mjDraw','log','name','env'];_0x4b23=function(){return _0x566ce5;};return _0x4b23();}Object[_0x2d1fbd(0xb2)](exports,_0x2d1fbd(0xb4),{'value':!![]}),exports[_0x2d1fbd(0xc0)]=void 0x0;const bull_1=require(_0x2d1fbd(0xd5)),common_1=require(_0x2d1fbd(0xdb)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x3af29c){var _0x44569e=_0x2d1fbd;this[_0x44569e(0xe1)]=_0x3af29c,this[_0x44569e(0xe0)]=new common_1[(_0x44569e(0xb5))](QueueProcessor_1[_0x44569e(0xbc)]);}async['handleJob'](_0x2c5307){var _0x100773=_0x2d1fbd;const _0x2f2e10=await this[_0x100773(0xe1)][_0x100773(0xe5)](_0x2c5307[_0x100773(0xc7)],_0x2c5307['id']);return _0x2f2e10;}[_0x2d1fbd(0xe6)](_0x18fb6b){}[_0x2d1fbd(0xab)](_0x2d7acb){var _0xe7ce66=_0x2d1fbd;console[_0xe7ce66(0xbb)](_0xe7ce66(0xd8),_0x2d7acb);}[_0x2d1fbd(0xdf)](_0x12a092,_0x1acfae){var _0x35d093=_0x2d1fbd;console[_0x35d093(0xbb)](_0x35d093(0xd6),_0x12a092['id'],_0x1acfae);}[_0x2d1fbd(0xc9)](_0x50af45,_0x282b2b){}[_0x2d1fbd(0xda)](_0x28e6f0,_0x316cc1){var _0x19e305=_0x2d1fbd;common_1[_0x19e305(0xb5)]['error'](_0x19e305(0xcb)+_0x316cc1[_0x19e305(0xd7)]+_0x19e305(0xd0)+_0x28e6f0['id'],'QueueProcessor'),this[_0x19e305(0xe1)][_0x19e305(0xca)](_0x28e6f0[_0x19e305(0xc7)]);}[_0x2d1fbd(0xdd)](){var _0x369a8d=_0x2d1fbd;console['log'](_0x369a8d(0xac));}['onQueueResumed'](){var _0x2b8733=_0x2d1fbd;console['log'](_0x2b8733(0xb0));}[_0x2d1fbd(0xb1)](_0x4f74de,_0x327244){var _0x3bacd2=_0x2d1fbd;common_1[_0x3bacd2(0xb5)][_0x3bacd2(0xbb)]('Queue\x20cleaned:\x20'+_0x4f74de[_0x3bacd2(0xd3)]+'\x20jobs\x20of\x20type\x20'+_0x327244+_0x3bacd2(0xae),_0x3bacd2(0xc0));}[_0x2d1fbd(0xc6)](){}};__decorate([(0x0,bull_1[_0x2d1fbd(0xad)])({'name':_0x2d1fbd(0xba),'concurrency':process[_0x2d1fbd(0xbd)][_0x2d1fbd(0xb6)]?+process[_0x2d1fbd(0xbd)][_0x2d1fbd(0xb6)]:0x3}),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Object]),__metadata(_0x2d1fbd(0xd2),Promise)],QueueProcessor['prototype'],'handleJob',null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Object]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xe6),null),__decorate([(0x0,bull_1[_0x2d1fbd(0xc2)])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Error]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],'onQueueError',null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Object,Number]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xdf),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xc9),null),__decorate([(0x0,bull_1[_0x2d1fbd(0xb9)])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Object,Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xda),null),__decorate([(0x0,bull_1[_0x2d1fbd(0xce)])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xdd),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xb8),null),__decorate([(0x0,bull_1['OnQueueCleaned'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata(_0x2d1fbd(0xe4),[Array,String]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor[_0x2d1fbd(0xaf)],_0x2d1fbd(0xb1),null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata(_0x2d1fbd(0xe3),Function),__metadata('design:paramtypes',[]),__metadata(_0x2d1fbd(0xd2),void 0x0)],QueueProcessor['prototype'],_0x2d1fbd(0xc6),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x2d1fbd(0xc4)])(_0x2d1fbd(0xd9)),__metadata(_0x2d1fbd(0xe4),[midjourney_service_1[_0x2d1fbd(0xc1)]])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;