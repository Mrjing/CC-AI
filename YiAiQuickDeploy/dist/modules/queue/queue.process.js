'use strict';var _0x343c2f=_0x2724;(function(_0x29af99,_0x4b4045){var _0x26632d=_0x2724,_0x23425f=_0x29af99();while(!![]){try{var _0x1755a7=parseInt(_0x26632d(0x1ac))/0x1+parseInt(_0x26632d(0x1bf))/0x2+-parseInt(_0x26632d(0x19f))/0x3*(parseInt(_0x26632d(0x1b8))/0x4)+parseInt(_0x26632d(0x1d6))/0x5*(parseInt(_0x26632d(0x1da))/0x6)+parseInt(_0x26632d(0x1b7))/0x7*(parseInt(_0x26632d(0x1d0))/0x8)+parseInt(_0x26632d(0x1d7))/0x9+-parseInt(_0x26632d(0x1d5))/0xa*(parseInt(_0x26632d(0x1ad))/0xb);if(_0x1755a7===_0x4b4045)break;else _0x23425f['push'](_0x23425f['shift']());}catch(_0x2ea09b){_0x23425f['push'](_0x23425f['shift']());}}}(_0x3ace,0xceb63));var __decorate=this&&this['__decorate']||function(_0x24504a,_0x396399,_0x32f2c8,_0x54d845){var _0x2bc4aa=_0x2724,_0x397c23=arguments[_0x2bc4aa(0x1b0)],_0x197655=_0x397c23<0x3?_0x396399:_0x54d845===null?_0x54d845=Object[_0x2bc4aa(0x1b2)](_0x396399,_0x32f2c8):_0x54d845,_0x14e453;if(typeof Reflect===_0x2bc4aa(0x1a9)&&typeof Reflect[_0x2bc4aa(0x1a7)]===_0x2bc4aa(0x1cd))_0x197655=Reflect[_0x2bc4aa(0x1a7)](_0x24504a,_0x396399,_0x32f2c8,_0x54d845);else{for(var _0x2a13a3=_0x24504a[_0x2bc4aa(0x1b0)]-0x1;_0x2a13a3>=0x0;_0x2a13a3--)if(_0x14e453=_0x24504a[_0x2a13a3])_0x197655=(_0x397c23<0x3?_0x14e453(_0x197655):_0x397c23>0x3?_0x14e453(_0x396399,_0x32f2c8,_0x197655):_0x14e453(_0x396399,_0x32f2c8))||_0x197655;}return _0x397c23>0x3&&_0x197655&&Object[_0x2bc4aa(0x1cf)](_0x396399,_0x32f2c8,_0x197655),_0x197655;},__metadata=this&&this['__metadata']||function(_0xe5a839,_0x277582){var _0x247006=_0x2724;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x247006(0x1cd))return Reflect[_0x247006(0x1c4)](_0xe5a839,_0x277582);},QueueProcessor_1;Object[_0x343c2f(0x1cf)](exports,'__esModule',{'value':!![]}),exports[_0x343c2f(0x1c6)]=void 0x0;const bull_1=require(_0x343c2f(0x1db)),common_1=require(_0x343c2f(0x1b4)),midjourney_service_1=require(_0x343c2f(0x1a1));function _0x2724(_0x39bb80,_0x147573){var _0x3aced5=_0x3ace();return _0x2724=function(_0x27243b,_0x59dd95){_0x27243b=_0x27243b-0x19e;var _0x513dde=_0x3aced5[_0x27243b];return _0x513dde;},_0x2724(_0x39bb80,_0x147573);}let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x3c2843){var _0xaab793=_0x343c2f;this[_0xaab793(0x1dd)]=_0x3c2843,this[_0xaab793(0x1a2)]=new common_1['Logger'](QueueProcessor_1[_0xaab793(0x1dc)]);}async[_0x343c2f(0x1b3)](_0x2a89b4){var _0x192e91=_0x343c2f;const _0x115338=await this[_0x192e91(0x1dd)][_0x192e91(0x1bc)](_0x2a89b4[_0x192e91(0x1aa)],_0x2a89b4['id']);return _0x115338;}[_0x343c2f(0x1cb)](_0x2a1c24){}['onQueueError'](_0x4fb3a5){console['log']('队列发生错误',_0x4fb3a5);}[_0x343c2f(0x1d8)](_0x44abe9,_0x17ebe0){var _0xb92f9d=_0x343c2f;console[_0xb92f9d(0x1d2)](_0xb92f9d(0x1ba),_0x44abe9['id'],_0x17ebe0);}[_0x343c2f(0x1a3)](_0x146133,_0x9d41f4){}[_0x343c2f(0x1a4)](_0x19f80f,_0x593bb9){var _0x1ff695=_0x343c2f;common_1['Logger'][_0x1ff695(0x1d3)]('Queue\x20failed:\x20'+_0x593bb9[_0x1ff695(0x1c9)]+_0x1ff695(0x19e)+_0x19f80f['id'],_0x1ff695(0x1c6)),this['midjourneyService'][_0x1ff695(0x1c0)](_0x19f80f[_0x1ff695(0x1aa)]);}[_0x343c2f(0x1c7)](){var _0x4005a6=_0x343c2f;console[_0x4005a6(0x1d2)](_0x4005a6(0x1ce));}['onQueueResumed'](){var _0x3f089c=_0x343c2f;console['log'](_0x3f089c(0x1be));}[_0x343c2f(0x1b1)](_0x567463,_0x20b5c5){var _0x314b0f=_0x343c2f;common_1[_0x314b0f(0x1ca)][_0x314b0f(0x1d2)]('Queue\x20cleaned:\x20'+_0x567463['length']+_0x314b0f(0x1bd)+_0x20b5c5+'\x20were\x20cleaned.',_0x314b0f(0x1c6));}[_0x343c2f(0x1d1)](){}};function _0x3ace(){var _0x4b71d6=['Processor','QueueProcessor','onQueuePaused','mjDraw','message','Logger','onQueueActive','OnQueueError','function','队列暂停的时候调用','defineProperty','151480FbzYqE','onQueueDrained','log','error','OnQueueFailed','411830ONjaLh','2260nnkBLG','1520181QtNTJH','onQueueProgress','CONCURRENCY','12234rsVJTm','@nestjs/bull','name','midjourneyService',':\x20绘画失败\x20','3tCJRnW','onQueueError','../midjourney/midjourney.service','logger','onQueueCompleted','onQueueFailed','design:type','OnQueueDrained','decorate','MJDRAW','object','data','OnQueueActive','172472TFyfxS','649lLQqyx','OnQueueCleaned','MidjourneyService','length','onQueueCleaned','getOwnPropertyDescriptor','handleJob','@nestjs/common','design:returntype','OnQueueCompleted','462hgqJUB','703244wOwhSi','design:paramtypes','队列任务的一个回调用于通知当前进度','OnQueueProgress','draw','\x20jobs\x20of\x20type\x20','队列恢复的时候调用','1879160HEjAkA','drawFailed','OnQueuePaused','env','prototype','metadata'];_0x3ace=function(){return _0x4b71d6;};return _0x3ace();}__decorate([(0x0,bull_1['Process'])({'name':_0x343c2f(0x1c8),'concurrency':process[_0x343c2f(0x1c2)][_0x343c2f(0x1d9)]?+process[_0x343c2f(0x1c2)][_0x343c2f(0x1d9)]:0x3}),__metadata(_0x343c2f(0x1a5),Function),__metadata(_0x343c2f(0x1b9),[Object]),__metadata('design:returntype',Promise)],QueueProcessor['prototype'],_0x343c2f(0x1b3),null),__decorate([(0x0,bull_1[_0x343c2f(0x1ab)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor['prototype'],_0x343c2f(0x1cb),null),__decorate([(0x0,bull_1[_0x343c2f(0x1cc)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata('design:paramtypes',[Error]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],_0x343c2f(0x1a0),null),__decorate([(0x0,bull_1[_0x343c2f(0x1bb)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata(_0x343c2f(0x1b9),[Object,Number]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor['prototype'],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x343c2f(0x1b6)])(),__metadata('design:type',Function),__metadata(_0x343c2f(0x1b9),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],_0x343c2f(0x1a3),null),__decorate([(0x0,bull_1[_0x343c2f(0x1d4)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata(_0x343c2f(0x1b9),[Object,Error]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],_0x343c2f(0x1a4),null),__decorate([(0x0,bull_1[_0x343c2f(0x1c1)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata('design:paramtypes',[]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],_0x343c2f(0x1c7),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x343c2f(0x1a5),Function),__metadata(_0x343c2f(0x1b9),[]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor['prototype'],'onQueueResumed',null),__decorate([(0x0,bull_1[_0x343c2f(0x1ae)])(),__metadata(_0x343c2f(0x1a5),Function),__metadata(_0x343c2f(0x1b9),[Array,String]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],'onQueueCleaned',null),__decorate([(0x0,bull_1[_0x343c2f(0x1a6)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x343c2f(0x1b5),void 0x0)],QueueProcessor[_0x343c2f(0x1c3)],_0x343c2f(0x1d1),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x343c2f(0x1c5)])(_0x343c2f(0x1a8)),__metadata('design:paramtypes',[midjourney_service_1[_0x343c2f(0x1af)]])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;