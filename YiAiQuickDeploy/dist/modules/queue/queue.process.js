'use strict';var _0x2becae=_0x1af8;(function(_0x4692b7,_0x5bf643){var _0x4ca325=_0x1af8,_0xf39a5c=_0x4692b7();while(!![]){try{var _0xdf5943=-parseInt(_0x4ca325(0x180))/0x1+parseInt(_0x4ca325(0x175))/0x2+-parseInt(_0x4ca325(0x160))/0x3+parseInt(_0x4ca325(0x18b))/0x4*(parseInt(_0x4ca325(0x151))/0x5)+-parseInt(_0x4ca325(0x171))/0x6*(parseInt(_0x4ca325(0x162))/0x7)+-parseInt(_0x4ca325(0x189))/0x8*(parseInt(_0x4ca325(0x17a))/0x9)+parseInt(_0x4ca325(0x178))/0xa;if(_0xdf5943===_0x5bf643)break;else _0xf39a5c['push'](_0xf39a5c['shift']());}catch(_0x463cd0){_0xf39a5c['push'](_0xf39a5c['shift']());}}}(_0x394f,0x681e7));function _0x1af8(_0x3a6596,_0x47c5fe){var _0x394fc2=_0x394f();return _0x1af8=function(_0x1af861,_0x21f27f){_0x1af861=_0x1af861-0x14f;var _0x31e284=_0x394fc2[_0x1af861];return _0x31e284;},_0x1af8(_0x3a6596,_0x47c5fe);}var __decorate=this&&this[_0x2becae(0x18e)]||function(_0x8ac9d7,_0x568606,_0x2ce86c,_0x53c11f){var _0x1ed12d=_0x2becae,_0xa1c461=arguments['length'],_0x147c1e=_0xa1c461<0x3?_0x568606:_0x53c11f===null?_0x53c11f=Object[_0x1ed12d(0x165)](_0x568606,_0x2ce86c):_0x53c11f,_0x57b745;if(typeof Reflect===_0x1ed12d(0x186)&&typeof Reflect[_0x1ed12d(0x15e)]==='function')_0x147c1e=Reflect[_0x1ed12d(0x15e)](_0x8ac9d7,_0x568606,_0x2ce86c,_0x53c11f);else{for(var _0x399ca3=_0x8ac9d7['length']-0x1;_0x399ca3>=0x0;_0x399ca3--)if(_0x57b745=_0x8ac9d7[_0x399ca3])_0x147c1e=(_0xa1c461<0x3?_0x57b745(_0x147c1e):_0xa1c461>0x3?_0x57b745(_0x568606,_0x2ce86c,_0x147c1e):_0x57b745(_0x568606,_0x2ce86c))||_0x147c1e;}return _0xa1c461>0x3&&_0x147c1e&&Object['defineProperty'](_0x568606,_0x2ce86c,_0x147c1e),_0x147c1e;},__metadata=this&&this[_0x2becae(0x15a)]||function(_0x361e91,_0x4b9103){var _0x313198=_0x2becae;if(typeof Reflect===_0x313198(0x186)&&typeof Reflect[_0x313198(0x18d)]===_0x313198(0x16e))return Reflect['metadata'](_0x361e91,_0x4b9103);},QueueProcessor_1;Object[_0x2becae(0x18a)](exports,_0x2becae(0x155),{'value':!![]}),exports[_0x2becae(0x159)]=void 0x0;function _0x394f(){var _0x2c2ea5=['2997128orbmHs','defineProperty','2064kBjgSX','MidjourneyService','metadata','__decorate','OnQueuePaused','design:paramtypes','onQueuePaused','5575RGvmar','onQueueCompleted','midjourneyService','队列任务的一个回调用于通知当前进度','__esModule','design:returntype','onQueueError','\x20jobs\x20of\x20type\x20','QueueProcessor','__metadata','onQueueResumed','Logger','OnQueueFailed','decorate','onQueueDrained','1736916mFQWng','env','106386yrKLOm','MJDRAW','OnQueueResumed','getOwnPropertyDescriptor','drawFailed','OnQueueCleaned','OnQueueActive','length','队列发生错误','Queue\x20failed:\x20','Process','@nestjs/common','function','mjDraw',':\x20绘画失败\x20','120iKXECO','logger','CONCURRENCY','Queue\x20cleaned:\x20','1618428WiGcqz','OnQueueProgress','队列恢复的时候调用','6223950wNlpgu','onQueueProgress','9dIvMgP','name','onQueueActive','log','prototype','onQueueCleaned','322905tOczjC','design:type','error','队列暂停的时候调用','\x20were\x20cleaned.','message','object','OnQueueCompleted','data'];_0x394f=function(){return _0x2c2ea5;};return _0x394f();}const bull_1=require('@nestjs/bull'),common_1=require(_0x2becae(0x16d)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x2e25fd){var _0x36fe2f=_0x2becae;this[_0x36fe2f(0x153)]=_0x2e25fd,this[_0x36fe2f(0x172)]=new common_1[(_0x36fe2f(0x15c))](QueueProcessor_1[_0x36fe2f(0x17b)]);}async['handleJob'](_0x7637fb){var _0x43878d=_0x2becae;const _0x429b0a=await this[_0x43878d(0x153)]['draw'](_0x7637fb['data'],_0x7637fb['id']);return _0x429b0a;}[_0x2becae(0x17c)](_0x31769b){}['onQueueError'](_0x30b7b4){var _0x2a6ba7=_0x2becae;console[_0x2a6ba7(0x17d)](_0x2a6ba7(0x16a),_0x30b7b4);}[_0x2becae(0x179)](_0x3b706b,_0x20840a){var _0x2df9eb=_0x2becae;console[_0x2df9eb(0x17d)](_0x2df9eb(0x154),_0x3b706b['id'],_0x20840a);}[_0x2becae(0x152)](_0xb1b4d9,_0x105afa){}['onQueueFailed'](_0x527d03,_0x58c6e9){var _0x16a1ee=_0x2becae;common_1[_0x16a1ee(0x15c)][_0x16a1ee(0x182)](_0x16a1ee(0x16b)+_0x58c6e9[_0x16a1ee(0x185)]+_0x16a1ee(0x170)+_0x527d03['id'],_0x16a1ee(0x159)),this['midjourneyService'][_0x16a1ee(0x166)](_0x527d03[_0x16a1ee(0x188)]);}[_0x2becae(0x150)](){var _0x395861=_0x2becae;console[_0x395861(0x17d)](_0x395861(0x183));}['onQueueResumed'](){var _0x21d989=_0x2becae;console[_0x21d989(0x17d)](_0x21d989(0x177));}[_0x2becae(0x17f)](_0x119d5c,_0x2e4b5f){var _0x247769=_0x2becae;common_1['Logger'][_0x247769(0x17d)](_0x247769(0x174)+_0x119d5c[_0x247769(0x169)]+_0x247769(0x158)+_0x2e4b5f+_0x247769(0x184),_0x247769(0x159));}[_0x2becae(0x15f)](){}};__decorate([(0x0,bull_1[_0x2becae(0x16c)])({'name':_0x2becae(0x16f),'concurrency':process[_0x2becae(0x161)]['CONCURRENCY']?+process[_0x2becae(0x161)][_0x2becae(0x173)]:0x3}),__metadata(_0x2becae(0x181),Function),__metadata(_0x2becae(0x14f),[Object]),__metadata(_0x2becae(0x156),Promise)],QueueProcessor['prototype'],'handleJob',null),__decorate([(0x0,bull_1[_0x2becae(0x168)])(),__metadata(_0x2becae(0x181),Function),__metadata(_0x2becae(0x14f),[Object]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],'onQueueActive',null),__decorate([(0x0,bull_1['OnQueueError'])(),__metadata(_0x2becae(0x181),Function),__metadata(_0x2becae(0x14f),[Error]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],_0x2becae(0x157),null),__decorate([(0x0,bull_1[_0x2becae(0x176)])(),__metadata(_0x2becae(0x181),Function),__metadata('design:paramtypes',[Object,Number]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor['prototype'],_0x2becae(0x179),null),__decorate([(0x0,bull_1[_0x2becae(0x187)])(),__metadata('design:type',Function),__metadata(_0x2becae(0x14f),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x2becae(0x17e)],_0x2becae(0x152),null),__decorate([(0x0,bull_1[_0x2becae(0x15d)])(),__metadata(_0x2becae(0x181),Function),__metadata('design:paramtypes',[Object,Error]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],'onQueueFailed',null),__decorate([(0x0,bull_1[_0x2becae(0x18f)])(),__metadata(_0x2becae(0x181),Function),__metadata('design:paramtypes',[]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],_0x2becae(0x150),null),__decorate([(0x0,bull_1[_0x2becae(0x164)])(),__metadata(_0x2becae(0x181),Function),__metadata(_0x2becae(0x14f),[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x2becae(0x15b),null),__decorate([(0x0,bull_1[_0x2becae(0x167)])(),__metadata(_0x2becae(0x181),Function),__metadata(_0x2becae(0x14f),[Array,String]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],_0x2becae(0x17f),null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata('design:type',Function),__metadata(_0x2becae(0x14f),[]),__metadata(_0x2becae(0x156),void 0x0)],QueueProcessor[_0x2becae(0x17e)],_0x2becae(0x15f),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x2becae(0x163)),__metadata(_0x2becae(0x14f),[midjourney_service_1[_0x2becae(0x18c)]])],QueueProcessor),exports[_0x2becae(0x159)]=QueueProcessor;