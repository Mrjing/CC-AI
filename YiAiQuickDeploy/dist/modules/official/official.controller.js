'use strict';function _0x49ac(){const _0x3b9dfd=['Query','1973111FyINBe','3425940Vzvysc','genXmlMsg','genXmlMsgByConfig','decorate','10344348jAYKRu','code','ApiOperation','4336zRDZsv','公众号通知接口POST','function','verify','Res','OfficialService','eventkey','metadata','status','公众号通知接口GET','__decorate','1AVUDQZ','send','msgtype','1388426PrHKfs','OfficialController','Body','length','GetQrSceneStrDto','nonce','GetQrCodeDto','fromusername','official','object','design:type','获取注册配置','getQRSceneStrByBind','CLICK','text','扫码登录轮询查询','officialSubscribeText','Get','url','VIEW','officialService','./dto/getQrSceneStr.dto','defineProperty','aotoPlay','JwtAuthGuard','notify','__metadata','subscribe','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','getOwnPropertyDescriptor','loginByCode','TRUE','signature','unsubscribe','公众号静默登录','SCAN','getJsapiTicket','timestamp','prototype','getRedirectUrl','notifyPost','扫码绑定轮询查询','scan','Controller','获取登录跳转地址','getQRCode','Req','__esModule','__param','2298SWpymS','split','ISDEV','3566992JQOtAl','design:returntype','UseGuards','getQRSceneStr','bindWxBySceneStr','event','sceneStr','includes','log','110664lkDwNI','loginBySceneStr','success','获取登录二维码sceneStr','get\x20通知>>>','getQRCodeTicket','design:paramtypes','@nestjs/swagger','Post'];_0x49ac=function(){return _0x3b9dfd;};return _0x49ac();}const _0x7e41a5=_0x4b47;(function(_0x3809fe,_0x39081f){const _0x26f28f=_0x4b47,_0x17ce28=_0x3809fe();while(!![]){try{const _0x5bb922=parseInt(_0x26f28f(0x15d))/0x1*(-parseInt(_0x26f28f(0x160))/0x2)+-parseInt(_0x26f28f(0x191))/0x3*(-parseInt(_0x26f28f(0x152))/0x4)+parseInt(_0x26f28f(0x1a8))/0x5+parseInt(_0x26f28f(0x19d))/0x6+parseInt(_0x26f28f(0x1a7))/0x7+parseInt(_0x26f28f(0x194))/0x8+-parseInt(_0x26f28f(0x1ac))/0x9;if(_0x5bb922===_0x39081f)break;else _0x17ce28['push'](_0x17ce28['shift']());}catch(_0x2a67cf){_0x17ce28['push'](_0x17ce28['shift']());}}}(_0x49ac,0x6615a));var __decorate=this&&this[_0x7e41a5(0x15c)]||function(_0x39e853,_0x506dec,_0x9acdd4,_0x10da59){const _0x2041a5=_0x7e41a5;var _0x4a45ec=arguments[_0x2041a5(0x163)],_0x12682c=_0x4a45ec<0x3?_0x506dec:_0x10da59===null?_0x10da59=Object[_0x2041a5(0x17d)](_0x506dec,_0x9acdd4):_0x10da59,_0x7dc340;if(typeof Reflect===_0x2041a5(0x169)&&typeof Reflect['decorate']===_0x2041a5(0x154))_0x12682c=Reflect[_0x2041a5(0x1ab)](_0x39e853,_0x506dec,_0x9acdd4,_0x10da59);else{for(var _0x53f1cc=_0x39e853[_0x2041a5(0x163)]-0x1;_0x53f1cc>=0x0;_0x53f1cc--)if(_0x7dc340=_0x39e853[_0x53f1cc])_0x12682c=(_0x4a45ec<0x3?_0x7dc340(_0x12682c):_0x4a45ec>0x3?_0x7dc340(_0x506dec,_0x9acdd4,_0x12682c):_0x7dc340(_0x506dec,_0x9acdd4))||_0x12682c;}return _0x4a45ec>0x3&&_0x12682c&&Object[_0x2041a5(0x176)](_0x506dec,_0x9acdd4,_0x12682c),_0x12682c;},__metadata=this&&this[_0x7e41a5(0x17a)]||function(_0x55cce9,_0x893ea7){const _0x12c43c=_0x7e41a5;if(typeof Reflect===_0x12c43c(0x169)&&typeof Reflect[_0x12c43c(0x159)]===_0x12c43c(0x154))return Reflect[_0x12c43c(0x159)](_0x55cce9,_0x893ea7);},__param=this&&this[_0x7e41a5(0x190)]||function(_0x15fe62,_0x1ac5db){return function(_0xbe151b,_0x411f3c){_0x1ac5db(_0xbe151b,_0x411f3c,_0x15fe62);};};Object['defineProperty'](exports,_0x7e41a5(0x18f),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x7e41a5(0x1a4)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require('./official.service'),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require(_0x7e41a5(0x175));let OfficialController=class OfficialController{constructor(_0x1560bc){const _0x5ba3be=_0x7e41a5;this[_0x5ba3be(0x174)]=_0x1560bc;}async[_0x7e41a5(0x179)](_0x319984,_0xfeeac8,_0x4a370a){const _0x4a9321=_0x7e41a5;console[_0x4a9321(0x19c)](_0x4a9321(0x1a1),_0xfeeac8,_0x4a370a);const _0xda9630=await this[_0x4a9321(0x174)][_0x4a9321(0x155)](_0xfeeac8[_0x4a9321(0x180)],_0xfeeac8[_0x4a9321(0x165)],_0xfeeac8[_0x4a9321(0x185)]);return _0xda9630?_0xfeeac8['echostr']:'';}async['notifyPost'](_0x4fe6ac,_0x3f4153,_0x4fc88f,_0x29783a){const _0x5278e7=_0x7e41a5,{xml:_0x5acd80}=_0x4fc88f;console[_0x5278e7(0x19c)]('xml:\x20',_0x5acd80);if(_0x5acd80[_0x5278e7(0x15f)][0x0]==_0x5278e7(0x199)){if(_0x5acd80[_0x5278e7(0x199)][0x0]==_0x5278e7(0x173)||_0x5acd80['event'][0x0]==_0x5278e7(0x16d))return _0x29783a[_0x5278e7(0x15a)](0xc8)[_0x5278e7(0x15e)]('');if(_0x5acd80[_0x5278e7(0x199)][0x0]==_0x5278e7(0x183)){console['log']('扫码');const _0x5bb676=_0x5acd80[_0x5278e7(0x158)][0x0];if(_0x5bb676[_0x5278e7(0x19b)]('/')){this[_0x5278e7(0x174)]['scanBindWx'](_0x5acd80[_0x5278e7(0x167)][0x0],_0x5bb676);const _0x1b45dd=await this[_0x5278e7(0x174)][_0x5278e7(0x1aa)](_0x5acd80,'officialBindAccountText');return _0x29783a[_0x5278e7(0x15a)](0xc8)[_0x5278e7(0x15e)](_0x1b45dd);}this[_0x5278e7(0x174)][_0x5278e7(0x18a)](_0x5acd80[_0x5278e7(0x167)][0x0],_0x5bb676);const _0x189fc3=await this[_0x5278e7(0x174)][_0x5278e7(0x1aa)](_0x5acd80,'officialScanLoginText');return _0x29783a[_0x5278e7(0x15a)](0xc8)['send'](_0x189fc3);}if(_0x5acd80[_0x5278e7(0x199)][0x0]==_0x5278e7(0x17b)){console[_0x5278e7(0x19c)]('订阅',_0x5acd80['eventkey'][0x0]);const _0x20328e=_0x5acd80[_0x5278e7(0x158)][0x0][_0x5278e7(0x192)]('qrscene_')[0x1];console[_0x5278e7(0x19c)]('sceneStr:\x20',_0x20328e);if(!_0x20328e){const _0x138a44=await this[_0x5278e7(0x174)]['genXmlMsgByConfig'](_0x5acd80,_0x5278e7(0x170));return _0x29783a[_0x5278e7(0x15a)](0xc8)['send'](_0x138a44);}if(_0x20328e['includes']('/')){this['officialService']['scanBindWx'](_0x5acd80['fromusername'][0x0],_0x20328e);const _0x364b65=await this[_0x5278e7(0x174)][_0x5278e7(0x1aa)](_0x5acd80,'officialBindAccountText');return _0x29783a[_0x5278e7(0x15a)](0xc8)[_0x5278e7(0x15e)](_0x364b65);}this[_0x5278e7(0x174)][_0x5278e7(0x18a)](_0x5acd80['fromusername'][0x0],_0x20328e);const _0x5b3276=await this['officialService'][_0x5278e7(0x1aa)](_0x5acd80,_0x5278e7(0x170));return _0x29783a[_0x5278e7(0x15a)](0xc8)[_0x5278e7(0x15e)](_0x5b3276);}if(_0x5acd80[_0x5278e7(0x199)][0x0]==_0x5278e7(0x181))return _0x29783a[_0x5278e7(0x15a)](0xc8)['send']('');}if(_0x5acd80[_0x5278e7(0x15f)][0x0]==_0x5278e7(0x16e)){const _0x15fea8=await this[_0x5278e7(0x174)][_0x5278e7(0x177)](_0x5acd80['content'][0x0]),_0x408236=await this[_0x5278e7(0x174)][_0x5278e7(0x1a9)](_0x5acd80,_0x15fea8);return _0x29783a[_0x5278e7(0x15a)](0xc8)[_0x5278e7(0x15e)](_0x408236);}return _0x5278e7(0x19f);}async['getQRSceneStr'](_0x232e4f){const _0x295d82=_0x7e41a5;return this[_0x295d82(0x174)][_0x295d82(0x197)](_0x232e4f);}async['getQRSceneStrByBind'](_0xfa6d6d){const _0x5b8146=_0x7e41a5;return this[_0x5b8146(0x174)][_0x5b8146(0x16c)](_0xfa6d6d);}async[_0x7e41a5(0x18d)](_0x315d9b){const _0x529d80=_0x7e41a5;if(process['env'][_0x529d80(0x193)]===_0x529d80(0x17f))return'';const _0x509159=await this[_0x529d80(0x174)][_0x529d80(0x1a2)](_0x315d9b[_0x529d80(0x19a)]);return _0x529d80(0x17c)+encodeURIComponent(_0x509159);}async[_0x7e41a5(0x19e)](_0x23d258,_0x5a8835){const _0x14898a=_0x7e41a5;return this[_0x14898a(0x174)][_0x14898a(0x19e)](_0x23d258,_0x5a8835[_0x14898a(0x19a)]);}async['bindWxBySceneStr'](_0x22215f,_0x29bafa){const _0x35fdeb=_0x7e41a5;return this[_0x35fdeb(0x174)]['bindWxBySceneStr'](_0x22215f,_0x29bafa[_0x35fdeb(0x19a)]);}async[_0x7e41a5(0x187)](_0x45f47e){const _0x280c53=_0x7e41a5;return this[_0x280c53(0x174)][_0x280c53(0x187)](_0x45f47e[_0x280c53(0x172)]);}async[_0x7e41a5(0x184)](_0x439f9f){const _0x3712bd=_0x7e41a5;return this[_0x3712bd(0x174)][_0x3712bd(0x184)](_0x439f9f['url']);}async[_0x7e41a5(0x17e)](_0x1be042,_0x5956e1){const _0x390ae5=_0x7e41a5;return this[_0x390ae5(0x174)][_0x390ae5(0x17e)](_0x1be042,_0x5956e1[_0x390ae5(0x1ad)]);}};function _0x4b47(_0x489d82,_0x4b88c2){const _0x49ac81=_0x49ac();return _0x4b47=function(_0x4b47ca,_0x130bea){_0x4b47ca=_0x4b47ca-0x151;let _0x5bf01b=_0x49ac81[_0x4b47ca];return _0x5bf01b;},_0x4b47(_0x489d82,_0x4b88c2);}__decorate([(0x0,common_1[_0x7e41a5(0x171)])(_0x7e41a5(0x179)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x15b)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x18e)])()),__param(0x1,(0x0,common_1[_0x7e41a5(0x1a6)])()),__param(0x2,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[Object,Object,Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x179),null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])(_0x7e41a5(0x179)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x153)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x18e)])()),__param(0x1,(0x0,common_1[_0x7e41a5(0x1a6)])()),__param(0x2,(0x0,common_1[_0x7e41a5(0x162)])()),__param(0x3,(0x0,common_1[_0x7e41a5(0x156)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[Object,Object,Object,Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x188),null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])(_0x7e41a5(0x197)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x1a0)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[getQrSceneStr_dto_1[_0x7e41a5(0x164)]]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController['prototype'],_0x7e41a5(0x197),null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])(_0x7e41a5(0x16c)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x7e41a5(0x196)])(jwtAuth_guard_1[_0x7e41a5(0x178)]),__param(0x0,(0x0,common_1[_0x7e41a5(0x18e)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x16c),null),__decorate([(0x0,common_1[_0x7e41a5(0x171)])(_0x7e41a5(0x18d)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x7e41a5(0x1a6)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x7e41a5(0x166)]]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],'getQRCode',null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])(_0x7e41a5(0x19e)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x16f)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x18e)])()),__param(0x1,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[Object,getQrCode_dto_1[_0x7e41a5(0x166)]]),__metadata('design:returntype',Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x19e),null),__decorate([(0x0,common_1['Post'])(_0x7e41a5(0x198)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x189)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x7e41a5(0x178)]),__param(0x0,(0x0,common_1[_0x7e41a5(0x18e)])()),__param(0x1,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x7e41a5(0x166)]]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x198),null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])(_0x7e41a5(0x187)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x18c)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata(_0x7e41a5(0x16a),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x187),null),__decorate([(0x0,common_1['Post'])(_0x7e41a5(0x184)),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x16b)}),__param(0x0,(0x0,common_1[_0x7e41a5(0x162)])()),__metadata('design:type',Function),__metadata(_0x7e41a5(0x1a3),[Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x7e41a5(0x1a5)])('loginByCode'),(0x0,swagger_1[_0x7e41a5(0x151)])({'summary':_0x7e41a5(0x182)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x7e41a5(0x16a),Function),__metadata(_0x7e41a5(0x1a3),[Object,Object]),__metadata(_0x7e41a5(0x195),Promise)],OfficialController[_0x7e41a5(0x186)],_0x7e41a5(0x17e),null),OfficialController=__decorate([(0x0,swagger_1['ApiTags'])(_0x7e41a5(0x168)),(0x0,common_1[_0x7e41a5(0x18b)])(_0x7e41a5(0x168)),__metadata(_0x7e41a5(0x1a3),[official_service_1[_0x7e41a5(0x157)]])],OfficialController),exports[_0x7e41a5(0x161)]=OfficialController;