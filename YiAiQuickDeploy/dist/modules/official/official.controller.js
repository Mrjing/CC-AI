'use strict';function _0x9573(){const _0x36ae7e=['./dto/getQrCode.dto','metadata','扫码登录轮询查询','design:paramtypes','getQRSceneStrByBind','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','genXmlMsgByConfig','eventkey','Req','78YTjKlk','timestamp','./official.service','signature','function','getRedirectUrl','loginByCode','获取二维码','official','SCAN','unsubscribe','ApiTags','status','@nestjs/swagger','content','split','__param','./dto/getQrSceneStr.dto','__metadata','event','url','GetQrCodeDto','subscribe','aotoPlay','officialBindAccountText','2707308Bicuom','Post','xml:\x20','扫码绑定轮询查询','VIEW','ISDEV','getQRSceneStr','success','notifyPost','UseGuards','notify','JwtAuthGuard','sceneStr:\x20','获取登录二维码sceneStr','Body','公众号通知接口GET','getJsapiTicket','19819989XQpJzD','OfficialController','@nestjs/common','text','ApiOperation','nonce','sceneStr','officialService','TRUE','__esModule','qrscene_','object','935737NRejfc','27HerwNu','150674Cswnzy','GetQrSceneStrDto','prototype','msgtype','genXmlMsg','6327745YAAlZH','verify','fromusername','getQRCode','design:type','Res','send','decorate','__decorate','scan','log','bindWxBySceneStr','design:returntype','scanBindWx','get\x20通知>>>','公众号通知接口POST','获取注册配置','594056qnJLny','Get','372281sqVIGR','includes','officialScanLoginText','loginBySceneStr','env','Controller','Query','getQRCodeTicket','defineProperty'];_0x9573=function(){return _0x36ae7e;};return _0x9573();}const _0x51bf94=_0x2007;(function(_0x1d0db1,_0x2f9f50){const _0x47b4b6=_0x2007,_0x373cf9=_0x1d0db1();while(!![]){try{const _0x4bc073=parseInt(_0x47b4b6(0x162))/0x1+-parseInt(_0x47b4b6(0x164))/0x2*(-parseInt(_0x47b4b6(0x163))/0x3)+-parseInt(_0x47b4b6(0x145))/0x4+parseInt(_0x47b4b6(0x169))/0x5+parseInt(_0x47b4b6(0x12c))/0x6*(parseInt(_0x47b4b6(0x17c))/0x7)+parseInt(_0x47b4b6(0x17a))/0x8+-parseInt(_0x47b4b6(0x156))/0x9;if(_0x4bc073===_0x2f9f50)break;else _0x373cf9['push'](_0x373cf9['shift']());}catch(_0x4c928a){_0x373cf9['push'](_0x373cf9['shift']());}}}(_0x9573,0xbafd3));function _0x2007(_0x2f0ab7,_0x2dcfca){const _0x95736f=_0x9573();return _0x2007=function(_0x20071c,_0x40b8a8){_0x20071c=_0x20071c-0x121;let _0x512efb=_0x95736f[_0x20071c];return _0x512efb;},_0x2007(_0x2f0ab7,_0x2dcfca);}var __decorate=this&&this[_0x51bf94(0x171)]||function(_0x213756,_0x589fbb,_0x47fbbe,_0x76b602){const _0x574d4e=_0x51bf94;var _0x32ca82=arguments['length'],_0x2633a6=_0x32ca82<0x3?_0x589fbb:_0x76b602===null?_0x76b602=Object['getOwnPropertyDescriptor'](_0x589fbb,_0x47fbbe):_0x76b602,_0x473f7a;if(typeof Reflect===_0x574d4e(0x161)&&typeof Reflect[_0x574d4e(0x170)]===_0x574d4e(0x130))_0x2633a6=Reflect[_0x574d4e(0x170)](_0x213756,_0x589fbb,_0x47fbbe,_0x76b602);else{for(var _0x37022d=_0x213756['length']-0x1;_0x37022d>=0x0;_0x37022d--)if(_0x473f7a=_0x213756[_0x37022d])_0x2633a6=(_0x32ca82<0x3?_0x473f7a(_0x2633a6):_0x32ca82>0x3?_0x473f7a(_0x589fbb,_0x47fbbe,_0x2633a6):_0x473f7a(_0x589fbb,_0x47fbbe))||_0x2633a6;}return _0x32ca82>0x3&&_0x2633a6&&Object[_0x574d4e(0x122)](_0x589fbb,_0x47fbbe,_0x2633a6),_0x2633a6;},__metadata=this&&this[_0x51bf94(0x13e)]||function(_0x2a1797,_0x1fb4d9){const _0x5d2f12=_0x51bf94;if(typeof Reflect===_0x5d2f12(0x161)&&typeof Reflect[_0x5d2f12(0x124)]==='function')return Reflect[_0x5d2f12(0x124)](_0x2a1797,_0x1fb4d9);},__param=this&&this[_0x51bf94(0x13c)]||function(_0x5b37a2,_0x321bf0){return function(_0x945e6c,_0x51721b){_0x321bf0(_0x945e6c,_0x51721b,_0x5b37a2);};};Object['defineProperty'](exports,_0x51bf94(0x15f),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require(_0x51bf94(0x158)),swagger_1=require(_0x51bf94(0x139)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x51bf94(0x12e)),getQrCode_dto_1=require(_0x51bf94(0x123)),getQrSceneStr_dto_1=require(_0x51bf94(0x13d));let OfficialController=class OfficialController{constructor(_0x534370){const _0x321134=_0x51bf94;this[_0x321134(0x15d)]=_0x534370;}async[_0x51bf94(0x14f)](_0x580623,_0x5e61d3,_0xb5b061){const _0x3c65e3=_0x51bf94;console['log'](_0x3c65e3(0x177),_0x5e61d3,_0xb5b061);const _0x59b234=await this[_0x3c65e3(0x15d)][_0x3c65e3(0x16a)](_0x5e61d3[_0x3c65e3(0x12f)],_0x5e61d3[_0x3c65e3(0x15b)],_0x5e61d3[_0x3c65e3(0x12d)]);return _0x59b234?_0x5e61d3['echostr']:'';}async[_0x51bf94(0x14d)](_0xa3cd99,_0x2aba49,_0x4a8d0f,_0x59b25c){const _0x2081ac=_0x51bf94,{xml:_0x95fe66}=_0x4a8d0f;console[_0x2081ac(0x173)](_0x2081ac(0x147),_0x95fe66);if(_0x95fe66[_0x2081ac(0x167)][0x0]==_0x2081ac(0x13f)){if(_0x95fe66[_0x2081ac(0x13f)][0x0]==_0x2081ac(0x149)||_0x95fe66[_0x2081ac(0x13f)][0x0]=='CLICK')return _0x59b25c[_0x2081ac(0x138)](0xc8)[_0x2081ac(0x16f)]('');if(_0x95fe66['event'][0x0]==_0x2081ac(0x135)){console[_0x2081ac(0x173)]('扫码');const _0x5164d9=_0x95fe66[_0x2081ac(0x12a)][0x0];if(_0x5164d9['includes']('/')){this[_0x2081ac(0x15d)]['scanBindWx'](_0x95fe66[_0x2081ac(0x16b)][0x0],_0x5164d9);const _0x1eeee4=await this[_0x2081ac(0x15d)]['genXmlMsgByConfig'](_0x95fe66,_0x2081ac(0x144));return _0x59b25c[_0x2081ac(0x138)](0xc8)[_0x2081ac(0x16f)](_0x1eeee4);}this[_0x2081ac(0x15d)][_0x2081ac(0x172)](_0x95fe66[_0x2081ac(0x16b)][0x0],_0x5164d9);const _0x3f1e77=await this[_0x2081ac(0x15d)][_0x2081ac(0x129)](_0x95fe66,_0x2081ac(0x17e));return _0x59b25c['status'](0xc8)['send'](_0x3f1e77);}if(_0x95fe66[_0x2081ac(0x13f)][0x0]==_0x2081ac(0x142)){console[_0x2081ac(0x173)]('订阅',_0x95fe66[_0x2081ac(0x12a)][0x0]);const _0x1bb35a=_0x95fe66[_0x2081ac(0x12a)][0x0][_0x2081ac(0x13b)](_0x2081ac(0x160))[0x1];console['log'](_0x2081ac(0x151),_0x1bb35a);if(!_0x1bb35a){const _0x42a61b=await this[_0x2081ac(0x15d)][_0x2081ac(0x129)](_0x95fe66,'officialSubscribeText');return _0x59b25c['status'](0xc8)['send'](_0x42a61b);}if(_0x1bb35a[_0x2081ac(0x17d)]('/')){this[_0x2081ac(0x15d)][_0x2081ac(0x176)](_0x95fe66['fromusername'][0x0],_0x1bb35a);const _0x37c5de=await this[_0x2081ac(0x15d)]['genXmlMsgByConfig'](_0x95fe66,_0x2081ac(0x144));return _0x59b25c[_0x2081ac(0x138)](0xc8)['send'](_0x37c5de);}this[_0x2081ac(0x15d)][_0x2081ac(0x172)](_0x95fe66[_0x2081ac(0x16b)][0x0],_0x1bb35a);const _0x33a0a2=await this[_0x2081ac(0x15d)]['genXmlMsgByConfig'](_0x95fe66,'officialSubscribeText');return _0x59b25c[_0x2081ac(0x138)](0xc8)[_0x2081ac(0x16f)](_0x33a0a2);}if(_0x95fe66['event'][0x0]==_0x2081ac(0x136))return _0x59b25c[_0x2081ac(0x138)](0xc8)['send']('');}if(_0x95fe66[_0x2081ac(0x167)][0x0]==_0x2081ac(0x159)){const _0x2e9d59=await this['officialService'][_0x2081ac(0x143)](_0x95fe66[_0x2081ac(0x13a)][0x0]),_0x5e9ab7=await this[_0x2081ac(0x15d)][_0x2081ac(0x168)](_0x95fe66,_0x2e9d59);return _0x59b25c[_0x2081ac(0x138)](0xc8)[_0x2081ac(0x16f)](_0x5e9ab7);}return _0x2081ac(0x14c);}async[_0x51bf94(0x14b)](_0x195e05){const _0x51267c=_0x51bf94;return this[_0x51267c(0x15d)][_0x51267c(0x14b)](_0x195e05);}async[_0x51bf94(0x127)](_0x31403a){const _0x193cec=_0x51bf94;return this[_0x193cec(0x15d)]['getQRSceneStrByBind'](_0x31403a);}async['getQRCode'](_0x193f9e){const _0xfd2182=_0x51bf94;if(process[_0xfd2182(0x180)][_0xfd2182(0x14a)]===_0xfd2182(0x15e))return'';const _0x44ac7d=await this[_0xfd2182(0x15d)][_0xfd2182(0x121)](_0x193f9e[_0xfd2182(0x15c)]);return _0xfd2182(0x128)+encodeURIComponent(_0x44ac7d);}async[_0x51bf94(0x17f)](_0x596c34,_0x15cd75){const _0x26af91=_0x51bf94;return this[_0x26af91(0x15d)][_0x26af91(0x17f)](_0x596c34,_0x15cd75[_0x26af91(0x15c)]);}async[_0x51bf94(0x174)](_0x233c13,_0x10d97e){const _0x55b784=_0x51bf94;return this[_0x55b784(0x15d)][_0x55b784(0x174)](_0x233c13,_0x10d97e[_0x55b784(0x15c)]);}async[_0x51bf94(0x131)](_0x31036a){const _0x511fe6=_0x51bf94;return this['officialService'][_0x511fe6(0x131)](_0x31036a[_0x511fe6(0x140)]);}async[_0x51bf94(0x155)](_0x1e2c63){const _0x8153d5=_0x51bf94;return this['officialService']['getJsapiTicket'](_0x1e2c63[_0x8153d5(0x140)]);}async[_0x51bf94(0x132)](_0x505ed3,_0x5a8ad4){const _0x2f4ba1=_0x51bf94;return this[_0x2f4ba1(0x15d)]['loginByCode'](_0x505ed3,_0x5a8ad4['code']);}};__decorate([(0x0,common_1[_0x51bf94(0x17b)])(_0x51bf94(0x14f)),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':_0x51bf94(0x154)}),__param(0x0,(0x0,common_1[_0x51bf94(0x12b)])()),__param(0x1,(0x0,common_1[_0x51bf94(0x182)])()),__param(0x2,(0x0,common_1[_0x51bf94(0x153)])()),__metadata(_0x51bf94(0x16d),Function),__metadata(_0x51bf94(0x126),[Object,Object,Object]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x14f),null),__decorate([(0x0,common_1['Post'])('notify'),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':_0x51bf94(0x178)}),__param(0x0,(0x0,common_1[_0x51bf94(0x12b)])()),__param(0x1,(0x0,common_1[_0x51bf94(0x182)])()),__param(0x2,(0x0,common_1[_0x51bf94(0x153)])()),__param(0x3,(0x0,common_1[_0x51bf94(0x16e)])()),__metadata('design:type',Function),__metadata(_0x51bf94(0x126),[Object,Object,Object,Object]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x14d),null),__decorate([(0x0,common_1[_0x51bf94(0x146)])(_0x51bf94(0x14b)),(0x0,swagger_1['ApiOperation'])({'summary':_0x51bf94(0x152)}),__param(0x0,(0x0,common_1[_0x51bf94(0x153)])()),__metadata(_0x51bf94(0x16d),Function),__metadata(_0x51bf94(0x126),[getQrSceneStr_dto_1[_0x51bf94(0x165)]]),__metadata('design:returntype',Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x14b),null),__decorate([(0x0,common_1['Post'])(_0x51bf94(0x127)),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x51bf94(0x14e)])(jwtAuth_guard_1[_0x51bf94(0x150)]),__param(0x0,(0x0,common_1[_0x51bf94(0x12b)])()),__metadata(_0x51bf94(0x16d),Function),__metadata(_0x51bf94(0x126),[Object]),__metadata(_0x51bf94(0x175),Promise)],OfficialController['prototype'],_0x51bf94(0x127),null),__decorate([(0x0,common_1[_0x51bf94(0x17b)])('getQRCode'),(0x0,swagger_1['ApiOperation'])({'summary':_0x51bf94(0x133)}),__param(0x0,(0x0,common_1[_0x51bf94(0x182)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x51bf94(0x141)]]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x16c),null),__decorate([(0x0,common_1[_0x51bf94(0x146)])(_0x51bf94(0x17f)),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':_0x51bf94(0x125)}),__param(0x0,(0x0,common_1[_0x51bf94(0x12b)])()),__param(0x1,(0x0,common_1[_0x51bf94(0x153)])()),__metadata(_0x51bf94(0x16d),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x51bf94(0x175),Promise)],OfficialController['prototype'],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x51bf94(0x146)])(_0x51bf94(0x174)),(0x0,swagger_1['ApiOperation'])({'summary':_0x51bf94(0x148)}),(0x0,common_1[_0x51bf94(0x14e)])(jwtAuth_guard_1[_0x51bf94(0x150)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x51bf94(0x16d),Function),__metadata(_0x51bf94(0x126),[Object,getQrCode_dto_1[_0x51bf94(0x141)]]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x174),null),__decorate([(0x0,common_1[_0x51bf94(0x146)])('getRedirectUrl'),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x51bf94(0x153)])()),__metadata(_0x51bf94(0x16d),Function),__metadata(_0x51bf94(0x126),[Object]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x131),null),__decorate([(0x0,common_1[_0x51bf94(0x146)])(_0x51bf94(0x155)),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':_0x51bf94(0x179)}),__param(0x0,(0x0,common_1[_0x51bf94(0x153)])()),__metadata('design:type',Function),__metadata(_0x51bf94(0x126),[Object]),__metadata(_0x51bf94(0x175),Promise)],OfficialController[_0x51bf94(0x166)],_0x51bf94(0x155),null),__decorate([(0x0,common_1[_0x51bf94(0x146)])(_0x51bf94(0x132)),(0x0,swagger_1[_0x51bf94(0x15a)])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x51bf94(0x12b)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x51bf94(0x126),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x51bf94(0x132),null),OfficialController=__decorate([(0x0,swagger_1[_0x51bf94(0x137)])(_0x51bf94(0x134)),(0x0,common_1[_0x51bf94(0x181)])(_0x51bf94(0x134)),__metadata(_0x51bf94(0x126),[official_service_1['OfficialService']])],OfficialController),exports[_0x51bf94(0x157)]=OfficialController;