'use strict';const _0x3b3366=_0xdb14;(function(_0x411a1c,_0x34abb9){const _0x10999b=_0xdb14,_0x562db8=_0x411a1c();while(!![]){try{const _0x16b488=parseInt(_0x10999b(0x19d))/0x1+parseInt(_0x10999b(0x173))/0x2*(parseInt(_0x10999b(0x1aa))/0x3)+-parseInt(_0x10999b(0x179))/0x4+parseInt(_0x10999b(0x164))/0x5+parseInt(_0x10999b(0x1ab))/0x6*(parseInt(_0x10999b(0x158))/0x7)+parseInt(_0x10999b(0x172))/0x8+parseInt(_0x10999b(0x15a))/0x9*(-parseInt(_0x10999b(0x151))/0xa);if(_0x16b488===_0x34abb9)break;else _0x562db8['push'](_0x562db8['shift']());}catch(_0x5e3210){_0x562db8['push'](_0x562db8['shift']());}}}(_0x3223,0x9d1e0));function _0xdb14(_0x256ee8,_0x388de8){const _0x3223cf=_0x3223();return _0xdb14=function(_0xdb144d,_0x503648){_0xdb144d=_0xdb144d-0x14b;let _0x4d8856=_0x3223cf[_0xdb144d];return _0x4d8856;},_0xdb14(_0x256ee8,_0x388de8);}var __decorate=this&&this[_0x3b3366(0x1a2)]||function(_0x5f0e23,_0x363070,_0x32f9b5,_0x51b5e1){const _0x1e2675=_0x3b3366;var _0x54f532=arguments[_0x1e2675(0x17d)],_0x5842cc=_0x54f532<0x3?_0x363070:_0x51b5e1===null?_0x51b5e1=Object[_0x1e2675(0x190)](_0x363070,_0x32f9b5):_0x51b5e1,_0x2643e0;if(typeof Reflect==='object'&&typeof Reflect[_0x1e2675(0x15d)]===_0x1e2675(0x16b))_0x5842cc=Reflect[_0x1e2675(0x15d)](_0x5f0e23,_0x363070,_0x32f9b5,_0x51b5e1);else{for(var _0x181168=_0x5f0e23[_0x1e2675(0x17d)]-0x1;_0x181168>=0x0;_0x181168--)if(_0x2643e0=_0x5f0e23[_0x181168])_0x5842cc=(_0x54f532<0x3?_0x2643e0(_0x5842cc):_0x54f532>0x3?_0x2643e0(_0x363070,_0x32f9b5,_0x5842cc):_0x2643e0(_0x363070,_0x32f9b5))||_0x5842cc;}return _0x54f532>0x3&&_0x5842cc&&Object[_0x1e2675(0x17b)](_0x363070,_0x32f9b5,_0x5842cc),_0x5842cc;},__metadata=this&&this[_0x3b3366(0x15b)]||function(_0x17a4ae,_0x4c00aa){const _0x36b393=_0x3b3366;if(typeof Reflect===_0x36b393(0x177)&&typeof Reflect[_0x36b393(0x16a)]==='function')return Reflect[_0x36b393(0x16a)](_0x17a4ae,_0x4c00aa);},__param=this&&this[_0x3b3366(0x191)]||function(_0x3ca544,_0x2832b6){return function(_0x51a05e,_0x6c759){_0x2832b6(_0x51a05e,_0x6c759,_0x3ca544);};};Object[_0x3b3366(0x17b)](exports,_0x3b3366(0x157),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x3b3366(0x167)),jwtAuth_guard_1=require(_0x3b3366(0x14e)),official_service_1=require(_0x3b3366(0x1a8)),getQrCode_dto_1=require(_0x3b3366(0x159)),getQrSceneStr_dto_1=require(_0x3b3366(0x160));function _0x3223(){const _0x1f30fd=['env','split','__esModule','21mvDVTo','./dto/getQrCode.dto','9IxmqHI','__metadata','prototype','decorate','notify','Get','./dto/getQrSceneStr.dto','event','echostr','scanBindWx','3983270whvZWz','getRedirectUrl','sceneStr','@nestjs/swagger','officialSubscribeText','official','metadata','function','get\x20通知>>>','GetQrCodeDto','officialBindAccountText','Req','sceneStr:\x20','design:paramtypes','9968440blAhrC','2iucebp','design:type','genXmlMsgByConfig','subscribe','object','OfficialService','2926520tIACPZ','officialService','defineProperty','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','length','notifyPost','success','getQRCode','fromusername','genXmlMsg','text','公众号通知接口GET','getQRCodeTicket','eventkey','content','scan','log','GetQrSceneStrDto','JwtAuthGuard','xml:\x20','qrscene_','获取二维码','TRUE','getOwnPropertyDescriptor','__param','Post','公众号通知接口POST','ApiOperation','loginByCode','公众号静默登录','verify','Query','code','loginBySceneStr','officialScanLoginText','SCAN','303440OiuXOD','UseGuards','getQRSceneStr','msgtype','getQRSceneStrByBind','__decorate','Res','design:returntype','获取登录跳转地址','扫码绑定轮询查询','Body','./official.service','send','1954983arKKMQ','1342218PxGcpi','includes','aotoPlay','ApiTags','getJsapiTicket','../../common/auth/jwtAuth.guard','OfficialController','unsubscribe','22937370qgqxTI','bindWxBySceneStr','status','Controller'];_0x3223=function(){return _0x1f30fd;};return _0x3223();}let OfficialController=class OfficialController{constructor(_0x148e4a){const _0xee10fe=_0x3b3366;this[_0xee10fe(0x17a)]=_0x148e4a;}async[_0x3b3366(0x15e)](_0x3eee2e,_0x35999d,_0x510677){const _0x4baadb=_0x3b3366;console['log'](_0x4baadb(0x16c),_0x35999d,_0x510677);const _0x39ffa6=await this[_0x4baadb(0x17a)][_0x4baadb(0x197)](_0x35999d['signature'],_0x35999d['nonce'],_0x35999d['timestamp']);return _0x39ffa6?_0x35999d[_0x4baadb(0x162)]:'';}async['notifyPost'](_0x5f3f76,_0x37fc75,_0x80e28a,_0x583e38){const _0x583ff7=_0x3b3366,{xml:_0x533d16}=_0x80e28a;console[_0x583ff7(0x189)](_0x583ff7(0x18c),_0x533d16);if(_0x533d16[_0x583ff7(0x1a0)][0x0]==_0x583ff7(0x161)){if(_0x533d16[_0x583ff7(0x161)][0x0]=='VIEW'||_0x533d16['event'][0x0]=='CLICK')return _0x583e38[_0x583ff7(0x153)](0xc8)[_0x583ff7(0x1a9)]('');if(_0x533d16[_0x583ff7(0x161)][0x0]==_0x583ff7(0x19c)){console[_0x583ff7(0x189)]('扫码');const _0x38a611=_0x533d16[_0x583ff7(0x186)][0x0];if(_0x38a611[_0x583ff7(0x1ac)]('/')){this[_0x583ff7(0x17a)][_0x583ff7(0x163)](_0x533d16[_0x583ff7(0x181)][0x0],_0x38a611);const _0x680a25=await this[_0x583ff7(0x17a)][_0x583ff7(0x175)](_0x533d16,_0x583ff7(0x16e));return _0x583e38[_0x583ff7(0x153)](0xc8)[_0x583ff7(0x1a9)](_0x680a25);}this[_0x583ff7(0x17a)]['scan'](_0x533d16[_0x583ff7(0x181)][0x0],_0x38a611);const _0xd1b8b2=await this[_0x583ff7(0x17a)][_0x583ff7(0x175)](_0x533d16,_0x583ff7(0x19b));return _0x583e38[_0x583ff7(0x153)](0xc8)['send'](_0xd1b8b2);}if(_0x533d16[_0x583ff7(0x161)][0x0]==_0x583ff7(0x176)){console['log']('订阅',_0x533d16[_0x583ff7(0x186)][0x0]);const _0x25d94b=_0x533d16[_0x583ff7(0x186)][0x0][_0x583ff7(0x156)](_0x583ff7(0x18d))[0x1];console[_0x583ff7(0x189)](_0x583ff7(0x170),_0x25d94b);if(!_0x25d94b){const _0x33dea1=await this[_0x583ff7(0x17a)][_0x583ff7(0x175)](_0x533d16,_0x583ff7(0x168));return _0x583e38[_0x583ff7(0x153)](0xc8)[_0x583ff7(0x1a9)](_0x33dea1);}if(_0x25d94b[_0x583ff7(0x1ac)]('/')){this[_0x583ff7(0x17a)][_0x583ff7(0x163)](_0x533d16[_0x583ff7(0x181)][0x0],_0x25d94b);const _0x4e3666=await this['officialService']['genXmlMsgByConfig'](_0x533d16,'officialBindAccountText');return _0x583e38[_0x583ff7(0x153)](0xc8)[_0x583ff7(0x1a9)](_0x4e3666);}this[_0x583ff7(0x17a)][_0x583ff7(0x188)](_0x533d16[_0x583ff7(0x181)][0x0],_0x25d94b);const _0x2bfb65=await this[_0x583ff7(0x17a)][_0x583ff7(0x175)](_0x533d16,_0x583ff7(0x168));return _0x583e38['status'](0xc8)['send'](_0x2bfb65);}if(_0x533d16[_0x583ff7(0x161)][0x0]==_0x583ff7(0x150))return _0x583e38[_0x583ff7(0x153)](0xc8)[_0x583ff7(0x1a9)]('');}if(_0x533d16[_0x583ff7(0x1a0)][0x0]==_0x583ff7(0x183)){const _0x301b53=await this['officialService'][_0x583ff7(0x14b)](_0x533d16[_0x583ff7(0x187)][0x0]),_0xae11d9=await this[_0x583ff7(0x17a)][_0x583ff7(0x182)](_0x533d16,_0x301b53);return _0x583e38['status'](0xc8)['send'](_0xae11d9);}return _0x583ff7(0x17f);}async[_0x3b3366(0x19f)](_0x2c9bb9){const _0x505acd=_0x3b3366;return this[_0x505acd(0x17a)][_0x505acd(0x19f)](_0x2c9bb9);}async[_0x3b3366(0x1a1)](_0x43eb4c){const _0x3ffc08=_0x3b3366;return this[_0x3ffc08(0x17a)][_0x3ffc08(0x1a1)](_0x43eb4c);}async[_0x3b3366(0x180)](_0x485568){const _0x8f4a76=_0x3b3366;if(process[_0x8f4a76(0x155)]['ISDEV']===_0x8f4a76(0x18f))return'';const _0x11020d=await this['officialService'][_0x8f4a76(0x185)](_0x485568[_0x8f4a76(0x166)]);return _0x8f4a76(0x17c)+encodeURIComponent(_0x11020d);}async[_0x3b3366(0x19a)](_0x55cdc5,_0x3c1878){const _0x3a6093=_0x3b3366;return this[_0x3a6093(0x17a)][_0x3a6093(0x19a)](_0x55cdc5,_0x3c1878[_0x3a6093(0x166)]);}async['bindWxBySceneStr'](_0x23b692,_0x3b7849){const _0x4bb63c=_0x3b3366;return this[_0x4bb63c(0x17a)]['bindWxBySceneStr'](_0x23b692,_0x3b7849[_0x4bb63c(0x166)]);}async[_0x3b3366(0x165)](_0xeb84dd){const _0x292390=_0x3b3366;return this[_0x292390(0x17a)][_0x292390(0x165)](_0xeb84dd['url']);}async[_0x3b3366(0x14d)](_0x3da0eb){const _0x60e101=_0x3b3366;return this[_0x60e101(0x17a)]['getJsapiTicket'](_0x3da0eb['url']);}async[_0x3b3366(0x195)](_0x2a53a3,_0x270aa2){const _0x256356=_0x3b3366;return this[_0x256356(0x17a)][_0x256356(0x195)](_0x2a53a3,_0x270aa2[_0x256356(0x199)]);}};__decorate([(0x0,common_1[_0x3b3366(0x15f)])(_0x3b3366(0x15e)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':_0x3b3366(0x184)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x3b3366(0x198)])()),__param(0x2,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata('design:type',Function),__metadata(_0x3b3366(0x171),[Object,Object,Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],'notify',null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x15e)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':_0x3b3366(0x193)}),__param(0x0,(0x0,common_1[_0x3b3366(0x16f)])()),__param(0x1,(0x0,common_1[_0x3b3366(0x198)])()),__param(0x2,(0x0,common_1[_0x3b3366(0x1a7)])()),__param(0x3,(0x0,common_1[_0x3b3366(0x1a3)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[Object,Object,Object,Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x17e),null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x19f)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[getQrSceneStr_dto_1[_0x3b3366(0x18a)]]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x19f),null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x1a1)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x3b3366(0x19e)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1['Req'])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x1a1),null),__decorate([(0x0,common_1[_0x3b3366(0x15f)])(_0x3b3366(0x180)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':_0x3b3366(0x18e)}),__param(0x0,(0x0,common_1[_0x3b3366(0x198)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[getQrCode_dto_1[_0x3b3366(0x16d)]]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x180),null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x19a)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x3b3366(0x16f)])()),__param(0x1,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[Object,getQrCode_dto_1[_0x3b3366(0x16d)]]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],'loginBySceneStr',null),__decorate([(0x0,common_1['Post'])(_0x3b3366(0x152)),(0x0,swagger_1['ApiOperation'])({'summary':_0x3b3366(0x1a6)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x3b3366(0x18b)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[Object,getQrCode_dto_1[_0x3b3366(0x16d)]]),__metadata('design:returntype',Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x152),null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x165)),(0x0,swagger_1['ApiOperation'])({'summary':_0x3b3366(0x1a5)}),__param(0x0,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],_0x3b3366(0x165),null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x14d)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController[_0x3b3366(0x15c)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x3b3366(0x192)])(_0x3b3366(0x195)),(0x0,swagger_1[_0x3b3366(0x194)])({'summary':_0x3b3366(0x196)}),__param(0x0,(0x0,common_1[_0x3b3366(0x16f)])()),__param(0x1,(0x0,common_1[_0x3b3366(0x1a7)])()),__metadata(_0x3b3366(0x174),Function),__metadata(_0x3b3366(0x171),[Object,Object]),__metadata(_0x3b3366(0x1a4),Promise)],OfficialController['prototype'],'loginByCode',null),OfficialController=__decorate([(0x0,swagger_1[_0x3b3366(0x14c)])(_0x3b3366(0x169)),(0x0,common_1[_0x3b3366(0x154)])(_0x3b3366(0x169)),__metadata(_0x3b3366(0x171),[official_service_1[_0x3b3366(0x178)]])],OfficialController),exports[_0x3b3366(0x14f)]=OfficialController;