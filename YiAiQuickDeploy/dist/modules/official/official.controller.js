'use strict';const _0x2e8a69=_0x10f9;(function(_0x342ada,_0x5df16e){const _0x37b567=_0x10f9,_0x377690=_0x342ada();while(!![]){try{const _0x89ce60=-parseInt(_0x37b567(0x168))/0x1+parseInt(_0x37b567(0x179))/0x2+-parseInt(_0x37b567(0x198))/0x3+-parseInt(_0x37b567(0x183))/0x4*(-parseInt(_0x37b567(0x18f))/0x5)+parseInt(_0x37b567(0x19b))/0x6+parseInt(_0x37b567(0x188))/0x7*(parseInt(_0x37b567(0x16a))/0x8)+parseInt(_0x37b567(0x199))/0x9;if(_0x89ce60===_0x5df16e)break;else _0x377690['push'](_0x377690['shift']());}catch(_0x24af1f){_0x377690['push'](_0x377690['shift']());}}}(_0x6020,0xde055));var __decorate=this&&this[_0x2e8a69(0x175)]||function(_0x9b3f47,_0x5be580,_0x132978,_0x15ae93){const _0x31adb8=_0x2e8a69;var _0x41be24=arguments['length'],_0x3e9223=_0x41be24<0x3?_0x5be580:_0x15ae93===null?_0x15ae93=Object[_0x31adb8(0x1b5)](_0x5be580,_0x132978):_0x15ae93,_0x32e62e;if(typeof Reflect===_0x31adb8(0x191)&&typeof Reflect[_0x31adb8(0x1b0)]===_0x31adb8(0x169))_0x3e9223=Reflect[_0x31adb8(0x1b0)](_0x9b3f47,_0x5be580,_0x132978,_0x15ae93);else{for(var _0x23c4bb=_0x9b3f47['length']-0x1;_0x23c4bb>=0x0;_0x23c4bb--)if(_0x32e62e=_0x9b3f47[_0x23c4bb])_0x3e9223=(_0x41be24<0x3?_0x32e62e(_0x3e9223):_0x41be24>0x3?_0x32e62e(_0x5be580,_0x132978,_0x3e9223):_0x32e62e(_0x5be580,_0x132978))||_0x3e9223;}return _0x41be24>0x3&&_0x3e9223&&Object[_0x31adb8(0x18a)](_0x5be580,_0x132978,_0x3e9223),_0x3e9223;},__metadata=this&&this[_0x2e8a69(0x172)]||function(_0x201b7f,_0x420fb0){const _0x3bfcfb=_0x2e8a69;if(typeof Reflect==='object'&&typeof Reflect[_0x3bfcfb(0x184)]==='function')return Reflect['metadata'](_0x201b7f,_0x420fb0);},__param=this&&this['__param']||function(_0x52f0a6,_0x25ddce){return function(_0x543390,_0x14e339){_0x25ddce(_0x543390,_0x14e339,_0x52f0a6);};};Object['defineProperty'](exports,_0x2e8a69(0x1a4),{'value':!![]}),exports[_0x2e8a69(0x170)]=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x2e8a69(0x177)),jwtAuth_guard_1=require(_0x2e8a69(0x1a5)),official_service_1=require(_0x2e8a69(0x1c3)),getQrCode_dto_1=require(_0x2e8a69(0x165)),getQrSceneStr_dto_1=require(_0x2e8a69(0x1ac));function _0x10f9(_0x2b13fc,_0x41357e){const _0x60202b=_0x6020();return _0x10f9=function(_0x10f9dd,_0xe9aff7){_0x10f9dd=_0x10f9dd-0x165;let _0x46439c=_0x60202b[_0x10f9dd];return _0x46439c;},_0x10f9(_0x2b13fc,_0x41357e);}let OfficialController=class OfficialController{constructor(_0x126a0a){const _0x1d6dfb=_0x2e8a69;this[_0x1d6dfb(0x1b9)]=_0x126a0a;}async[_0x2e8a69(0x19c)](_0x4f92bd,_0x3ee371,_0x81492e){const _0x2c26f8=_0x2e8a69;console[_0x2c26f8(0x17a)]('get\x20通知>>>',_0x3ee371,_0x81492e);const _0x1c71e9=await this[_0x2c26f8(0x1b9)]['verify'](_0x3ee371[_0x2c26f8(0x1ab)],_0x3ee371[_0x2c26f8(0x182)],_0x3ee371[_0x2c26f8(0x18d)]);return _0x1c71e9?_0x3ee371[_0x2c26f8(0x17f)]:'';}async[_0x2e8a69(0x180)](_0x118600,_0x4e82ae,_0x54cbfb,_0x4dfda2){const _0x4acf33=_0x2e8a69,{xml:_0x27c288}=_0x54cbfb;console[_0x4acf33(0x17a)]('xml:\x20',_0x27c288);if(_0x27c288[_0x4acf33(0x189)][0x0]=='event'){if(_0x27c288[_0x4acf33(0x1b6)][0x0]==_0x4acf33(0x187)||_0x27c288[_0x4acf33(0x1b6)][0x0]==_0x4acf33(0x194))return _0x4dfda2[_0x4acf33(0x17e)](0xc8)['send']('');if(_0x27c288[_0x4acf33(0x1b6)][0x0]==_0x4acf33(0x16d)){console[_0x4acf33(0x17a)]('扫码');const _0x47875b=_0x27c288[_0x4acf33(0x193)][0x0];if(_0x47875b[_0x4acf33(0x1b4)]('/')){this[_0x4acf33(0x1b9)]['scanBindWx'](_0x27c288['fromusername'][0x0],_0x47875b);const _0x350fef=await this[_0x4acf33(0x1b9)]['genXmlMsgByConfig'](_0x27c288,_0x4acf33(0x1a2));return _0x4dfda2[_0x4acf33(0x17e)](0xc8)['send'](_0x350fef);}this[_0x4acf33(0x1b9)][_0x4acf33(0x178)](_0x27c288[_0x4acf33(0x173)][0x0],_0x47875b);const _0x68cca2=await this[_0x4acf33(0x1b9)][_0x4acf33(0x1a3)](_0x27c288,_0x4acf33(0x19a));return _0x4dfda2[_0x4acf33(0x17e)](0xc8)[_0x4acf33(0x1af)](_0x68cca2);}if(_0x27c288[_0x4acf33(0x1b6)][0x0]==_0x4acf33(0x1a6)){console['log']('订阅',_0x27c288[_0x4acf33(0x193)][0x0]);const _0x49253=_0x27c288[_0x4acf33(0x193)][0x0][_0x4acf33(0x19e)](_0x4acf33(0x1b8))[0x1];console[_0x4acf33(0x17a)](_0x4acf33(0x174),_0x49253);if(!_0x49253){const _0x43a47f=await this[_0x4acf33(0x1b9)][_0x4acf33(0x1a3)](_0x27c288,_0x4acf33(0x1a9));return _0x4dfda2[_0x4acf33(0x17e)](0xc8)[_0x4acf33(0x1af)](_0x43a47f);}if(_0x49253[_0x4acf33(0x1b4)]('/')){this[_0x4acf33(0x1b9)][_0x4acf33(0x171)](_0x27c288[_0x4acf33(0x173)][0x0],_0x49253);const _0x496925=await this[_0x4acf33(0x1b9)][_0x4acf33(0x1a3)](_0x27c288,'officialBindAccountText');return _0x4dfda2[_0x4acf33(0x17e)](0xc8)[_0x4acf33(0x1af)](_0x496925);}this[_0x4acf33(0x1b9)][_0x4acf33(0x178)](_0x27c288[_0x4acf33(0x173)][0x0],_0x49253);const _0x10f208=await this['officialService'][_0x4acf33(0x1a3)](_0x27c288,_0x4acf33(0x1a9));return _0x4dfda2['status'](0xc8)[_0x4acf33(0x1af)](_0x10f208);}if(_0x27c288['event'][0x0]==_0x4acf33(0x18e))return _0x4dfda2[_0x4acf33(0x17e)](0xc8)[_0x4acf33(0x1af)]('');}if(_0x27c288['msgtype'][0x0]==_0x4acf33(0x186)){const _0x5ae032=await this[_0x4acf33(0x1b9)][_0x4acf33(0x196)](_0x27c288['content'][0x0]),_0x55b82c=await this[_0x4acf33(0x1b9)]['genXmlMsg'](_0x27c288,_0x5ae032);return _0x4dfda2[_0x4acf33(0x17e)](0xc8)['send'](_0x55b82c);}return _0x4acf33(0x181);}async[_0x2e8a69(0x1a1)](_0x5dec4a){const _0x1bdb09=_0x2e8a69;return this[_0x1bdb09(0x1b9)]['getQRSceneStr'](_0x5dec4a);}async['getQRSceneStrByBind'](_0x10dfb0){const _0x1b96c1=_0x2e8a69;return this[_0x1b96c1(0x1b9)][_0x1b96c1(0x1c2)](_0x10dfb0);}async[_0x2e8a69(0x197)](_0x545f0d){const _0x5abb47=_0x2e8a69;if(process[_0x5abb47(0x1c1)][_0x5abb47(0x1c0)]===_0x5abb47(0x17b))return'';const _0x4739f4=await this[_0x5abb47(0x1b9)][_0x5abb47(0x1bf)](_0x545f0d[_0x5abb47(0x19f)]);return _0x5abb47(0x1bc)+encodeURIComponent(_0x4739f4);}async[_0x2e8a69(0x1ba)](_0x292dba,_0x31a770){const _0x4515dd=_0x2e8a69;return this[_0x4515dd(0x1b9)]['loginBySceneStr'](_0x292dba,_0x31a770[_0x4515dd(0x19f)]);}async['bindWxBySceneStr'](_0x30ba43,_0x40ce92){const _0x34cacd=_0x2e8a69;return this[_0x34cacd(0x1b9)][_0x34cacd(0x1bd)](_0x30ba43,_0x40ce92[_0x34cacd(0x19f)]);}async['getRedirectUrl'](_0x133d43){const _0x887c3c=_0x2e8a69;return this[_0x887c3c(0x1b9)][_0x887c3c(0x1a0)](_0x133d43[_0x887c3c(0x19d)]);}async['getJsapiTicket'](_0xab4bd6){const _0x1db39e=_0x2e8a69;return this[_0x1db39e(0x1b9)]['getJsapiTicket'](_0xab4bd6['url']);}async['loginByCode'](_0x56a78d,_0x26a3cb){const _0x2454b8=_0x2e8a69;return this['officialService'][_0x2454b8(0x1b2)](_0x56a78d,_0x26a3cb['code']);}};__decorate([(0x0,common_1[_0x2e8a69(0x1ad)])('notify'),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x18b)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2e8a69(0x1b1)])()),__param(0x2,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata(_0x2e8a69(0x192),Function),__metadata(_0x2e8a69(0x190),[Object,Object,Object]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController[_0x2e8a69(0x1a8)],'notify',null),__decorate([(0x0,common_1['Post'])('notify'),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x16e)}),__param(0x0,(0x0,common_1[_0x2e8a69(0x1c4)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x2e8a69(0x1bb)])()),__param(0x3,(0x0,common_1['Res'])()),__metadata('design:type',Function),__metadata(_0x2e8a69(0x190),[Object,Object,Object,Object]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController[_0x2e8a69(0x1a8)],_0x2e8a69(0x180),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])('getQRSceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrSceneStr_dto_1[_0x2e8a69(0x1ae)]]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController[_0x2e8a69(0x1a8)],_0x2e8a69(0x1a1),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])(_0x2e8a69(0x1c2)),(0x0,swagger_1['ApiOperation'])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x2e8a69(0x1aa)])(jwtAuth_guard_1[_0x2e8a69(0x195)]),__param(0x0,(0x0,common_1[_0x2e8a69(0x1c4)])()),__metadata(_0x2e8a69(0x192),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController['prototype'],_0x2e8a69(0x1c2),null),__decorate([(0x0,common_1['Get'])(_0x2e8a69(0x197)),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x16b)}),__param(0x0,(0x0,common_1['Query'])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x2e8a69(0x1a7)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2e8a69(0x197),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])(_0x2e8a69(0x1ba)),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x1b3)}),__param(0x0,(0x0,common_1[_0x2e8a69(0x1c4)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x2e8a69(0x190),[Object,getQrCode_dto_1[_0x2e8a69(0x1a7)]]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController['prototype'],'loginBySceneStr',null),__decorate([(0x0,common_1['Post'])(_0x2e8a69(0x1bd)),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':'扫码绑定轮询查询'}),(0x0,common_1[_0x2e8a69(0x1aa)])(jwtAuth_guard_1[_0x2e8a69(0x195)]),__param(0x0,(0x0,common_1[_0x2e8a69(0x1c4)])()),__param(0x1,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata(_0x2e8a69(0x192),Function),__metadata(_0x2e8a69(0x190),[Object,getQrCode_dto_1[_0x2e8a69(0x1a7)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2e8a69(0x1bd),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])('getRedirectUrl'),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x16f)}),__param(0x0,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata(_0x2e8a69(0x192),Function),__metadata(_0x2e8a69(0x190),[Object]),__metadata(_0x2e8a69(0x176),Promise)],OfficialController['prototype'],_0x2e8a69(0x1a0),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])(_0x2e8a69(0x17d)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2e8a69(0x185)}),__param(0x0,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata(_0x2e8a69(0x192),Function),__metadata(_0x2e8a69(0x190),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2e8a69(0x1a8)],_0x2e8a69(0x17d),null),__decorate([(0x0,common_1[_0x2e8a69(0x16c)])('loginByCode'),(0x0,swagger_1[_0x2e8a69(0x166)])({'summary':_0x2e8a69(0x18c)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2e8a69(0x1bb)])()),__metadata(_0x2e8a69(0x192),Function),__metadata(_0x2e8a69(0x190),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2e8a69(0x1a8)],_0x2e8a69(0x1b2),null),OfficialController=__decorate([(0x0,swagger_1[_0x2e8a69(0x1b7)])('official'),(0x0,common_1[_0x2e8a69(0x1be)])(_0x2e8a69(0x167)),__metadata(_0x2e8a69(0x190),[official_service_1[_0x2e8a69(0x17c)]])],OfficialController),exports[_0x2e8a69(0x170)]=OfficialController;function _0x6020(){const _0x4b02b7=['./official.service','Req','./dto/getQrCode.dto','ApiOperation','official','1616328igfiEQ','function','12008gipunA','获取二维码','Post','SCAN','公众号通知接口POST','获取登录跳转地址','OfficialController','scanBindWx','__metadata','fromusername','sceneStr:\x20','__decorate','design:returntype','@nestjs/swagger','scan','2067514geploX','log','TRUE','OfficialService','getJsapiTicket','status','echostr','notifyPost','success','nonce','20XCKgNy','metadata','获取注册配置','text','VIEW','1981AaBLqZ','msgtype','defineProperty','公众号通知接口GET','公众号静默登录','timestamp','unsubscribe','1264525EppoNR','design:paramtypes','object','design:type','eventkey','CLICK','JwtAuthGuard','aotoPlay','getQRCode','4000278XAbmFQ','6180669xUKWwe','officialScanLoginText','2696070jOplWb','notify','url','split','sceneStr','getRedirectUrl','getQRSceneStr','officialBindAccountText','genXmlMsgByConfig','__esModule','../../common/auth/jwtAuth.guard','subscribe','GetQrCodeDto','prototype','officialSubscribeText','UseGuards','signature','./dto/getQrSceneStr.dto','Get','GetQrSceneStrDto','send','decorate','Query','loginByCode','扫码登录轮询查询','includes','getOwnPropertyDescriptor','event','ApiTags','qrscene_','officialService','loginBySceneStr','Body','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','bindWxBySceneStr','Controller','getQRCodeTicket','ISDEV','env','getQRSceneStrByBind'];_0x6020=function(){return _0x4b02b7;};return _0x6020();}