'use strict';const _0x2c6188=_0x3d9a;function _0x3d9a(_0x1b9847,_0x360e74){const _0x49ca04=_0x49ca();return _0x3d9a=function(_0x3d9a57,_0x347ff3){_0x3d9a57=_0x3d9a57-0xe4;let _0x1b98a9=_0x49ca04[_0x3d9a57];return _0x1b98a9;},_0x3d9a(_0x1b9847,_0x360e74);}(function(_0x3a562a,_0xee5804){const _0x359796=_0x3d9a,_0x57e3a7=_0x3a562a();while(!![]){try{const _0x4361da=-parseInt(_0x359796(0x137))/0x1*(parseInt(_0x359796(0x12d))/0x2)+parseInt(_0x359796(0xe9))/0x3*(-parseInt(_0x359796(0x12b))/0x4)+parseInt(_0x359796(0x113))/0x5*(-parseInt(_0x359796(0xf4))/0x6)+parseInt(_0x359796(0x105))/0x7+parseInt(_0x359796(0xff))/0x8+-parseInt(_0x359796(0xfc))/0x9*(parseInt(_0x359796(0x143))/0xa)+parseInt(_0x359796(0x130))/0xb*(parseInt(_0x359796(0x11a))/0xc);if(_0x4361da===_0xee5804)break;else _0x57e3a7['push'](_0x57e3a7['shift']());}catch(_0x5ccfa6){_0x57e3a7['push'](_0x57e3a7['shift']());}}}(_0x49ca,0x319e6));var __decorate=this&&this[_0x2c6188(0x110)]||function(_0x47d693,_0x37e5e8,_0x430d68,_0x2caf51){const _0x21571=_0x2c6188;var _0x38d3e7=arguments[_0x21571(0x135)],_0x57a1ee=_0x38d3e7<0x3?_0x37e5e8:_0x2caf51===null?_0x2caf51=Object[_0x21571(0xf6)](_0x37e5e8,_0x430d68):_0x2caf51,_0xf40449;if(typeof Reflect===_0x21571(0x13f)&&typeof Reflect[_0x21571(0x115)]===_0x21571(0x133))_0x57a1ee=Reflect[_0x21571(0x115)](_0x47d693,_0x37e5e8,_0x430d68,_0x2caf51);else{for(var _0x358432=_0x47d693['length']-0x1;_0x358432>=0x0;_0x358432--)if(_0xf40449=_0x47d693[_0x358432])_0x57a1ee=(_0x38d3e7<0x3?_0xf40449(_0x57a1ee):_0x38d3e7>0x3?_0xf40449(_0x37e5e8,_0x430d68,_0x57a1ee):_0xf40449(_0x37e5e8,_0x430d68))||_0x57a1ee;}return _0x38d3e7>0x3&&_0x57a1ee&&Object['defineProperty'](_0x37e5e8,_0x430d68,_0x57a1ee),_0x57a1ee;},__metadata=this&&this[_0x2c6188(0xeb)]||function(_0x1bcbca,_0x49615d){const _0x323ea8=_0x2c6188;if(typeof Reflect===_0x323ea8(0x13f)&&typeof Reflect[_0x323ea8(0xe8)]===_0x323ea8(0x133))return Reflect[_0x323ea8(0xe8)](_0x1bcbca,_0x49615d);},__param=this&&this[_0x2c6188(0xed)]||function(_0x5af937,_0x4ac11a){return function(_0x8ec1f8,_0x2d3ead){_0x4ac11a(_0x8ec1f8,_0x2d3ead,_0x5af937);};};Object[_0x2c6188(0x141)](exports,_0x2c6188(0x139),{'value':!![]}),exports[_0x2c6188(0x124)]=void 0x0;function _0x49ca(){const _0x2dfecf=['url','262934YYgQWo','officialSubscribeText','__esModule','VIEW','officialScanLoginText','@nestjs/swagger','getQRSceneStr','design:paramtypes','object','ApiTags','defineProperty','Controller','83730olvbSo','includes','bindWxBySceneStr','getQRSceneStrByBind','GetQrCodeDto','timestamp','扫码登录轮询查询','metadata','10323MTWyJY','nonce','__metadata','log','__param','prototype','GetQrSceneStrDto','JwtAuthGuard','event','UseGuards','getRedirectUrl','234jHbKrF','verify','getOwnPropertyDescriptor','sceneStr','公众号静默登录','getQRCodeTicket','./dto/getQrCode.dto','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','135MkLekG','get\x20通知>>>','getJsapiTicket','2980040eZTkOf','send','success','signature','@nestjs/common','design:returntype','718095GjKaVq','env','status','scanBindWx','notify','loginBySceneStr','subscribe','./dto/getQrSceneStr.dto','loginByCode','ApiOperation','Body','__decorate','unsubscribe','eventkey','1825lCACIo','scan','decorate','获取二维码','content','genXmlMsgByConfig','official','402828ZToYwA','获取绑定二维码的sceneStr','fromusername','split','echostr','msgtype','getQRCode','SCAN','获取登录跳转地址','design:type','OfficialController','officialBindAccountText','CLICK','Post','notifyPost','Get','aotoPlay','160SmXqun','./official.service','2WcnlnO','Res','获取注册配置','88ZEUVaK','Req','officialService','function','genXmlMsg','length'];_0x49ca=function(){return _0x2dfecf;};return _0x49ca();}const common_1=require(_0x2c6188(0x103)),swagger_1=require(_0x2c6188(0x13c)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x2c6188(0x12c)),getQrCode_dto_1=require(_0x2c6188(0xfa)),getQrSceneStr_dto_1=require(_0x2c6188(0x10c));let OfficialController=class OfficialController{constructor(_0x453c0d){const _0x24a152=_0x2c6188;this[_0x24a152(0x132)]=_0x453c0d;}async[_0x2c6188(0x109)](_0x315e61,_0x2088f7,_0x4d8ba8){const _0x1c4cc5=_0x2c6188;console['log'](_0x1c4cc5(0xfd),_0x2088f7,_0x4d8ba8);const _0x28396e=await this['officialService'][_0x1c4cc5(0xf5)](_0x2088f7[_0x1c4cc5(0x102)],_0x2088f7[_0x1c4cc5(0xea)],_0x2088f7[_0x1c4cc5(0xe6)]);return _0x28396e?_0x2088f7[_0x1c4cc5(0x11e)]:'';}async['notifyPost'](_0x251ba1,_0x234d85,_0xe9f465,_0xf01e83){const _0x52382c=_0x2c6188,{xml:_0x569a65}=_0xe9f465;console['log']('xml:\x20',_0x569a65);if(_0x569a65[_0x52382c(0x11f)][0x0]==_0x52382c(0xf1)){if(_0x569a65[_0x52382c(0xf1)][0x0]==_0x52382c(0x13a)||_0x569a65[_0x52382c(0xf1)][0x0]==_0x52382c(0x126))return _0xf01e83[_0x52382c(0x107)](0xc8)[_0x52382c(0x100)]('');if(_0x569a65[_0x52382c(0xf1)][0x0]==_0x52382c(0x121)){console[_0x52382c(0xec)]('扫码');const _0x59a561=_0x569a65['eventkey'][0x0];if(_0x59a561[_0x52382c(0x144)]('/')){this[_0x52382c(0x132)][_0x52382c(0x108)](_0x569a65[_0x52382c(0x11c)][0x0],_0x59a561);const _0x14a174=await this[_0x52382c(0x132)][_0x52382c(0x118)](_0x569a65,_0x52382c(0x125));return _0xf01e83['status'](0xc8)['send'](_0x14a174);}this[_0x52382c(0x132)][_0x52382c(0x114)](_0x569a65[_0x52382c(0x11c)][0x0],_0x59a561);const _0x2f3ca3=await this['officialService'][_0x52382c(0x118)](_0x569a65,_0x52382c(0x13b));return _0xf01e83[_0x52382c(0x107)](0xc8)[_0x52382c(0x100)](_0x2f3ca3);}if(_0x569a65['event'][0x0]==_0x52382c(0x10b)){console['log']('订阅',_0x569a65[_0x52382c(0x112)][0x0]);const _0x9ce4a0=_0x569a65['eventkey'][0x0][_0x52382c(0x11d)]('qrscene_')[0x1];console[_0x52382c(0xec)]('sceneStr:\x20',_0x9ce4a0);if(!_0x9ce4a0){const _0x45e3ea=await this[_0x52382c(0x132)][_0x52382c(0x118)](_0x569a65,'officialSubscribeText');return _0xf01e83[_0x52382c(0x107)](0xc8)[_0x52382c(0x100)](_0x45e3ea);}if(_0x9ce4a0[_0x52382c(0x144)]('/')){this['officialService'][_0x52382c(0x108)](_0x569a65[_0x52382c(0x11c)][0x0],_0x9ce4a0);const _0x10e27d=await this['officialService'][_0x52382c(0x118)](_0x569a65,_0x52382c(0x125));return _0xf01e83[_0x52382c(0x107)](0xc8)['send'](_0x10e27d);}this['officialService'][_0x52382c(0x114)](_0x569a65[_0x52382c(0x11c)][0x0],_0x9ce4a0);const _0x42543a=await this[_0x52382c(0x132)]['genXmlMsgByConfig'](_0x569a65,_0x52382c(0x138));return _0xf01e83[_0x52382c(0x107)](0xc8)['send'](_0x42543a);}if(_0x569a65[_0x52382c(0xf1)][0x0]==_0x52382c(0x111))return _0xf01e83[_0x52382c(0x107)](0xc8)['send']('');}if(_0x569a65[_0x52382c(0x11f)][0x0]=='text'){const _0x5ac13c=await this['officialService'][_0x52382c(0x12a)](_0x569a65[_0x52382c(0x117)][0x0]),_0x462bf6=await this[_0x52382c(0x132)][_0x52382c(0x134)](_0x569a65,_0x5ac13c);return _0xf01e83[_0x52382c(0x107)](0xc8)['send'](_0x462bf6);}return _0x52382c(0x101);}async['getQRSceneStr'](_0x2353c1){const _0x357062=_0x2c6188;return this[_0x357062(0x132)][_0x357062(0x13d)](_0x2353c1);}async[_0x2c6188(0xe4)](_0x18bc66){const _0x270cca=_0x2c6188;return this[_0x270cca(0x132)]['getQRSceneStrByBind'](_0x18bc66);}async[_0x2c6188(0x120)](_0x25a50c){const _0x3d155c=_0x2c6188;if(process[_0x3d155c(0x106)]['ISDEV']==='TRUE')return'';const _0x12708a=await this[_0x3d155c(0x132)][_0x3d155c(0xf9)](_0x25a50c[_0x3d155c(0xf7)]);return _0x3d155c(0xfb)+encodeURIComponent(_0x12708a);}async[_0x2c6188(0x10a)](_0x4b6da7,_0x45f537){const _0x4d1dd7=_0x2c6188;return this['officialService'][_0x4d1dd7(0x10a)](_0x4b6da7,_0x45f537[_0x4d1dd7(0xf7)]);}async[_0x2c6188(0x145)](_0x3b9c81,_0x151f6d){const _0x5cdcb6=_0x2c6188;return this[_0x5cdcb6(0x132)][_0x5cdcb6(0x145)](_0x3b9c81,_0x151f6d['sceneStr']);}async[_0x2c6188(0xf3)](_0x539556){const _0x1d9898=_0x2c6188;return this[_0x1d9898(0x132)][_0x1d9898(0xf3)](_0x539556[_0x1d9898(0x136)]);}async[_0x2c6188(0xfe)](_0x245f2c){const _0x3a6751=_0x2c6188;return this[_0x3a6751(0x132)]['getJsapiTicket'](_0x245f2c[_0x3a6751(0x136)]);}async[_0x2c6188(0x10d)](_0x5af5f7,_0x966b71){const _0x3f4403=_0x2c6188;return this['officialService'][_0x3f4403(0x10d)](_0x5af5f7,_0x966b71['code']);}};__decorate([(0x0,common_1[_0x2c6188(0x129)])('notify'),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x2c6188(0x13e),[Object,Object,Object]),__metadata(_0x2c6188(0x104),Promise)],OfficialController['prototype'],_0x2c6188(0x109),null),__decorate([(0x0,common_1['Post'])(_0x2c6188(0x109)),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x2c6188(0x131)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x2c6188(0x10f)])()),__param(0x3,(0x0,common_1[_0x2c6188(0x12e)])()),__metadata('design:type',Function),__metadata(_0x2c6188(0x13e),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2c6188(0xee)],_0x2c6188(0x128),null),__decorate([(0x0,common_1['Post'])(_0x2c6188(0x13d)),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x2c6188(0x10f)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrSceneStr_dto_1[_0x2c6188(0xef)]]),__metadata('design:returntype',Promise)],OfficialController[_0x2c6188(0xee)],_0x2c6188(0x13d),null),__decorate([(0x0,common_1['Post'])('getQRSceneStrByBind'),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0x11b)}),(0x0,common_1[_0x2c6188(0xf2)])(jwtAuth_guard_1[_0x2c6188(0xf0)]),__param(0x0,(0x0,common_1[_0x2c6188(0x131)])()),__metadata(_0x2c6188(0x123),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2c6188(0x104),Promise)],OfficialController['prototype'],_0x2c6188(0xe4),null),__decorate([(0x0,common_1[_0x2c6188(0x129)])(_0x2c6188(0x120)),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0x116)}),__param(0x0,(0x0,common_1['Query'])()),__metadata('design:type',Function),__metadata(_0x2c6188(0x13e),[getQrCode_dto_1[_0x2c6188(0xe5)]]),__metadata(_0x2c6188(0x104),Promise)],OfficialController[_0x2c6188(0xee)],'getQRCode',null),__decorate([(0x0,common_1[_0x2c6188(0x127)])('loginBySceneStr'),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0xe7)}),__param(0x0,(0x0,common_1[_0x2c6188(0x131)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x2c6188(0x123),Function),__metadata(_0x2c6188(0x13e),[Object,getQrCode_dto_1[_0x2c6188(0xe5)]]),__metadata(_0x2c6188(0x104),Promise)],OfficialController[_0x2c6188(0xee)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x2c6188(0x127)])('bindWxBySceneStr'),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':'扫码绑定轮询查询'}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x2c6188(0x131)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x2c6188(0x123),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x2c6188(0x104),Promise)],OfficialController[_0x2c6188(0xee)],_0x2c6188(0x145),null),__decorate([(0x0,common_1[_0x2c6188(0x127)])('getRedirectUrl'),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0x122)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x2c6188(0x123),Function),__metadata(_0x2c6188(0x13e),[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2c6188(0xf3),null),__decorate([(0x0,common_1['Post'])(_0x2c6188(0xfe)),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0x12f)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x2c6188(0x123),Function),__metadata(_0x2c6188(0x13e),[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2c6188(0xfe),null),__decorate([(0x0,common_1['Post'])(_0x2c6188(0x10d)),(0x0,swagger_1[_0x2c6188(0x10e)])({'summary':_0x2c6188(0xf8)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2c6188(0x10f)])()),__metadata('design:type',Function),__metadata(_0x2c6188(0x13e),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2c6188(0xee)],_0x2c6188(0x10d),null),OfficialController=__decorate([(0x0,swagger_1[_0x2c6188(0x140)])(_0x2c6188(0x119)),(0x0,common_1[_0x2c6188(0x142)])('official'),__metadata('design:paramtypes',[official_service_1['OfficialService']])],OfficialController),exports[_0x2c6188(0x124)]=OfficialController;