'use strict';function _0x3148(){const _0x18ba7a=['function','qrscene_','code','Req','VIEW','@nestjs/swagger','scanBindWx','./dto/getQrSceneStr.dto','nonce','41330FTgkCQ','ApiTags','fromusername','ISDEV','getJsapiTicket','__decorate','eventkey','msgtype','send','getQRCodeTicket','__esModule','getRedirectUrl','2431460QMFOHq','getQRSceneStrByBind','prototype','verify','officialScanLoginText','UseGuards','signature','./official.service','Post','design:paramtypes','url','bindWxBySceneStr','248jjgdVN','Get','../../common/auth/jwtAuth.guard','officialSubscribeText','Query','获取绑定二维码的sceneStr','248610MCxeBp','__param','@nestjs/common','扫码登录轮询查询','design:type','genXmlMsg','notify','ApiOperation','JwtAuthGuard','公众号静默登录','./dto/getQrCode.dto','getQRSceneStr','547516tRklLb','event','env','length','scan','xml:\x20','OfficialController','genXmlMsgByConfig','metadata','includes','design:returntype','officialBindAccountText','object','subscribe','loginByCode','扫码绑定轮询查询','officialService','GetQrCodeDto','sceneStr','获取二维码','decorate','split','loginBySceneStr','log','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','aotoPlay','OfficialService','27588nQAZKa','132811NRUitp','getQRCode','defineProperty','公众号通知接口GET','Body','timestamp','get\x20通知>>>','GetQrSceneStrDto','Res','Controller','49384VKKrsp','status'];_0x3148=function(){return _0x18ba7a;};return _0x3148();}function _0x4671(_0x436eed,_0x23cb54){const _0x314878=_0x3148();return _0x4671=function(_0x467192,_0x41ed15){_0x467192=_0x467192-0x17f;let _0x1dd699=_0x314878[_0x467192];return _0x1dd699;},_0x4671(_0x436eed,_0x23cb54);}const _0x20561d=_0x4671;(function(_0x22cd48,_0x563f85){const _0x7408e4=_0x4671,_0xcbd9f5=_0x22cd48();while(!![]){try{const _0x5b5684=parseInt(_0x7408e4(0x1a6))/0x1+parseInt(_0x7408e4(0x19b))/0x2+-parseInt(_0x7408e4(0x190))/0x3+parseInt(_0x7408e4(0x1d0))/0x4+-parseInt(_0x7408e4(0x1b2))/0x5+-parseInt(_0x7408e4(0x1c4))/0x6+parseInt(_0x7408e4(0x191))/0x7*(parseInt(_0x7408e4(0x1be))/0x8);if(_0x5b5684===_0x563f85)break;else _0xcbd9f5['push'](_0xcbd9f5['shift']());}catch(_0xbeaad9){_0xcbd9f5['push'](_0xcbd9f5['shift']());}}}(_0x3148,0x3e0bd));var __decorate=this&&this[_0x20561d(0x1ab)]||function(_0xceb7eb,_0x388e82,_0x5e0643,_0x3c006b){const _0x2a7c4c=_0x20561d;var _0x3e97f6=arguments[_0x2a7c4c(0x1d3)],_0x5be118=_0x3e97f6<0x3?_0x388e82:_0x3c006b===null?_0x3c006b=Object['getOwnPropertyDescriptor'](_0x388e82,_0x5e0643):_0x3c006b,_0x1d6403;if(typeof Reflect===_0x2a7c4c(0x181)&&typeof Reflect[_0x2a7c4c(0x189)]===_0x2a7c4c(0x19d))_0x5be118=Reflect[_0x2a7c4c(0x189)](_0xceb7eb,_0x388e82,_0x5e0643,_0x3c006b);else{for(var _0x255c82=_0xceb7eb[_0x2a7c4c(0x1d3)]-0x1;_0x255c82>=0x0;_0x255c82--)if(_0x1d6403=_0xceb7eb[_0x255c82])_0x5be118=(_0x3e97f6<0x3?_0x1d6403(_0x5be118):_0x3e97f6>0x3?_0x1d6403(_0x388e82,_0x5e0643,_0x5be118):_0x1d6403(_0x388e82,_0x5e0643))||_0x5be118;}return _0x3e97f6>0x3&&_0x5be118&&Object[_0x2a7c4c(0x193)](_0x388e82,_0x5e0643,_0x5be118),_0x5be118;},__metadata=this&&this['__metadata']||function(_0x4f4e42,_0x2d33df){const _0x18dfb9=_0x20561d;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x18dfb9(0x1d8)](_0x4f4e42,_0x2d33df);},__param=this&&this[_0x20561d(0x1c5)]||function(_0x18df49,_0x3e797f){return function(_0x56c8b0,_0x51496a){_0x3e797f(_0x56c8b0,_0x51496a,_0x18df49);};};Object[_0x20561d(0x193)](exports,_0x20561d(0x1b0),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require(_0x20561d(0x1c6)),swagger_1=require(_0x20561d(0x1a2)),jwtAuth_guard_1=require(_0x20561d(0x1c0)),official_service_1=require(_0x20561d(0x1b9)),getQrCode_dto_1=require(_0x20561d(0x1ce)),getQrSceneStr_dto_1=require(_0x20561d(0x1a4));let OfficialController=class OfficialController{constructor(_0x4e728e){const _0x3a74b5=_0x20561d;this[_0x3a74b5(0x185)]=_0x4e728e;}async['notify'](_0x4c129e,_0x5cc1f6,_0xee90f){const _0x58da59=_0x20561d;console[_0x58da59(0x18c)](_0x58da59(0x197),_0x5cc1f6,_0xee90f);const _0x5cdb05=await this[_0x58da59(0x185)][_0x58da59(0x1b5)](_0x5cc1f6[_0x58da59(0x1b8)],_0x5cc1f6[_0x58da59(0x1a5)],_0x5cc1f6[_0x58da59(0x196)]);return _0x5cdb05?_0x5cc1f6['echostr']:'';}async['notifyPost'](_0x3509fb,_0x5e4481,_0xb22c26,_0x5c79a9){const _0x2c41cc=_0x20561d,{xml:_0x422c8b}=_0xb22c26;console[_0x2c41cc(0x18c)](_0x2c41cc(0x1d5),_0x422c8b);if(_0x422c8b[_0x2c41cc(0x1ad)][0x0]==_0x2c41cc(0x1d1)){if(_0x422c8b['event'][0x0]==_0x2c41cc(0x1a1)||_0x422c8b[_0x2c41cc(0x1d1)][0x0]=='CLICK')return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)]('');if(_0x422c8b[_0x2c41cc(0x1d1)][0x0]=='SCAN'){console[_0x2c41cc(0x18c)]('扫码');const _0x48d971=_0x422c8b['eventkey'][0x0];if(_0x48d971[_0x2c41cc(0x1d9)]('/')){this[_0x2c41cc(0x185)][_0x2c41cc(0x1a3)](_0x422c8b[_0x2c41cc(0x1a8)][0x0],_0x48d971);const _0x2f4150=await this[_0x2c41cc(0x185)][_0x2c41cc(0x1d7)](_0x422c8b,_0x2c41cc(0x180));return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)](_0x2f4150);}this['officialService']['scan'](_0x422c8b[_0x2c41cc(0x1a8)][0x0],_0x48d971);const _0x1d199a=await this[_0x2c41cc(0x185)]['genXmlMsgByConfig'](_0x422c8b,_0x2c41cc(0x1b6));return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)](_0x1d199a);}if(_0x422c8b[_0x2c41cc(0x1d1)][0x0]==_0x2c41cc(0x182)){console[_0x2c41cc(0x18c)]('订阅',_0x422c8b[_0x2c41cc(0x1ac)][0x0]);const _0x475a21=_0x422c8b[_0x2c41cc(0x1ac)][0x0][_0x2c41cc(0x18a)](_0x2c41cc(0x19e))[0x1];console[_0x2c41cc(0x18c)]('sceneStr:\x20',_0x475a21);if(!_0x475a21){const _0x1f8299=await this[_0x2c41cc(0x185)][_0x2c41cc(0x1d7)](_0x422c8b,_0x2c41cc(0x1c1));return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)](_0x1f8299);}if(_0x475a21[_0x2c41cc(0x1d9)]('/')){this['officialService'][_0x2c41cc(0x1a3)](_0x422c8b[_0x2c41cc(0x1a8)][0x0],_0x475a21);const _0x26116=await this['officialService'][_0x2c41cc(0x1d7)](_0x422c8b,'officialBindAccountText');return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)](_0x26116);}this[_0x2c41cc(0x185)][_0x2c41cc(0x1d4)](_0x422c8b['fromusername'][0x0],_0x475a21);const _0x2960a2=await this[_0x2c41cc(0x185)][_0x2c41cc(0x1d7)](_0x422c8b,_0x2c41cc(0x1c1));return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)['send'](_0x2960a2);}if(_0x422c8b[_0x2c41cc(0x1d1)][0x0]=='unsubscribe')return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)[_0x2c41cc(0x1ae)]('');}if(_0x422c8b[_0x2c41cc(0x1ad)][0x0]=='text'){const _0x1f919c=await this[_0x2c41cc(0x185)][_0x2c41cc(0x18e)](_0x422c8b['content'][0x0]),_0x4f4f39=await this[_0x2c41cc(0x185)][_0x2c41cc(0x1c9)](_0x422c8b,_0x1f919c);return _0x5c79a9[_0x2c41cc(0x19c)](0xc8)['send'](_0x4f4f39);}return'success';}async['getQRSceneStr'](_0x24d250){const _0x908083=_0x20561d;return this[_0x908083(0x185)][_0x908083(0x1cf)](_0x24d250);}async[_0x20561d(0x1b3)](_0x33b7bb){const _0xe53e5=_0x20561d;return this[_0xe53e5(0x185)]['getQRSceneStrByBind'](_0x33b7bb);}async['getQRCode'](_0x5106e2){const _0x26a818=_0x20561d;if(process[_0x26a818(0x1d2)][_0x26a818(0x1a9)]==='TRUE')return'';const _0x2cef59=await this[_0x26a818(0x185)][_0x26a818(0x1af)](_0x5106e2[_0x26a818(0x187)]);return _0x26a818(0x18d)+encodeURIComponent(_0x2cef59);}async[_0x20561d(0x18b)](_0x521c93,_0x264233){const _0x5a6135=_0x20561d;return this['officialService'][_0x5a6135(0x18b)](_0x521c93,_0x264233['sceneStr']);}async['bindWxBySceneStr'](_0x4da516,_0x2f2260){const _0x4e48ea=_0x20561d;return this[_0x4e48ea(0x185)][_0x4e48ea(0x1bd)](_0x4da516,_0x2f2260['sceneStr']);}async[_0x20561d(0x1b1)](_0x1bbeba){const _0x34c1ae=_0x20561d;return this[_0x34c1ae(0x185)][_0x34c1ae(0x1b1)](_0x1bbeba[_0x34c1ae(0x1bc)]);}async[_0x20561d(0x1aa)](_0x1a3035){const _0x3c4e46=_0x20561d;return this[_0x3c4e46(0x185)]['getJsapiTicket'](_0x1a3035[_0x3c4e46(0x1bc)]);}async[_0x20561d(0x183)](_0x4434a2,_0x155500){const _0x396958=_0x20561d;return this['officialService'][_0x396958(0x183)](_0x4434a2,_0x155500[_0x396958(0x19f)]);}};__decorate([(0x0,common_1['Get'])(_0x20561d(0x1ca)),(0x0,swagger_1[_0x20561d(0x1cb)])({'summary':_0x20561d(0x194)}),__param(0x0,(0x0,common_1[_0x20561d(0x1a0)])()),__param(0x1,(0x0,common_1[_0x20561d(0x1c2)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[Object,Object,Object]),__metadata(_0x20561d(0x17f),Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x1ca),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])('notify'),(0x0,swagger_1[_0x20561d(0x1cb)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x20561d(0x1a0)])()),__param(0x1,(0x0,common_1[_0x20561d(0x1c2)])()),__param(0x2,(0x0,common_1[_0x20561d(0x195)])()),__param(0x3,(0x0,common_1[_0x20561d(0x199)])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[Object,Object,Object,Object]),__metadata(_0x20561d(0x17f),Promise)],OfficialController[_0x20561d(0x1b4)],'notifyPost',null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])('getQRSceneStr'),(0x0,swagger_1[_0x20561d(0x1cb)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x20561d(0x195)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrSceneStr_dto_1[_0x20561d(0x198)]]),__metadata(_0x20561d(0x17f),Promise)],OfficialController['prototype'],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])('getQRSceneStrByBind'),(0x0,swagger_1['ApiOperation'])({'summary':_0x20561d(0x1c3)}),(0x0,common_1[_0x20561d(0x1b7)])(jwtAuth_guard_1[_0x20561d(0x1cc)]),__param(0x0,(0x0,common_1[_0x20561d(0x1a0)])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[Object]),__metadata(_0x20561d(0x17f),Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x1b3),null),__decorate([(0x0,common_1[_0x20561d(0x1bf)])(_0x20561d(0x192)),(0x0,swagger_1[_0x20561d(0x1cb)])({'summary':_0x20561d(0x188)}),__param(0x0,(0x0,common_1['Query'])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[getQrCode_dto_1[_0x20561d(0x186)]]),__metadata(_0x20561d(0x17f),Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x192),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])(_0x20561d(0x18b)),(0x0,swagger_1['ApiOperation'])({'summary':_0x20561d(0x1c7)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x20561d(0x1bb),[Object,getQrCode_dto_1[_0x20561d(0x186)]]),__metadata(_0x20561d(0x17f),Promise)],OfficialController['prototype'],_0x20561d(0x18b),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])(_0x20561d(0x1bd)),(0x0,swagger_1['ApiOperation'])({'summary':_0x20561d(0x184)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x20561d(0x1a0)])()),__param(0x1,(0x0,common_1[_0x20561d(0x195)])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x1bd),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])(_0x20561d(0x1b1)),(0x0,swagger_1[_0x20561d(0x1cb)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x20561d(0x1c8),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x20561d(0x17f),Promise)],OfficialController['prototype'],_0x20561d(0x1b1),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])(_0x20561d(0x1aa)),(0x0,swagger_1['ApiOperation'])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x20561d(0x195)])()),__metadata(_0x20561d(0x1c8),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x20561d(0x17f),Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x1aa),null),__decorate([(0x0,common_1[_0x20561d(0x1ba)])(_0x20561d(0x183)),(0x0,swagger_1['ApiOperation'])({'summary':_0x20561d(0x1cd)}),__param(0x0,(0x0,common_1[_0x20561d(0x1a0)])()),__param(0x1,(0x0,common_1[_0x20561d(0x195)])()),__metadata(_0x20561d(0x1c8),Function),__metadata(_0x20561d(0x1bb),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x20561d(0x1b4)],_0x20561d(0x183),null),OfficialController=__decorate([(0x0,swagger_1[_0x20561d(0x1a7)])('official'),(0x0,common_1[_0x20561d(0x19a)])('official'),__metadata(_0x20561d(0x1bb),[official_service_1[_0x20561d(0x18f)]])],OfficialController),exports[_0x20561d(0x1d6)]=OfficialController;