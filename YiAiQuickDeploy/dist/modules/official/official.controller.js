'use strict';const _0x5e8c00=_0x40db;function _0x40db(_0x4c8ba1,_0x10b710){const _0x10170e=_0x1017();return _0x40db=function(_0x40dbaa,_0x1ce0c8){_0x40dbaa=_0x40dbaa-0x7e;let _0x234934=_0x10170e[_0x40dbaa];return _0x234934;},_0x40db(_0x4c8ba1,_0x10b710);}(function(_0x2db2c1,_0x267726){const _0x1c0b7a=_0x40db,_0x196f1e=_0x2db2c1();while(!![]){try{const _0x2b7963=-parseInt(_0x1c0b7a(0xc9))/0x1*(parseInt(_0x1c0b7a(0xa3))/0x2)+-parseInt(_0x1c0b7a(0xb0))/0x3+parseInt(_0x1c0b7a(0x81))/0x4*(parseInt(_0x1c0b7a(0x9d))/0x5)+parseInt(_0x1c0b7a(0xb9))/0x6*(parseInt(_0x1c0b7a(0xa7))/0x7)+parseInt(_0x1c0b7a(0x9a))/0x8+parseInt(_0x1c0b7a(0xaf))/0x9+-parseInt(_0x1c0b7a(0xa0))/0xa*(parseInt(_0x1c0b7a(0x90))/0xb);if(_0x2b7963===_0x267726)break;else _0x196f1e['push'](_0x196f1e['shift']());}catch(_0x4734f7){_0x196f1e['push'](_0x196f1e['shift']());}}}(_0x1017,0xc2502));var __decorate=this&&this[_0x5e8c00(0x8b)]||function(_0x44348c,_0x1b9ab5,_0x9f5a3e,_0x2be546){const _0x248843=_0x5e8c00;var _0x200190=arguments['length'],_0x51161f=_0x200190<0x3?_0x1b9ab5:_0x2be546===null?_0x2be546=Object[_0x248843(0xd5)](_0x1b9ab5,_0x9f5a3e):_0x2be546,_0x2b6313;if(typeof Reflect===_0x248843(0xbe)&&typeof Reflect[_0x248843(0xc0)]==='function')_0x51161f=Reflect[_0x248843(0xc0)](_0x44348c,_0x1b9ab5,_0x9f5a3e,_0x2be546);else{for(var _0x32325c=_0x44348c['length']-0x1;_0x32325c>=0x0;_0x32325c--)if(_0x2b6313=_0x44348c[_0x32325c])_0x51161f=(_0x200190<0x3?_0x2b6313(_0x51161f):_0x200190>0x3?_0x2b6313(_0x1b9ab5,_0x9f5a3e,_0x51161f):_0x2b6313(_0x1b9ab5,_0x9f5a3e))||_0x51161f;}return _0x200190>0x3&&_0x51161f&&Object[_0x248843(0x83)](_0x1b9ab5,_0x9f5a3e,_0x51161f),_0x51161f;},__metadata=this&&this[_0x5e8c00(0xae)]||function(_0x3d4770,_0x7b9dd){const _0x26fe71=_0x5e8c00;if(typeof Reflect==='object'&&typeof Reflect[_0x26fe71(0x8d)]===_0x26fe71(0xa2))return Reflect[_0x26fe71(0x8d)](_0x3d4770,_0x7b9dd);},__param=this&&this['__param']||function(_0x5bb536,_0x4befc2){return function(_0x5511e9,_0x3baa2a){_0x4befc2(_0x5511e9,_0x3baa2a,_0x5bb536);};};Object[_0x5e8c00(0x83)](exports,_0x5e8c00(0xb1),{'value':!![]}),exports['OfficialController']=void 0x0;function _0x1017(){const _0x2d9398=['18340YQVlYF','GetQrCodeDto','function','395818PMLdIb','扫码登录轮询查询','bindWxBySceneStr','GetQrSceneStrDto','1456TyTOKB','unsubscribe','SCAN','获取二维码','Req','url','getQRCode','__metadata','12924045DAhYwZ','3938649qgClPX','__esModule','sceneStr','ISDEV','env','officialBindAccountText','@nestjs/common','prototype','notifyPost','38928cJLoTD','design:returntype','fromusername','./official.service','getQRCodeTicket','object','JwtAuthGuard','decorate','genXmlMsgByConfig','Body','@nestjs/swagger','officialScanLoginText','Res','getRedirectUrl','subscribe','includes','1bpnMdf','获取绑定二维码的sceneStr','design:type','Query','loginBySceneStr','OfficialController','sceneStr:\x20','获取注册配置','getQRSceneStrByBind','scanBindWx','Controller','loginByCode','getOwnPropertyDescriptor','UseGuards','scan','TRUE','content','扫码绑定轮询查询','nonce','timestamp','64qtYzdD','officialService','defineProperty','signature','OfficialService','Post','getJsapiTicket','log','公众号静默登录','ApiTags','__decorate','split','metadata','send','xml:\x20','4873CJrxeZ','notify','official','eventkey','aotoPlay','status','Get','getQRSceneStr','msgtype','ApiOperation','514840NVWYcT','公众号通知接口GET','officialSubscribeText','84155VEXJqE','event','design:paramtypes'];_0x1017=function(){return _0x2d9398;};return _0x1017();}const common_1=require(_0x5e8c00(0xb6)),swagger_1=require(_0x5e8c00(0xc3)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x5e8c00(0xbc)),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');let OfficialController=class OfficialController{constructor(_0x32530b){const _0x3ef4a8=_0x5e8c00;this[_0x3ef4a8(0x82)]=_0x32530b;}async['notify'](_0x23fec9,_0x4df0a6,_0x56060b){const _0x3a13ec=_0x5e8c00;console[_0x3a13ec(0x88)]('get\x20通知>>>',_0x4df0a6,_0x56060b);const _0x77aec2=await this[_0x3a13ec(0x82)]['verify'](_0x4df0a6[_0x3a13ec(0x84)],_0x4df0a6[_0x3a13ec(0x7f)],_0x4df0a6[_0x3a13ec(0x80)]);return _0x77aec2?_0x4df0a6['echostr']:'';}async[_0x5e8c00(0xb8)](_0xb5a56a,_0x273149,_0x120838,_0x5441bc){const _0x16f802=_0x5e8c00,{xml:_0x3b16b4}=_0x120838;console[_0x16f802(0x88)](_0x16f802(0x8f),_0x3b16b4);if(_0x3b16b4['msgtype'][0x0]==_0x16f802(0x9e)){if(_0x3b16b4[_0x16f802(0x9e)][0x0]=='VIEW'||_0x3b16b4['event'][0x0]=='CLICK')return _0x5441bc[_0x16f802(0x95)](0xc8)[_0x16f802(0x8e)]('');if(_0x3b16b4[_0x16f802(0x9e)][0x0]==_0x16f802(0xa9)){console[_0x16f802(0x88)]('扫码');const _0x58769e=_0x3b16b4['eventkey'][0x0];if(_0x58769e['includes']('/')){this[_0x16f802(0x82)][_0x16f802(0xd2)](_0x3b16b4[_0x16f802(0xbb)][0x0],_0x58769e);const _0x12f340=await this[_0x16f802(0x82)]['genXmlMsgByConfig'](_0x3b16b4,'officialBindAccountText');return _0x5441bc['status'](0xc8)[_0x16f802(0x8e)](_0x12f340);}this[_0x16f802(0x82)]['scan'](_0x3b16b4[_0x16f802(0xbb)][0x0],_0x58769e);const _0x3fd823=await this[_0x16f802(0x82)][_0x16f802(0xc1)](_0x3b16b4,_0x16f802(0xc4));return _0x5441bc[_0x16f802(0x95)](0xc8)['send'](_0x3fd823);}if(_0x3b16b4[_0x16f802(0x9e)][0x0]==_0x16f802(0xc7)){console[_0x16f802(0x88)]('订阅',_0x3b16b4[_0x16f802(0x93)][0x0]);const _0x48a30c=_0x3b16b4[_0x16f802(0x93)][0x0][_0x16f802(0x8c)]('qrscene_')[0x1];console[_0x16f802(0x88)](_0x16f802(0xcf),_0x48a30c);if(!_0x48a30c){const _0x35d157=await this[_0x16f802(0x82)]['genXmlMsgByConfig'](_0x3b16b4,_0x16f802(0x9c));return _0x5441bc[_0x16f802(0x95)](0xc8)[_0x16f802(0x8e)](_0x35d157);}if(_0x48a30c[_0x16f802(0xc8)]('/')){this[_0x16f802(0x82)][_0x16f802(0xd2)](_0x3b16b4[_0x16f802(0xbb)][0x0],_0x48a30c);const _0x8be477=await this[_0x16f802(0x82)][_0x16f802(0xc1)](_0x3b16b4,_0x16f802(0xb5));return _0x5441bc[_0x16f802(0x95)](0xc8)[_0x16f802(0x8e)](_0x8be477);}this[_0x16f802(0x82)][_0x16f802(0xd7)](_0x3b16b4[_0x16f802(0xbb)][0x0],_0x48a30c);const _0x499cec=await this['officialService'][_0x16f802(0xc1)](_0x3b16b4,_0x16f802(0x9c));return _0x5441bc[_0x16f802(0x95)](0xc8)[_0x16f802(0x8e)](_0x499cec);}if(_0x3b16b4['event'][0x0]==_0x16f802(0xa8))return _0x5441bc['status'](0xc8)[_0x16f802(0x8e)]('');}if(_0x3b16b4[_0x16f802(0x98)][0x0]=='text'){const _0x52eb8b=await this[_0x16f802(0x82)][_0x16f802(0x94)](_0x3b16b4[_0x16f802(0xd9)][0x0]),_0x52b921=await this[_0x16f802(0x82)]['genXmlMsg'](_0x3b16b4,_0x52eb8b);return _0x5441bc['status'](0xc8)[_0x16f802(0x8e)](_0x52b921);}return'success';}async['getQRSceneStr'](_0x2dc5c0){const _0x1cab12=_0x5e8c00;return this[_0x1cab12(0x82)][_0x1cab12(0x97)](_0x2dc5c0);}async[_0x5e8c00(0xd1)](_0x126d27){const _0x1d4ea6=_0x5e8c00;return this[_0x1d4ea6(0x82)][_0x1d4ea6(0xd1)](_0x126d27);}async['getQRCode'](_0x598cb4){const _0x33b936=_0x5e8c00;if(process[_0x33b936(0xb4)][_0x33b936(0xb3)]===_0x33b936(0xd8))return'';const _0x3e24ff=await this['officialService'][_0x33b936(0xbd)](_0x598cb4['sceneStr']);return'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x3e24ff);}async[_0x5e8c00(0xcd)](_0x34903c,_0x7a8b78){const _0x52d391=_0x5e8c00;return this[_0x52d391(0x82)][_0x52d391(0xcd)](_0x34903c,_0x7a8b78[_0x52d391(0xb2)]);}async[_0x5e8c00(0xa5)](_0x2ed0ce,_0x241b00){const _0x1f11c2=_0x5e8c00;return this[_0x1f11c2(0x82)]['bindWxBySceneStr'](_0x2ed0ce,_0x241b00[_0x1f11c2(0xb2)]);}async[_0x5e8c00(0xc6)](_0x4388b6){const _0x133b02=_0x5e8c00;return this[_0x133b02(0x82)][_0x133b02(0xc6)](_0x4388b6[_0x133b02(0xac)]);}async[_0x5e8c00(0x87)](_0x2bea1b){const _0x200511=_0x5e8c00;return this['officialService'][_0x200511(0x87)](_0x2bea1b[_0x200511(0xac)]);}async[_0x5e8c00(0xd4)](_0x2d5155,_0x9a2b1b){const _0x3c3105=_0x5e8c00;return this[_0x3c3105(0x82)][_0x3c3105(0xd4)](_0x2d5155,_0x9a2b1b['code']);}};__decorate([(0x0,common_1[_0x5e8c00(0x96)])(_0x5e8c00(0x91)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0x9b)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x5e8c00(0xcc)])()),__param(0x2,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata('design:paramtypes',[Object,Object,Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController['prototype'],'notify',null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0x91)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x5e8c00(0xab)])()),__param(0x1,(0x0,common_1[_0x5e8c00(0xcc)])()),__param(0x2,(0x0,common_1[_0x5e8c00(0xc2)])()),__param(0x3,(0x0,common_1[_0x5e8c00(0xc5)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController['prototype'],_0x5e8c00(0xb8),null),__decorate([(0x0,common_1['Post'])('getQRSceneStr'),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[getQrSceneStr_dto_1[_0x5e8c00(0xa6)]]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0x97),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0xd1)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0xca)}),(0x0,common_1[_0x5e8c00(0xd6)])(jwtAuth_guard_1[_0x5e8c00(0xbf)]),__param(0x0,(0x0,common_1['Req'])()),__metadata('design:type',Function),__metadata(_0x5e8c00(0x9f),[Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0xd1),null),__decorate([(0x0,common_1[_0x5e8c00(0x96)])(_0x5e8c00(0xad)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0xaa)}),__param(0x0,(0x0,common_1['Query'])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[getQrCode_dto_1[_0x5e8c00(0xa1)]]),__metadata('design:returntype',Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0xad),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])('loginBySceneStr'),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0xa4)}),__param(0x0,(0x0,common_1[_0x5e8c00(0xab)])()),__param(0x1,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[Object,getQrCode_dto_1[_0x5e8c00(0xa1)]]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController['prototype'],_0x5e8c00(0xcd),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0xa5)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0x7e)}),(0x0,common_1[_0x5e8c00(0xd6)])(jwtAuth_guard_1[_0x5e8c00(0xbf)]),__param(0x0,(0x0,common_1[_0x5e8c00(0xab)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[Object,getQrCode_dto_1[_0x5e8c00(0xa1)]]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0xa5),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0xc6)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata('design:type',Function),__metadata(_0x5e8c00(0x9f),[Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0xc6),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0x87)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0xd0)}),__param(0x0,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0x87),null),__decorate([(0x0,common_1[_0x5e8c00(0x86)])(_0x5e8c00(0xd4)),(0x0,swagger_1[_0x5e8c00(0x99)])({'summary':_0x5e8c00(0x89)}),__param(0x0,(0x0,common_1[_0x5e8c00(0xab)])()),__param(0x1,(0x0,common_1[_0x5e8c00(0xc2)])()),__metadata(_0x5e8c00(0xcb),Function),__metadata(_0x5e8c00(0x9f),[Object,Object]),__metadata(_0x5e8c00(0xba),Promise)],OfficialController[_0x5e8c00(0xb7)],_0x5e8c00(0xd4),null),OfficialController=__decorate([(0x0,swagger_1[_0x5e8c00(0x8a)])(_0x5e8c00(0x92)),(0x0,common_1[_0x5e8c00(0xd3)])(_0x5e8c00(0x92)),__metadata(_0x5e8c00(0x9f),[official_service_1[_0x5e8c00(0x85)]])],OfficialController),exports[_0x5e8c00(0xce)]=OfficialController;