'use strict';const _0x53c8aa=_0x1ffc;function _0x228e(){const _0x1a34e2=['verify','@nestjs/common','event','getJsapiTicket','Post','OfficialService','echostr','url','design:returntype','sceneStr:\x20','log','subscribe','bindWxBySceneStr','scan','Req','unsubscribe','defineProperty','scanBindWx','__param','公众号通知接口GET','text','status','GetQrCodeDto','notify','公众号静默登录','design:paramtypes','loginBySceneStr','获取登录跳转地址','msgtype','getRedirectUrl','fromusername','./official.service','official','prototype','notifyPost','VIEW','decorate','officialService','eventkey','SCAN','313850YHNPbB','sceneStr','2VXzyca','env','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','2025RrPtyn','ApiTags','Query','genXmlMsgByConfig','获取登录二维码sceneStr','__decorate','code','扫码登录轮询查询','950589cjxezF','signature','__esModule','119481DQbmMB','OfficialController','qrscene_','get\x20通知>>>','length','394320kRiEoe','design:type','officialScanLoginText','Get','获取注册配置','success','officialSubscribeText','content','ApiOperation','getQRSceneStr','getQRCode','includes','38234wYuade','GetQrSceneStrDto','loginByCode','metadata','aotoPlay','公众号通知接口POST','UseGuards','396ylrNvt','function','@nestjs/swagger','object','getQRSceneStrByBind','getOwnPropertyDescriptor','JwtAuthGuard','split','480UnlHPf','扫码绑定轮询查询','Res','../../common/auth/jwtAuth.guard','send','nonce','Body','1557880SjJQtI'];_0x228e=function(){return _0x1a34e2;};return _0x228e();}function _0x1ffc(_0x450d10,_0x547801){const _0x228e5=_0x228e();return _0x1ffc=function(_0x1ffc4b,_0x39b362){_0x1ffc4b=_0x1ffc4b-0x1a1;let _0x43ab96=_0x228e5[_0x1ffc4b];return _0x43ab96;},_0x1ffc(_0x450d10,_0x547801);}(function(_0x4256ef,_0x26bf17){const _0x5b52e4=_0x1ffc,_0x4922dc=_0x4256ef();while(!![]){try{const _0xc7e843=parseInt(_0x5b52e4(0x1aa))/0x1+-parseInt(_0x5b52e4(0x1ac))/0x2*(-parseInt(_0x5b52e4(0x1ba))/0x3)+parseInt(_0x5b52e4(0x1bf))/0x4+parseInt(_0x5b52e4(0x1af))/0x5*(parseInt(_0x5b52e4(0x1d2))/0x6)+parseInt(_0x5b52e4(0x1cb))/0x7*(-parseInt(_0x5b52e4(0x1da))/0x8)+-parseInt(_0x5b52e4(0x1b7))/0x9+parseInt(_0x5b52e4(0x1e1))/0xa;if(_0xc7e843===_0x26bf17)break;else _0x4922dc['push'](_0x4922dc['shift']());}catch(_0x4e3a6c){_0x4922dc['push'](_0x4922dc['shift']());}}}(_0x228e,0x312da));var __decorate=this&&this[_0x53c8aa(0x1b4)]||function(_0x3ef4b7,_0x10065e,_0x1f6168,_0x21abbc){const _0x292ff7=_0x53c8aa;var _0x25c007=arguments['length'],_0x5c7010=_0x25c007<0x3?_0x10065e:_0x21abbc===null?_0x21abbc=Object[_0x292ff7(0x1d7)](_0x10065e,_0x1f6168):_0x21abbc,_0x521fce;if(typeof Reflect===_0x292ff7(0x1d5)&&typeof Reflect[_0x292ff7(0x1a6)]===_0x292ff7(0x1d3))_0x5c7010=Reflect[_0x292ff7(0x1a6)](_0x3ef4b7,_0x10065e,_0x1f6168,_0x21abbc);else{for(var _0xd9e6f9=_0x3ef4b7[_0x292ff7(0x1be)]-0x1;_0xd9e6f9>=0x0;_0xd9e6f9--)if(_0x521fce=_0x3ef4b7[_0xd9e6f9])_0x5c7010=(_0x25c007<0x3?_0x521fce(_0x5c7010):_0x25c007>0x3?_0x521fce(_0x10065e,_0x1f6168,_0x5c7010):_0x521fce(_0x10065e,_0x1f6168))||_0x5c7010;}return _0x25c007>0x3&&_0x5c7010&&Object[_0x292ff7(0x1f2)](_0x10065e,_0x1f6168,_0x5c7010),_0x5c7010;},__metadata=this&&this['__metadata']||function(_0x54c466,_0x216c73){const _0x4fdf78=_0x53c8aa;if(typeof Reflect===_0x4fdf78(0x1d5)&&typeof Reflect[_0x4fdf78(0x1ce)]==='function')return Reflect['metadata'](_0x54c466,_0x216c73);},__param=this&&this[_0x53c8aa(0x1f4)]||function(_0x360b41,_0x17ee18){return function(_0x3ba6a1,_0x3d15d0){_0x17ee18(_0x3ba6a1,_0x3d15d0,_0x360b41);};};Object[_0x53c8aa(0x1f2)](exports,_0x53c8aa(0x1b9),{'value':!![]}),exports[_0x53c8aa(0x1bb)]=void 0x0;const common_1=require(_0x53c8aa(0x1e3)),swagger_1=require(_0x53c8aa(0x1d4)),jwtAuth_guard_1=require(_0x53c8aa(0x1dd)),official_service_1=require(_0x53c8aa(0x1a1)),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');let OfficialController=class OfficialController{constructor(_0x1a8d2b){const _0x35e784=_0x53c8aa;this[_0x35e784(0x1a7)]=_0x1a8d2b;}async[_0x53c8aa(0x1f9)](_0x2298d5,_0x18195c,_0x480058){const _0x2372c7=_0x53c8aa;console[_0x2372c7(0x1ec)](_0x2372c7(0x1bd),_0x18195c,_0x480058);const _0x2fa788=await this[_0x2372c7(0x1a7)][_0x2372c7(0x1e2)](_0x18195c[_0x2372c7(0x1b8)],_0x18195c[_0x2372c7(0x1df)],_0x18195c['timestamp']);return _0x2fa788?_0x18195c[_0x2372c7(0x1e8)]:'';}async[_0x53c8aa(0x1a4)](_0x338ad2,_0x109fe9,_0x409810,_0xf5791e){const _0x33dd42=_0x53c8aa,{xml:_0xd4e3dc}=_0x409810;console[_0x33dd42(0x1ec)]('xml:\x20',_0xd4e3dc);if(_0xd4e3dc[_0x33dd42(0x1fe)][0x0]==_0x33dd42(0x1e4)){if(_0xd4e3dc['event'][0x0]==_0x33dd42(0x1a5)||_0xd4e3dc['event'][0x0]=='CLICK')return _0xf5791e[_0x33dd42(0x1f7)](0xc8)[_0x33dd42(0x1de)]('');if(_0xd4e3dc[_0x33dd42(0x1e4)][0x0]==_0x33dd42(0x1a9)){console[_0x33dd42(0x1ec)]('扫码');const _0x183171=_0xd4e3dc[_0x33dd42(0x1a8)][0x0];if(_0x183171['includes']('/')){this['officialService'][_0x33dd42(0x1f3)](_0xd4e3dc[_0x33dd42(0x200)][0x0],_0x183171);const _0x5b6dd6=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1b2)](_0xd4e3dc,'officialBindAccountText');return _0xf5791e[_0x33dd42(0x1f7)](0xc8)['send'](_0x5b6dd6);}this[_0x33dd42(0x1a7)][_0x33dd42(0x1ef)](_0xd4e3dc[_0x33dd42(0x200)][0x0],_0x183171);const _0x34f9e1=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1b2)](_0xd4e3dc,_0x33dd42(0x1c1));return _0xf5791e[_0x33dd42(0x1f7)](0xc8)[_0x33dd42(0x1de)](_0x34f9e1);}if(_0xd4e3dc[_0x33dd42(0x1e4)][0x0]==_0x33dd42(0x1ed)){console['log']('订阅',_0xd4e3dc['eventkey'][0x0]);const _0x5dedff=_0xd4e3dc['eventkey'][0x0][_0x33dd42(0x1d9)](_0x33dd42(0x1bc))[0x1];console[_0x33dd42(0x1ec)](_0x33dd42(0x1eb),_0x5dedff);if(!_0x5dedff){const _0x1ba9b2=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1b2)](_0xd4e3dc,'officialSubscribeText');return _0xf5791e[_0x33dd42(0x1f7)](0xc8)['send'](_0x1ba9b2);}if(_0x5dedff[_0x33dd42(0x1ca)]('/')){this[_0x33dd42(0x1a7)][_0x33dd42(0x1f3)](_0xd4e3dc[_0x33dd42(0x200)][0x0],_0x5dedff);const _0x3473af=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1b2)](_0xd4e3dc,'officialBindAccountText');return _0xf5791e[_0x33dd42(0x1f7)](0xc8)[_0x33dd42(0x1de)](_0x3473af);}this[_0x33dd42(0x1a7)]['scan'](_0xd4e3dc['fromusername'][0x0],_0x5dedff);const _0x7492ff=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1b2)](_0xd4e3dc,_0x33dd42(0x1c5));return _0xf5791e[_0x33dd42(0x1f7)](0xc8)[_0x33dd42(0x1de)](_0x7492ff);}if(_0xd4e3dc[_0x33dd42(0x1e4)][0x0]==_0x33dd42(0x1f1))return _0xf5791e[_0x33dd42(0x1f7)](0xc8)['send']('');}if(_0xd4e3dc[_0x33dd42(0x1fe)][0x0]==_0x33dd42(0x1f6)){const _0x231d12=await this[_0x33dd42(0x1a7)][_0x33dd42(0x1cf)](_0xd4e3dc[_0x33dd42(0x1c6)][0x0]),_0x4e842c=await this['officialService']['genXmlMsg'](_0xd4e3dc,_0x231d12);return _0xf5791e[_0x33dd42(0x1f7)](0xc8)[_0x33dd42(0x1de)](_0x4e842c);}return _0x33dd42(0x1c4);}async[_0x53c8aa(0x1c8)](_0x19f441){const _0x49afcb=_0x53c8aa;return this['officialService'][_0x49afcb(0x1c8)](_0x19f441);}async[_0x53c8aa(0x1d6)](_0x1970eb){const _0x200033=_0x53c8aa;return this[_0x200033(0x1a7)][_0x200033(0x1d6)](_0x1970eb);}async[_0x53c8aa(0x1c9)](_0x3f8987){const _0x4735d7=_0x53c8aa;if(process[_0x4735d7(0x1ad)]['ISDEV']==='TRUE')return'';const _0x4355ad=await this['officialService']['getQRCodeTicket'](_0x3f8987['sceneStr']);return _0x4735d7(0x1ae)+encodeURIComponent(_0x4355ad);}async[_0x53c8aa(0x1fc)](_0x253896,_0xb4ae02){const _0x34633c=_0x53c8aa;return this[_0x34633c(0x1a7)][_0x34633c(0x1fc)](_0x253896,_0xb4ae02['sceneStr']);}async['bindWxBySceneStr'](_0x578bae,_0x1328f6){const _0x5c6522=_0x53c8aa;return this[_0x5c6522(0x1a7)][_0x5c6522(0x1ee)](_0x578bae,_0x1328f6[_0x5c6522(0x1ab)]);}async[_0x53c8aa(0x1ff)](_0x184177){const _0x129acb=_0x53c8aa;return this['officialService'][_0x129acb(0x1ff)](_0x184177[_0x129acb(0x1e9)]);}async[_0x53c8aa(0x1e5)](_0x2d72ca){const _0x233315=_0x53c8aa;return this[_0x233315(0x1a7)][_0x233315(0x1e5)](_0x2d72ca[_0x233315(0x1e9)]);}async[_0x53c8aa(0x1cd)](_0x58191b,_0x2ead2a){const _0x2d9e29=_0x53c8aa;return this['officialService']['loginByCode'](_0x58191b,_0x2ead2a[_0x2d9e29(0x1b5)]);}};__decorate([(0x0,common_1[_0x53c8aa(0x1c2)])(_0x53c8aa(0x1f9)),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1f5)}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1f0)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x53c8aa(0x1e0)])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object,Object,Object]),__metadata(_0x53c8aa(0x1ea),Promise)],OfficialController[_0x53c8aa(0x1a3)],_0x53c8aa(0x1f9),null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])(_0x53c8aa(0x1f9)),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1d0)}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1f0)])()),__param(0x1,(0x0,common_1[_0x53c8aa(0x1b1)])()),__param(0x2,(0x0,common_1[_0x53c8aa(0x1e0)])()),__param(0x3,(0x0,common_1[_0x53c8aa(0x1dc)])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x53c8aa(0x1a4),null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])(_0x53c8aa(0x1c8)),(0x0,swagger_1['ApiOperation'])({'summary':_0x53c8aa(0x1b3)}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1e0)])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[getQrSceneStr_dto_1[_0x53c8aa(0x1cc)]]),__metadata(_0x53c8aa(0x1ea),Promise)],OfficialController[_0x53c8aa(0x1a3)],_0x53c8aa(0x1c8),null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x53c8aa(0x1d1)])(jwtAuth_guard_1[_0x53c8aa(0x1d8)]),__param(0x0,(0x0,common_1[_0x53c8aa(0x1f0)])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object]),__metadata(_0x53c8aa(0x1ea),Promise)],OfficialController['prototype'],_0x53c8aa(0x1d6),null),__decorate([(0x0,common_1[_0x53c8aa(0x1c2)])('getQRCode'),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1b1)])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x53c8aa(0x1a3)],_0x53c8aa(0x1c9),null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])('loginBySceneStr'),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1b6)}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1f0)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object,getQrCode_dto_1[_0x53c8aa(0x1f8)]]),__metadata(_0x53c8aa(0x1ea),Promise)],OfficialController[_0x53c8aa(0x1a3)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])(_0x53c8aa(0x1ee)),(0x0,swagger_1['ApiOperation'])({'summary':_0x53c8aa(0x1db)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x53c8aa(0x1d8)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x53c8aa(0x1f8)]]),__metadata(_0x53c8aa(0x1ea),Promise)],OfficialController[_0x53c8aa(0x1a3)],'bindWxBySceneStr',null),__decorate([(0x0,common_1['Post'])(_0x53c8aa(0x1ff)),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1fd)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x53c8aa(0x1ff),null),__decorate([(0x0,common_1['Post'])(_0x53c8aa(0x1e5)),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1c3)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x53c8aa(0x1a3)],_0x53c8aa(0x1e5),null),__decorate([(0x0,common_1[_0x53c8aa(0x1e6)])(_0x53c8aa(0x1cd)),(0x0,swagger_1[_0x53c8aa(0x1c7)])({'summary':_0x53c8aa(0x1fa)}),__param(0x0,(0x0,common_1[_0x53c8aa(0x1f0)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x53c8aa(0x1c0),Function),__metadata(_0x53c8aa(0x1fb),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x53c8aa(0x1cd),null),OfficialController=__decorate([(0x0,swagger_1[_0x53c8aa(0x1b0)])('official'),(0x0,common_1['Controller'])(_0x53c8aa(0x1a2)),__metadata('design:paramtypes',[official_service_1[_0x53c8aa(0x1e7)]])],OfficialController),exports[_0x53c8aa(0x1bb)]=OfficialController;