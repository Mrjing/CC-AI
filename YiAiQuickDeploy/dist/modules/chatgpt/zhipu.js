'use strict';const _0x34be88=_0x488c;(function(_0x270414,_0x39aa7c){const _0x2105ed=_0x488c,_0x50c392=_0x270414();while(!![]){try{const _0x1d503e=parseInt(_0x2105ed(0x1d4))/0x1+parseInt(_0x2105ed(0x1d7))/0x2*(-parseInt(_0x2105ed(0x1da))/0x3)+parseInt(_0x2105ed(0x1f0))/0x4*(-parseInt(_0x2105ed(0x1ee))/0x5)+-parseInt(_0x2105ed(0x1e0))/0x6+-parseInt(_0x2105ed(0x1f2))/0x7*(-parseInt(_0x2105ed(0x1d1))/0x8)+parseInt(_0x2105ed(0x1f7))/0x9*(-parseInt(_0x2105ed(0x1e1))/0xa)+parseInt(_0x2105ed(0x1df))/0xb;if(_0x1d503e===_0x39aa7c)break;else _0x50c392['push'](_0x50c392['shift']());}catch(_0x1a746d){_0x50c392['push'](_0x50c392['shift']());}}}(_0x1ada,0x2ecfb));Object[_0x34be88(0x1db)](exports,_0x34be88(0x1e9),{'value':!![]}),exports['sendMessageFromZhipu']=exports['compilerStream']=exports[_0x34be88(0x1f3)]=exports[_0x34be88(0x1ea)]=void 0x0;const axios=require(_0x34be88(0x1d0)),jwt=require(_0x34be88(0x1d5));function _0x488c(_0x202123,_0x5aeb7d){const _0x1adae6=_0x1ada();return _0x488c=function(_0x488c6b,_0x232987){_0x488c6b=_0x488c6b-0x1d0;let _0x3d898e=_0x1adae6[_0x488c6b];return _0x3d898e;},_0x488c(_0x202123,_0x5aeb7d);}function generateToken(_0x3fd7da,_0x47816f=0x3e8*0x3c*0x3c*0x18*0x168){const _0x3e039c=_0x34be88,[_0x4e0134,_0x550ced]=_0x3fd7da[_0x3e039c(0x1d3)]('.'),_0x43c766={'api_key':_0x4e0134,'exp':Math[_0x3e039c(0x1ec)](Date[_0x3e039c(0x1d6)]())+_0x47816f*0x3e8,'timestamp':Math[_0x3e039c(0x1ec)](Date[_0x3e039c(0x1d6)]())};return jwt[_0x3e039c(0x1de)](_0x43c766,_0x550ced,{'algorithm':_0x3e039c(0x1d9),'header':{'alg':_0x3e039c(0x1d9),'sign_type':'SIGN'}});}exports[_0x34be88(0x1ea)]=generateToken;function compilerMetaJsonStr(_0x2957f2){const _0x58f105=_0x34be88;let _0x18f994={};try{_0x18f994=JSON[_0x58f105(0x1dd)](_0x2957f2);}catch(_0x3a20d0){_0x18f994={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console['error']('json\x20parse\x20error\x20from\x20zhipu!',_0x2957f2);}return _0x18f994;}exports['compilerMetaJsonStr']=compilerMetaJsonStr;function compilerStream(_0x276d73){const _0x21869b=_0x34be88;var _0x52b6f1;if(_0x276d73[_0x21869b(0x1d8)]===0x3)return{'event':_0x276d73[0x0][_0x21869b(0x1e5)]('event:',''),'id':_0x276d73[0x1]['replace'](_0x21869b(0x1e4),''),'is_end':![],'result':_0x276d73[0x2]['replace'](_0x21869b(0x1d2),'')[_0x21869b(0x1ed)]()};if(_0x276d73['length']===0x4)return{'event':_0x276d73[0x0][_0x21869b(0x1e5)]('event:',''),'id':_0x276d73[0x1][_0x21869b(0x1e5)](_0x21869b(0x1e4),''),'result':_0x276d73[0x2]['replace'](_0x21869b(0x1d2),'')['trim'](),'is_end':!![],'usage':(_0x52b6f1=compilerMetaJsonStr(_0x276d73[0x3]['replace'](_0x21869b(0x1e2),'')))===null||_0x52b6f1===void 0x0?void 0x0:_0x52b6f1[_0x21869b(0x1f4)]};}exports['compilerStream']=compilerStream;async function sendMessageFromZhipu(_0x59b98b,{onProgress:_0x4f8675,key:_0xf4693e,model:_0x53d88f,temperature:temperature=0.95}){const _0x15e400=await generateToken(_0xf4693e);return new Promise((_0x516275,_0x91dcbd)=>{const _0x3f63e4=_0x488c,_0x44f660=_0x3f63e4(0x1f8)+_0x53d88f+'/sse-invoke',_0x4723fe={'method':_0x3f63e4(0x1dc),'url':_0x44f660,'responseType':_0x3f63e4(0x1e8),'headers':{'Content-Type':_0x3f63e4(0x1e3),'Authorization':_0x15e400},'data':{'prompt':_0x59b98b,'temperature':temperature}};axios(_0x4723fe)[_0x3f63e4(0x1f1)](_0x38c369=>{const _0x2a305a=_0x3f63e4,_0x176c7a=_0x38c369[_0x2a305a(0x1ef)];let _0x1b82e1,_0x46df8f='';_0x176c7a['on'](_0x2a305a(0x1ef),_0x54f5ea=>{const _0x3c2e7b=_0x2a305a,_0x490343=_0x54f5ea['toString']()[_0x3c2e7b(0x1d3)]('\x0a')[_0x3c2e7b(0x1f5)](_0x31c6bd=>_0x31c6bd[_0x3c2e7b(0x1ed)]()!==''),_0x30e3ca=compilerStream(_0x490343);if(!_0x30e3ca)return;const {id:_0x17e0bd,result:_0x14285d,is_end:_0x109c51}=_0x30e3ca;_0x14285d&&(_0x46df8f+=_0x14285d[_0x3c2e7b(0x1ed)]()),_0x109c51&&(_0x30e3ca[_0x3c2e7b(0x1f6)]=![],_0x1b82e1=_0x30e3ca,_0x1b82e1[_0x3c2e7b(0x1eb)]=_0x46df8f),_0x4f8675(_0x30e3ca);}),_0x176c7a['on']('end',()=>{_0x516275(_0x1b82e1),_0x46df8f='';});})['catch'](_0x434d12=>{const _0x5da748=_0x3f63e4;console[_0x5da748(0x1e7)](_0x5da748(0x1e6),_0x434d12);});});}exports['sendMessageFromZhipu']=sendMessageFromZhipu;function _0x1ada(){const _0x5d2f75=['length','HS256','33UgRMfP','defineProperty','POST','parse','sign','1827122BmSoMH','546738dOZexn','3188150fVRDFJ','meta:','application/json','id:','replace','error:\x20','log','stream','__esModule','generateToken','text','round','trim','33605UYvKXl','data','164evDRgK','then','7XvgzeR','compilerMetaJsonStr','usage','filter','is_end','9XDYsPu','https://open.bigmodel.cn/api/paas/v3/model-api/','axios','2975144RZOmWk','data:','split','350881rWpAml','jsonwebtoken','now','2116DpqcVm'];_0x1ada=function(){return _0x5d2f75;};return _0x1ada();}