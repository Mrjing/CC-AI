'use strict';const _0x4f4b48=_0x2184;function _0x2184(_0x169dd3,_0x31725c){const _0x1077f3=_0x1077();return _0x2184=function(_0x2184d0,_0x2a7a84){_0x2184d0=_0x2184d0-0x196;let _0x5596a0=_0x1077f3[_0x2184d0];return _0x5596a0;},_0x2184(_0x169dd3,_0x31725c);}(function(_0x330da4,_0x225143){const _0x315255=_0x2184,_0xbe46ca=_0x330da4();while(!![]){try{const _0x46c965=parseInt(_0x315255(0x19a))/0x1+parseInt(_0x315255(0x197))/0x2*(-parseInt(_0x315255(0x1b6))/0x3)+-parseInt(_0x315255(0x1b2))/0x4+-parseInt(_0x315255(0x19b))/0x5*(-parseInt(_0x315255(0x1b1))/0x6)+-parseInt(_0x315255(0x1a6))/0x7*(-parseInt(_0x315255(0x1b7))/0x8)+-parseInt(_0x315255(0x1a1))/0x9*(-parseInt(_0x315255(0x1ac))/0xa)+parseInt(_0x315255(0x1b5))/0xb;if(_0x46c965===_0x225143)break;else _0xbe46ca['push'](_0xbe46ca['shift']());}catch(_0xe725b5){_0xbe46ca['push'](_0xbe46ca['shift']());}}}(_0x1077,0x6e839));Object[_0x4f4b48(0x1bf)](exports,_0x4f4b48(0x1a9),{'value':!![]}),exports[_0x4f4b48(0x1c0)]=exports['compilerStream']=exports[_0x4f4b48(0x1ab)]=exports['generateToken']=void 0x0;const axios=require('axios'),jwt=require('jsonwebtoken');function generateToken(_0x493bed,_0x292ff3=0x3e8*0x3c*0x3c*0x18*0x168){const _0x47b52e=_0x4f4b48,[_0x3f5c68,_0x13e2ed]=_0x493bed[_0x47b52e(0x1ba)]('.'),_0x4cc738={'api_key':_0x3f5c68,'exp':Math[_0x47b52e(0x1aa)](Date['now']())+_0x292ff3*0x3e8,'timestamp':Math[_0x47b52e(0x1aa)](Date['now']())};return jwt['sign'](_0x4cc738,_0x13e2ed,{'algorithm':_0x47b52e(0x19f),'header':{'alg':'HS256','sign_type':_0x47b52e(0x1be)}});}exports[_0x4f4b48(0x1a4)]=generateToken;function compilerMetaJsonStr(_0x57cab8){const _0x440ed3=_0x4f4b48;let _0x326574={};try{_0x326574=JSON['parse'](_0x57cab8);}catch(_0x413807){_0x326574={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x440ed3(0x1ad)](_0x440ed3(0x19e),_0x57cab8);}return _0x326574;}exports[_0x4f4b48(0x1ab)]=compilerMetaJsonStr;function compilerStream(_0x1196ea){const _0x3ad5c9=_0x4f4b48;var _0x148da2;if(_0x1196ea['length']===0x3)return{'event':_0x1196ea[0x0][_0x3ad5c9(0x19c)](_0x3ad5c9(0x1c1),''),'id':_0x1196ea[0x1]['replace'](_0x3ad5c9(0x1b3),''),'is_end':![],'result':_0x1196ea[0x2]['replace'](_0x3ad5c9(0x1a2),'')[_0x3ad5c9(0x1b8)]()};if(_0x1196ea[_0x3ad5c9(0x1a7)]===0x4)return{'event':_0x1196ea[0x0][_0x3ad5c9(0x19c)]('event:',''),'id':_0x1196ea[0x1][_0x3ad5c9(0x19c)](_0x3ad5c9(0x1b3),''),'result':_0x1196ea[0x2]['replace'](_0x3ad5c9(0x1a2),'')['trim'](),'is_end':!![],'usage':(_0x148da2=compilerMetaJsonStr(_0x1196ea[0x3][_0x3ad5c9(0x19c)](_0x3ad5c9(0x1b9),'')))===null||_0x148da2===void 0x0?void 0x0:_0x148da2[_0x3ad5c9(0x1bb)]};}exports[_0x4f4b48(0x1b0)]=compilerStream;function _0x1077(){const _0x1a21a7=['SIGN','defineProperty','sendMessageFromZhipu','event:','then','154086fzWCIU','https://open.bigmodel.cn/api/paas/v3/model-api/','/sse-invoke','486913ZocVru','39595IkVDys','replace','log','json\x20parse\x20error\x20from\x20zhipu!','HS256','toString','34893LTzwVW','data:','is_end','generateToken','catch','14BVtjES','length','error:\x20','__esModule','round','compilerMetaJsonStr','400URbCfH','error','end','data','compilerStream','606ZqfhoV','3296096ihFKDS','id:','filter','340670rQlrXS','15RufZYG','756488BEUoCe','trim','meta:','split','usage','POST','application/json'];_0x1077=function(){return _0x1a21a7;};return _0x1077();}async function sendMessageFromZhipu(_0xe84f1d,{onProgress:_0x4ed669,key:_0x52fd5d,model:_0x161711,temperature:temperature=0.95}){const _0x17c8ff=await generateToken(_0x52fd5d);return new Promise((_0x419fec,_0x156c6e)=>{const _0xe524d0=_0x2184,_0x1c6d58=_0xe524d0(0x198)+_0x161711+_0xe524d0(0x199),_0x480fc8={'method':_0xe524d0(0x1bc),'url':_0x1c6d58,'responseType':'stream','headers':{'Content-Type':_0xe524d0(0x1bd),'Authorization':_0x17c8ff},'data':{'prompt':_0xe84f1d,'temperature':temperature}};axios(_0x480fc8)[_0xe524d0(0x196)](_0x1bd906=>{const _0x49e66e=_0xe524d0,_0x3d2273=_0x1bd906[_0x49e66e(0x1af)];let _0x50ab4f,_0x3fc0a9='';_0x3d2273['on'](_0x49e66e(0x1af),_0x3099e8=>{const _0x37ec50=_0x49e66e,_0x578b20=_0x3099e8[_0x37ec50(0x1a0)]()[_0x37ec50(0x1ba)]('\x0a')[_0x37ec50(0x1b4)](_0x3e7334=>_0x3e7334[_0x37ec50(0x1b8)]()!==''),_0x25723e=compilerStream(_0x578b20);if(!_0x25723e)return;const {id:_0x3e4a5a,result:_0x1c2829,is_end:_0xd543dd}=_0x25723e;_0x1c2829&&(_0x3fc0a9+=_0x1c2829[_0x37ec50(0x1b8)]()),_0xd543dd&&(_0x25723e[_0x37ec50(0x1a3)]=![],_0x50ab4f=_0x25723e,_0x50ab4f['text']=_0x3fc0a9),_0x4ed669(_0x25723e);}),_0x3d2273['on'](_0x49e66e(0x1ae),()=>{_0x419fec(_0x50ab4f),_0x3fc0a9='';});})[_0xe524d0(0x1a5)](_0x38a0b8=>{const _0x4b774b=_0xe524d0;console[_0x4b774b(0x19d)](_0x4b774b(0x1a8),_0x38a0b8);});});}exports[_0x4f4b48(0x1c0)]=sendMessageFromZhipu;