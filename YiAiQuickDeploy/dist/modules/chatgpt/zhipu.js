'use strict';const _0x115b69=_0x6cc4;(function(_0x1d5935,_0x29e460){const _0x1fd504=_0x6cc4,_0x4443f1=_0x1d5935();while(!![]){try{const _0x25247b=parseInt(_0x1fd504(0x185))/0x1*(parseInt(_0x1fd504(0x193))/0x2)+-parseInt(_0x1fd504(0x18a))/0x3+-parseInt(_0x1fd504(0x167))/0x4*(parseInt(_0x1fd504(0x194))/0x5)+parseInt(_0x1fd504(0x187))/0x6+-parseInt(_0x1fd504(0x172))/0x7+-parseInt(_0x1fd504(0x177))/0x8+parseInt(_0x1fd504(0x168))/0x9*(parseInt(_0x1fd504(0x16d))/0xa);if(_0x25247b===_0x29e460)break;else _0x4443f1['push'](_0x4443f1['shift']());}catch(_0x4e7333){_0x4443f1['push'](_0x4443f1['shift']());}}}(_0x11ee,0x753c6));Object[_0x115b69(0x16a)](exports,_0x115b69(0x181),{'value':!![]}),exports['sendMessageFromZhipu']=exports[_0x115b69(0x191)]=exports[_0x115b69(0x178)]=exports[_0x115b69(0x182)]=void 0x0;function _0x11ee(){const _0x2999e2=['jsonwebtoken','round','log','event:','error:\x20','toString','compilerStream','application/json','4luZyxR','1017540KoAqsA','stream','then','16hUektY','1939455xlRybs','end','defineProperty','axios','SIGN','130LKizNN','length','error','HS256','https://open.bigmodel.cn/api/paas/v3/model-api/','4860044FUiCtO','trim','data:','filter','json\x20parse\x20error\x20from\x20zhipu!','5240624YKRpjq','compilerMetaJsonStr','is_end','data','sendMessageFromZhipu','split','id:','catch','/sse-invoke','text','__esModule','generateToken','parse','now','25143SpLLLQ','sign','2447586GhOXdL','replace','usage','1848156JdNFOF'];_0x11ee=function(){return _0x2999e2;};return _0x11ee();}const axios=require(_0x115b69(0x16b)),jwt=require(_0x115b69(0x18b));function generateToken(_0x44cc32,_0x5b4523=0x3e8*0x3c*0x3c*0x18*0x168){const _0x5c302b=_0x115b69,[_0x22e3ae,_0x2daaa7]=_0x44cc32[_0x5c302b(0x17c)]('.'),_0x449020={'api_key':_0x22e3ae,'exp':Math[_0x5c302b(0x18c)](Date[_0x5c302b(0x184)]())+_0x5b4523*0x3e8,'timestamp':Math[_0x5c302b(0x18c)](Date[_0x5c302b(0x184)]())};return jwt[_0x5c302b(0x186)](_0x449020,_0x2daaa7,{'algorithm':_0x5c302b(0x170),'header':{'alg':_0x5c302b(0x170),'sign_type':_0x5c302b(0x16c)}});}exports['generateToken']=generateToken;function compilerMetaJsonStr(_0x499a6c){const _0x50b095=_0x115b69;let _0x5b9172={};try{_0x5b9172=JSON[_0x50b095(0x183)](_0x499a6c);}catch(_0x5785a5){_0x5b9172={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x50b095(0x16f)](_0x50b095(0x176),_0x499a6c);}return _0x5b9172;}exports['compilerMetaJsonStr']=compilerMetaJsonStr;function _0x6cc4(_0x5a2c18,_0x209444){const _0x11ee56=_0x11ee();return _0x6cc4=function(_0x6cc493,_0x322dc8){_0x6cc493=_0x6cc493-0x166;let _0x1e6351=_0x11ee56[_0x6cc493];return _0x1e6351;},_0x6cc4(_0x5a2c18,_0x209444);}function compilerStream(_0x4f3cd7){const _0x378671=_0x115b69;var _0xc3dbdc;if(_0x4f3cd7[_0x378671(0x16e)]===0x3)return{'event':_0x4f3cd7[0x0]['replace'](_0x378671(0x18e),''),'id':_0x4f3cd7[0x1][_0x378671(0x188)](_0x378671(0x17d),''),'is_end':![],'result':_0x4f3cd7[0x2][_0x378671(0x188)](_0x378671(0x174),'')[_0x378671(0x173)]()};if(_0x4f3cd7['length']===0x4)return{'event':_0x4f3cd7[0x0][_0x378671(0x188)](_0x378671(0x18e),''),'id':_0x4f3cd7[0x1]['replace'](_0x378671(0x17d),''),'result':_0x4f3cd7[0x2][_0x378671(0x188)](_0x378671(0x174),'')[_0x378671(0x173)](),'is_end':!![],'usage':(_0xc3dbdc=compilerMetaJsonStr(_0x4f3cd7[0x3][_0x378671(0x188)]('meta:','')))===null||_0xc3dbdc===void 0x0?void 0x0:_0xc3dbdc[_0x378671(0x189)]};}exports[_0x115b69(0x191)]=compilerStream;async function sendMessageFromZhipu(_0x456153,{onProgress:_0x10e650,key:_0xa5dec5,model:_0x16494c,temperature:temperature=0.95}){const _0x243308=await generateToken(_0xa5dec5);return new Promise((_0x5461fb,_0x3a207d)=>{const _0x4b76d6=_0x6cc4,_0x5cb2f7=_0x4b76d6(0x171)+_0x16494c+_0x4b76d6(0x17f),_0x2cf276={'method':'POST','url':_0x5cb2f7,'responseType':_0x4b76d6(0x195),'headers':{'Content-Type':_0x4b76d6(0x192),'Authorization':_0x243308},'data':{'prompt':_0x456153,'temperature':temperature}};axios(_0x2cf276)[_0x4b76d6(0x166)](_0x407a02=>{const _0x11d200=_0x4b76d6,_0x51b397=_0x407a02[_0x11d200(0x17a)];let _0xd0348e,_0x47464b='';_0x51b397['on'](_0x11d200(0x17a),_0x56366b=>{const _0x23ca29=_0x11d200,_0x51abe1=_0x56366b[_0x23ca29(0x190)]()[_0x23ca29(0x17c)]('\x0a')[_0x23ca29(0x175)](_0xfe0c79=>_0xfe0c79['trim']()!==''),_0x5418f2=compilerStream(_0x51abe1);if(!_0x5418f2)return;const {id:_0x309f5b,result:_0x39fee9,is_end:_0x26f4b1}=_0x5418f2;_0x39fee9&&(_0x47464b+=_0x39fee9[_0x23ca29(0x173)]()),_0x26f4b1&&(_0x5418f2[_0x23ca29(0x179)]=![],_0xd0348e=_0x5418f2,_0xd0348e[_0x23ca29(0x180)]=_0x47464b),_0x10e650(_0x5418f2);}),_0x51b397['on'](_0x11d200(0x169),()=>{_0x5461fb(_0xd0348e),_0x47464b='';});})[_0x4b76d6(0x17e)](_0x2417a5=>{const _0x426501=_0x4b76d6;console[_0x426501(0x18d)](_0x426501(0x18f),_0x2417a5);});});}exports[_0x115b69(0x17b)]=sendMessageFromZhipu;