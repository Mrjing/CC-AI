'use strict';const _0xca8f74=_0x32cd;(function(_0xde88ed,_0x171078){const _0x4c04e0=_0x32cd,_0x211e90=_0xde88ed();while(!![]){try{const _0x1b1952=-parseInt(_0x4c04e0(0x192))/0x1*(-parseInt(_0x4c04e0(0x18a))/0x2)+parseInt(_0x4c04e0(0x198))/0x3+parseInt(_0x4c04e0(0x181))/0x4+parseInt(_0x4c04e0(0x1a8))/0x5*(parseInt(_0x4c04e0(0x190))/0x6)+parseInt(_0x4c04e0(0x18c))/0x7+parseInt(_0x4c04e0(0x195))/0x8+-parseInt(_0x4c04e0(0x191))/0x9*(parseInt(_0x4c04e0(0x17e))/0xa);if(_0x1b1952===_0x171078)break;else _0x211e90['push'](_0x211e90['shift']());}catch(_0x1e51d2){_0x211e90['push'](_0x211e90['shift']());}}}(_0x29e2,0x54859));Object['defineProperty'](exports,_0xca8f74(0x1a1),{'value':!![]}),exports[_0xca8f74(0x19a)]=exports[_0xca8f74(0x186)]=exports['compilerMetaJsonStr']=exports[_0xca8f74(0x18d)]=void 0x0;const axios=require(_0xca8f74(0x1a2)),jwt=require(_0xca8f74(0x187));function generateToken(_0x4bc5a7,_0x43faf1=0x3e8*0x3c*0x3c*0x18*0x168){const _0x3fcd4d=_0xca8f74,[_0x58a723,_0x37d952]=_0x4bc5a7[_0x3fcd4d(0x182)]('.'),_0x20023f={'api_key':_0x58a723,'exp':Math['round'](Date['now']())+_0x43faf1*0x3e8,'timestamp':Math[_0x3fcd4d(0x180)](Date[_0x3fcd4d(0x193)]())};return jwt[_0x3fcd4d(0x1a7)](_0x20023f,_0x37d952,{'algorithm':_0x3fcd4d(0x1a6),'header':{'alg':_0x3fcd4d(0x1a6),'sign_type':_0x3fcd4d(0x1a3)}});}exports[_0xca8f74(0x18d)]=generateToken;function compilerMetaJsonStr(_0x14e92a){const _0x4bde38=_0xca8f74;let _0x4c7eb4={};try{_0x4c7eb4=JSON[_0x4bde38(0x19c)](_0x14e92a);}catch(_0x4ebf8b){_0x4c7eb4={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console['error'](_0x4bde38(0x19d),_0x14e92a);}return _0x4c7eb4;}function _0x29e2(){const _0x25028c=['POST','data:','compilerStream','jsonwebtoken','text','id:','26CrmNer','end','41377JVbtSv','generateToken','replace','filter','576lDLXZO','505512DBKLMA','863Tjohgn','now','toString','2177104qXqFab','event:','usage','1329573JAoOCB','data','sendMessageFromZhipu','is_end','parse','json\x20parse\x20error\x20from\x20zhipu!','catch','error:\x20','compilerMetaJsonStr','__esModule','axios','SIGN','https://open.bigmodel.cn/api/paas/v3/model-api/','log','HS256','sign','13455jLbRGl','stream','trim','130NJYOho','application/json','round','342360VVhAao','split','then'];_0x29e2=function(){return _0x25028c;};return _0x29e2();}exports[_0xca8f74(0x1a0)]=compilerMetaJsonStr;function compilerStream(_0x168efd){const _0x291418=_0xca8f74;var _0x4ec197;if(_0x168efd['length']===0x3)return{'event':_0x168efd[0x0][_0x291418(0x18e)](_0x291418(0x196),''),'id':_0x168efd[0x1][_0x291418(0x18e)](_0x291418(0x189),''),'is_end':![],'result':_0x168efd[0x2][_0x291418(0x18e)](_0x291418(0x185),'')['trim']()};if(_0x168efd['length']===0x4)return{'event':_0x168efd[0x0][_0x291418(0x18e)](_0x291418(0x196),''),'id':_0x168efd[0x1][_0x291418(0x18e)](_0x291418(0x189),''),'result':_0x168efd[0x2][_0x291418(0x18e)]('data:','')['trim'](),'is_end':!![],'usage':(_0x4ec197=compilerMetaJsonStr(_0x168efd[0x3][_0x291418(0x18e)]('meta:','')))===null||_0x4ec197===void 0x0?void 0x0:_0x4ec197[_0x291418(0x197)]};}exports[_0xca8f74(0x186)]=compilerStream;async function sendMessageFromZhipu(_0x29096e,{onProgress:_0x15943c,key:_0x2924fb,model:_0x2550cd,temperature:temperature=0.95}){const _0x38e47b=await generateToken(_0x2924fb);return new Promise((_0x58d577,_0x45f0b9)=>{const _0x4bf748=_0x32cd,_0x4e0fcb=_0x4bf748(0x1a4)+_0x2550cd+'/sse-invoke',_0x41c31f={'method':_0x4bf748(0x184),'url':_0x4e0fcb,'responseType':_0x4bf748(0x17c),'headers':{'Content-Type':_0x4bf748(0x17f),'Authorization':_0x38e47b},'data':{'prompt':_0x29096e,'temperature':temperature}};axios(_0x41c31f)[_0x4bf748(0x183)](_0x4bc0ae=>{const _0xb88e49=_0x4bf748,_0x39e10b=_0x4bc0ae[_0xb88e49(0x199)];let _0x466324,_0x348312='';_0x39e10b['on'](_0xb88e49(0x199),_0x4b7f1a=>{const _0x55d6e7=_0xb88e49,_0x5041b6=_0x4b7f1a[_0x55d6e7(0x194)]()[_0x55d6e7(0x182)]('\x0a')[_0x55d6e7(0x18f)](_0x1faf1b=>_0x1faf1b['trim']()!==''),_0x2e4ff7=compilerStream(_0x5041b6);if(!_0x2e4ff7)return;const {id:_0x52ee3f,result:_0x1b7467,is_end:_0xa0476}=_0x2e4ff7;_0x1b7467&&(_0x348312+=_0x1b7467[_0x55d6e7(0x17d)]()),_0xa0476&&(_0x2e4ff7[_0x55d6e7(0x19b)]=![],_0x466324=_0x2e4ff7,_0x466324[_0x55d6e7(0x188)]=_0x348312),_0x15943c(_0x2e4ff7);}),_0x39e10b['on'](_0xb88e49(0x18b),()=>{_0x58d577(_0x466324),_0x348312='';});})[_0x4bf748(0x19e)](_0x377fe5=>{const _0x1253b8=_0x4bf748;console[_0x1253b8(0x1a5)](_0x1253b8(0x19f),_0x377fe5);});});}function _0x32cd(_0x39c311,_0x1bfd4e){const _0x29e24e=_0x29e2();return _0x32cd=function(_0x32cda7,_0x485d2c){_0x32cda7=_0x32cda7-0x17c;let _0xe1cffa=_0x29e24e[_0x32cda7];return _0xe1cffa;},_0x32cd(_0x39c311,_0x1bfd4e);}exports['sendMessageFromZhipu']=sendMessageFromZhipu;