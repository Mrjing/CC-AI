'use strict';const _0x59b922=_0x4236;(function(_0x436bca,_0x408401){const _0x4b9335=_0x4236,_0x3ed4f5=_0x436bca();while(!![]){try{const _0xe0917d=parseInt(_0x4b9335(0x180))/0x1*(parseInt(_0x4b9335(0x171))/0x2)+parseInt(_0x4b9335(0x17c))/0x3*(-parseInt(_0x4b9335(0x168))/0x4)+-parseInt(_0x4b9335(0x15e))/0x5*(parseInt(_0x4b9335(0x176))/0x6)+-parseInt(_0x4b9335(0x16b))/0x7*(parseInt(_0x4b9335(0x15b))/0x8)+-parseInt(_0x4b9335(0x17b))/0x9+-parseInt(_0x4b9335(0x159))/0xa*(-parseInt(_0x4b9335(0x172))/0xb)+parseInt(_0x4b9335(0x155))/0xc;if(_0xe0917d===_0x408401)break;else _0x3ed4f5['push'](_0x3ed4f5['shift']());}catch(_0x333aab){_0x3ed4f5['push'](_0x3ed4f5['shift']());}}}(_0x3046,0x2e4ce));var __decorate=this&&this[_0x59b922(0x179)]||function(_0x317b8e,_0x306791,_0x146555,_0x3acade){const _0x3a4683=_0x59b922;var _0x53cb4f=arguments[_0x3a4683(0x150)],_0x5c7f99=_0x53cb4f<0x3?_0x306791:_0x3acade===null?_0x3acade=Object[_0x3a4683(0x183)](_0x306791,_0x146555):_0x3acade,_0x433e4d;if(typeof Reflect===_0x3a4683(0x15c)&&typeof Reflect[_0x3a4683(0x14e)]===_0x3a4683(0x17f))_0x5c7f99=Reflect[_0x3a4683(0x14e)](_0x317b8e,_0x306791,_0x146555,_0x3acade);else{for(var _0x9cff03=_0x317b8e['length']-0x1;_0x9cff03>=0x0;_0x9cff03--)if(_0x433e4d=_0x317b8e[_0x9cff03])_0x5c7f99=(_0x53cb4f<0x3?_0x433e4d(_0x5c7f99):_0x53cb4f>0x3?_0x433e4d(_0x306791,_0x146555,_0x5c7f99):_0x433e4d(_0x306791,_0x146555))||_0x5c7f99;}return _0x53cb4f>0x3&&_0x5c7f99&&Object[_0x3a4683(0x181)](_0x306791,_0x146555,_0x5c7f99),_0x5c7f99;},__metadata=this&&this['__metadata']||function(_0x153408,_0x3bdc62){const _0x86047e=_0x59b922;if(typeof Reflect===_0x86047e(0x15c)&&typeof Reflect['metadata']===_0x86047e(0x17f))return Reflect[_0x86047e(0x14f)](_0x153408,_0x3bdc62);},__param=this&&this['__param']||function(_0x428d20,_0x16c4c8){return function(_0x2ed534,_0x2a0169){_0x16c4c8(_0x2ed534,_0x2a0169,_0x428d20);};};Object[_0x59b922(0x181)](exports,'__esModule',{'value':!![]}),exports['TaskService']=void 0x0;function _0x3046(){const _0x328e9c=['typeorm','ModelsService','TaskService','48gpbPuO','log','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','1561IsXzEi','then','debug','design:returntype','handleCron','Cron','2GIzFWi','739255ckYpVp','GlobalConfigService','../models/models.service','会员已到期、清空所有余额并移除会员身份！','1076262cSlggv','userBalanceEntity','EVERY_HOUR','__decorate','find','2647611EoljUi','38301IbLUZK','Injectable','定时任务异常','function','276079MaPmZe','defineProperty','Repository','getOwnPropertyDescriptor','./../globalConfig/globalConfig.service','decorate','metadata','length','Logger','forEach','modelsService','CronExpression','10098216wCmQdQ','@nestjs/common','@nestjs/schedule','UserBalanceEntity','10GOIgbV','prototype','13216MZrFkN','object','getWechatAccessToken','5yRIQAP','LessThanOrEqual','checkUserMemerExpire','InjectRepository','design:paramtypes','design:type','../userBalance/userBalance.entity'];_0x3046=function(){return _0x328e9c;};return _0x3046();}function _0x4236(_0x8c4330,_0x47f7b9){const _0x304639=_0x3046();return _0x4236=function(_0x4236be,_0x4316c6){_0x4236be=_0x4236be-0x14d;let _0xfc2b47=_0x304639[_0x4236be];return _0xfc2b47;},_0x4236(_0x8c4330,_0x47f7b9);}const globalConfig_service_1=require(_0x59b922(0x14d)),common_1=require(_0x59b922(0x156)),schedule_1=require(_0x59b922(0x157)),userBalance_entity_1=require(_0x59b922(0x164)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x59b922(0x165)),models_service_1=require(_0x59b922(0x174));let TaskService=class TaskService{constructor(_0x4fdd60,_0x4e283e,_0x31f616){const _0x2001c0=_0x59b922;this[_0x2001c0(0x177)]=_0x4fdd60,this['globalConfigService']=_0x4e283e,this[_0x2001c0(0x153)]=_0x31f616;}[_0x59b922(0x16f)](){const _0x2ecc06=_0x59b922;common_1[_0x2ecc06(0x151)]['debug'](_0x2ecc06(0x16a),_0x2ecc06(0x167)),this['globalConfigService'][_0x2ecc06(0x15d)]()['catch'](_0x4bf782=>console[_0x2ecc06(0x169)](_0x2ecc06(0x17e),_0x4bf782));}async[_0x59b922(0x160)](){const _0x190f84=_0x59b922,_0x5b4dda=await this['userBalanceEntity'][_0x190f84(0x17a)]({'where':{'expirationTime':(0x0,typeorm_2[_0x190f84(0x15f)])(new Date())}});if(!_0x5b4dda||!_0x5b4dda[_0x190f84(0x150)])return;_0x5b4dda[_0x190f84(0x152)](_0x1c3d39=>{const _0x13fe51=_0x190f84;this[_0x13fe51(0x177)]['update']({'id':_0x1c3d39['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x13fe51(0x16c)](_0x546461=>{const _0x7b38fa=_0x13fe51;common_1[_0x7b38fa(0x151)][_0x7b38fa(0x16d)](_0x1c3d39['id']+_0x7b38fa(0x175),_0x7b38fa(0x167));});});}};__decorate([(0x0,schedule_1['Cron'])(schedule_1[_0x59b922(0x154)][_0x59b922(0x178)]),__metadata(_0x59b922(0x163),Function),__metadata(_0x59b922(0x162),[]),__metadata(_0x59b922(0x16e),void 0x0)],TaskService[_0x59b922(0x15a)],_0x59b922(0x16f),null),__decorate([(0x0,schedule_1[_0x59b922(0x170)])(schedule_1[_0x59b922(0x154)]['EVERY_5_MINUTES']),__metadata(_0x59b922(0x163),Function),__metadata('design:paramtypes',[]),__metadata(_0x59b922(0x16e),Promise)],TaskService[_0x59b922(0x15a)],_0x59b922(0x160),null),TaskService=__decorate([(0x0,common_1[_0x59b922(0x17d)])(),__param(0x0,(0x0,typeorm_1[_0x59b922(0x161)])(userBalance_entity_1[_0x59b922(0x158)])),__metadata(_0x59b922(0x162),[typeorm_2[_0x59b922(0x182)],globalConfig_service_1[_0x59b922(0x173)],models_service_1[_0x59b922(0x166)]])],TaskService),exports[_0x59b922(0x167)]=TaskService;