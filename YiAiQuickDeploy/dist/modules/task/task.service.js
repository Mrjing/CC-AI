'use strict';function _0x5425(){const _0xc7b625=['4732VsKiRA','16398gNKJVa','Cron','LessThanOrEqual','forEach','object','getWechatAccessToken','2800dKKwJo','6596rxxnwd','会员已到期、清空所有余额并移除会员身份！','../userBalance/userBalance.entity','@nestjs/common','prototype','metadata','__esModule','./../globalConfig/globalConfig.service','length','Injectable','defineProperty','9304pwPZUV','15diOpBf','UserBalanceEntity','CronExpression','2367462oULwYR','__metadata','modelsService','InjectRepository','debug','../models/models.service','Logger','309STSwim','91987vXYAIn','TaskService','design:paramtypes','typeorm','getOwnPropertyDescriptor','handleCron','Repository','checkUserMemerExpire','globalConfigService','update','__decorate','decorate','EVERY_HOUR','16947293BWVKkJ','@nestjs/schedule','design:type','@nestjs/typeorm','userBalanceEntity','function','then','1526496BikWkN'];_0x5425=function(){return _0xc7b625;};return _0x5425();}const _0xf46eb8=_0x1357;(function(_0x58a04e,_0x3c4c18){const _0xf60732=_0x1357,_0x487038=_0x58a04e();while(!![]){try{const _0x2ff769=parseInt(_0xf60732(0x1b4))/0x1+parseInt(_0xf60732(0x1c8))/0x2+parseInt(_0xf60732(0x1b3))/0x3*(-parseInt(_0xf60732(0x19d))/0x4)+parseInt(_0xf60732(0x1a9))/0x5*(parseInt(_0xf60732(0x1ac))/0x6)+parseInt(_0xf60732(0x195))/0x7*(parseInt(_0xf60732(0x1a8))/0x8)+parseInt(_0xf60732(0x196))/0x9*(-parseInt(_0xf60732(0x19c))/0xa)+-parseInt(_0xf60732(0x1c1))/0xb;if(_0x2ff769===_0x3c4c18)break;else _0x487038['push'](_0x487038['shift']());}catch(_0x4e0204){_0x487038['push'](_0x487038['shift']());}}}(_0x5425,0x93944));var __decorate=this&&this[_0xf46eb8(0x1be)]||function(_0x3409a0,_0x215a17,_0xac9c45,_0x3d8772){const _0x1e5101=_0xf46eb8;var _0x32a8f4=arguments['length'],_0x116265=_0x32a8f4<0x3?_0x215a17:_0x3d8772===null?_0x3d8772=Object[_0x1e5101(0x1b8)](_0x215a17,_0xac9c45):_0x3d8772,_0x21822a;if(typeof Reflect===_0x1e5101(0x19a)&&typeof Reflect[_0x1e5101(0x1bf)]===_0x1e5101(0x1c6))_0x116265=Reflect[_0x1e5101(0x1bf)](_0x3409a0,_0x215a17,_0xac9c45,_0x3d8772);else{for(var _0x573701=_0x3409a0['length']-0x1;_0x573701>=0x0;_0x573701--)if(_0x21822a=_0x3409a0[_0x573701])_0x116265=(_0x32a8f4<0x3?_0x21822a(_0x116265):_0x32a8f4>0x3?_0x21822a(_0x215a17,_0xac9c45,_0x116265):_0x21822a(_0x215a17,_0xac9c45))||_0x116265;}return _0x32a8f4>0x3&&_0x116265&&Object['defineProperty'](_0x215a17,_0xac9c45,_0x116265),_0x116265;},__metadata=this&&this[_0xf46eb8(0x1ad)]||function(_0x4085f9,_0x368174){const _0x1f31c3=_0xf46eb8;if(typeof Reflect==='object'&&typeof Reflect[_0x1f31c3(0x1a2)]===_0x1f31c3(0x1c6))return Reflect[_0x1f31c3(0x1a2)](_0x4085f9,_0x368174);},__param=this&&this['__param']||function(_0x1ec1d8,_0x45fd8d){return function(_0x2fd04e,_0x4b3e28){_0x45fd8d(_0x2fd04e,_0x4b3e28,_0x1ec1d8);};};Object[_0xf46eb8(0x1a7)](exports,_0xf46eb8(0x1a3),{'value':!![]}),exports[_0xf46eb8(0x1b5)]=void 0x0;const globalConfig_service_1=require(_0xf46eb8(0x1a4)),common_1=require(_0xf46eb8(0x1a0)),schedule_1=require(_0xf46eb8(0x1c2)),userBalance_entity_1=require(_0xf46eb8(0x19f)),typeorm_1=require(_0xf46eb8(0x1c4)),typeorm_2=require(_0xf46eb8(0x1b7)),models_service_1=require(_0xf46eb8(0x1b1));function _0x1357(_0x3390b9,_0x4fa574){const _0x54253f=_0x5425();return _0x1357=function(_0x1357ee,_0x284e12){_0x1357ee=_0x1357ee-0x195;let _0xf35101=_0x54253f[_0x1357ee];return _0xf35101;},_0x1357(_0x3390b9,_0x4fa574);}let TaskService=class TaskService{constructor(_0x5208ac,_0x4affaf,_0x35c67a){const _0x335eee=_0xf46eb8;this[_0x335eee(0x1c5)]=_0x5208ac,this['globalConfigService']=_0x4affaf,this[_0x335eee(0x1ae)]=_0x35c67a;}[_0xf46eb8(0x1b9)](){const _0x54ea4a=_0xf46eb8;common_1[_0x54ea4a(0x1b2)]['debug']('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x54ea4a(0x1b5)),this[_0x54ea4a(0x1bc)][_0x54ea4a(0x19b)]();}async['checkUserMemerExpire'](){const _0x23ba81=_0xf46eb8,_0x1c5ff6=await this[_0x23ba81(0x1c5)]['find']({'where':{'expirationTime':(0x0,typeorm_2[_0x23ba81(0x198)])(new Date())}});if(!_0x1c5ff6||!_0x1c5ff6[_0x23ba81(0x1a5)])return;_0x1c5ff6[_0x23ba81(0x199)](_0x12db06=>{const _0x2330db=_0x23ba81;this[_0x2330db(0x1c5)][_0x2330db(0x1bd)]({'id':_0x12db06['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x2330db(0x1c7)](_0x4e21d3=>{const _0x2e1ae5=_0x2330db;common_1['Logger'][_0x2e1ae5(0x1b0)](_0x12db06['id']+_0x2e1ae5(0x19e),_0x2e1ae5(0x1b5));});});}};__decorate([(0x0,schedule_1['Cron'])(schedule_1['CronExpression'][_0xf46eb8(0x1c0)]),__metadata(_0xf46eb8(0x1c3),Function),__metadata(_0xf46eb8(0x1b6),[]),__metadata('design:returntype',void 0x0)],TaskService[_0xf46eb8(0x1a1)],_0xf46eb8(0x1b9),null),__decorate([(0x0,schedule_1[_0xf46eb8(0x197)])(schedule_1[_0xf46eb8(0x1ab)]['EVERY_5_MINUTES']),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],TaskService[_0xf46eb8(0x1a1)],_0xf46eb8(0x1bb),null),TaskService=__decorate([(0x0,common_1[_0xf46eb8(0x1a6)])(),__param(0x0,(0x0,typeorm_1[_0xf46eb8(0x1af)])(userBalance_entity_1[_0xf46eb8(0x1aa)])),__metadata(_0xf46eb8(0x1b6),[typeorm_2[_0xf46eb8(0x1ba)],globalConfig_service_1['GlobalConfigService'],models_service_1['ModelsService']])],TaskService),exports[_0xf46eb8(0x1b5)]=TaskService;