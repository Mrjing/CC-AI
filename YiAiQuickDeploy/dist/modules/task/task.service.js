'use strict';const _0x12d8a0=_0x491f;function _0x491f(_0x38b4b9,_0x124fbc){const _0x5301d1=_0x5301();return _0x491f=function(_0x491fc2,_0x137896){_0x491fc2=_0x491fc2-0x164;let _0x3ac550=_0x5301d1[_0x491fc2];return _0x3ac550;},_0x491f(_0x38b4b9,_0x124fbc);}(function(_0x6abd45,_0x11ee2b){const _0x973171=_0x491f,_0x5b9094=_0x6abd45();while(!![]){try{const _0x10cba7=-parseInt(_0x973171(0x171))/0x1*(-parseInt(_0x973171(0x176))/0x2)+parseInt(_0x973171(0x175))/0x3*(parseInt(_0x973171(0x193))/0x4)+-parseInt(_0x973171(0x18a))/0x5*(parseInt(_0x973171(0x195))/0x6)+parseInt(_0x973171(0x173))/0x7+parseInt(_0x973171(0x180))/0x8*(parseInt(_0x973171(0x17a))/0x9)+parseInt(_0x973171(0x179))/0xa+-parseInt(_0x973171(0x16b))/0xb;if(_0x10cba7===_0x11ee2b)break;else _0x5b9094['push'](_0x5b9094['shift']());}catch(_0x411839){_0x5b9094['push'](_0x5b9094['shift']());}}}(_0x5301,0x9dd5a));var __decorate=this&&this[_0x12d8a0(0x197)]||function(_0x29c1b3,_0x41ed61,_0x116e36,_0x3316a2){const _0x550418=_0x12d8a0;var _0x2001bb=arguments['length'],_0x1140ff=_0x2001bb<0x3?_0x41ed61:_0x3316a2===null?_0x3316a2=Object[_0x550418(0x182)](_0x41ed61,_0x116e36):_0x3316a2,_0x536504;if(typeof Reflect==='object'&&typeof Reflect[_0x550418(0x16a)]===_0x550418(0x198))_0x1140ff=Reflect[_0x550418(0x16a)](_0x29c1b3,_0x41ed61,_0x116e36,_0x3316a2);else{for(var _0x290bf4=_0x29c1b3[_0x550418(0x189)]-0x1;_0x290bf4>=0x0;_0x290bf4--)if(_0x536504=_0x29c1b3[_0x290bf4])_0x1140ff=(_0x2001bb<0x3?_0x536504(_0x1140ff):_0x2001bb>0x3?_0x536504(_0x41ed61,_0x116e36,_0x1140ff):_0x536504(_0x41ed61,_0x116e36))||_0x1140ff;}return _0x2001bb>0x3&&_0x1140ff&&Object['defineProperty'](_0x41ed61,_0x116e36,_0x1140ff),_0x1140ff;},__metadata=this&&this[_0x12d8a0(0x186)]||function(_0x3c699c,_0x3a74a4){const _0x25d253=_0x12d8a0;if(typeof Reflect===_0x25d253(0x190)&&typeof Reflect[_0x25d253(0x16e)]==='function')return Reflect[_0x25d253(0x16e)](_0x3c699c,_0x3a74a4);},__param=this&&this[_0x12d8a0(0x181)]||function(_0x43005b,_0x214b79){return function(_0x2b2657,_0x510ab1){_0x214b79(_0x2b2657,_0x510ab1,_0x43005b);};};Object[_0x12d8a0(0x164)](exports,_0x12d8a0(0x187),{'value':!![]}),exports[_0x12d8a0(0x16f)]=void 0x0;const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require(_0x12d8a0(0x16c)),schedule_1=require(_0x12d8a0(0x166)),userBalance_entity_1=require(_0x12d8a0(0x169)),typeorm_1=require(_0x12d8a0(0x17c)),typeorm_2=require(_0x12d8a0(0x185)),models_service_1=require('../models/models.service');let TaskService=class TaskService{constructor(_0x20826f,_0x5ed0f3,_0x160f01){const _0x6a690e=_0x12d8a0;this[_0x6a690e(0x191)]=_0x20826f,this['globalConfigService']=_0x5ed0f3,this[_0x6a690e(0x165)]=_0x160f01;}[_0x12d8a0(0x174)](){const _0x27f4bb=_0x12d8a0;common_1[_0x27f4bb(0x192)]['debug'](_0x27f4bb(0x172),'TaskService'),this[_0x27f4bb(0x18d)]['getWechatAccessToken']();}async[_0x12d8a0(0x194)](){const _0x5cc0ed=_0x12d8a0,_0x205299=await this[_0x5cc0ed(0x191)][_0x5cc0ed(0x17d)]({'where':{'expirationTime':(0x0,typeorm_2[_0x5cc0ed(0x167)])(new Date())}});if(!_0x205299||!_0x205299[_0x5cc0ed(0x189)])return;_0x205299[_0x5cc0ed(0x168)](_0x35532a=>{const _0x259d6e=_0x5cc0ed;this[_0x259d6e(0x191)][_0x259d6e(0x184)]({'id':_0x35532a['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})['then'](_0x408a30=>{const _0x2b9ef9=_0x259d6e;common_1[_0x2b9ef9(0x192)][_0x2b9ef9(0x177)](_0x35532a['id']+_0x2b9ef9(0x17e),_0x2b9ef9(0x16f));});});}};function _0x5301(){const _0x105de9=['@nestjs/schedule','LessThanOrEqual','forEach','../userBalance/userBalance.entity','decorate','24249434uaTlGI','@nestjs/common','UserBalanceEntity','metadata','TaskService','design:type','5pibthZ','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','6647662hhtmoU','handleCron','1842252DLOkHv','196018AWOWpf','debug','Repository','7306830LSspJA','54hqeomV','EVERY_HOUR','@nestjs/typeorm','find','会员已到期、清空所有余额并移除会员身份！','design:returntype','193976Cnyjwn','__param','getOwnPropertyDescriptor','InjectRepository','update','typeorm','__metadata','__esModule','Cron','length','5yvQwCV','ModelsService','CronExpression','globalConfigService','prototype','design:paramtypes','object','userBalanceEntity','Logger','8yQvIVZ','checkUserMemerExpire','4158360RIvWEq','Injectable','__decorate','function','defineProperty','modelsService'];_0x5301=function(){return _0x105de9;};return _0x5301();}__decorate([(0x0,schedule_1[_0x12d8a0(0x188)])(schedule_1[_0x12d8a0(0x18c)][_0x12d8a0(0x17b)]),__metadata(_0x12d8a0(0x170),Function),__metadata(_0x12d8a0(0x18f),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x12d8a0(0x18e)],'handleCron',null),__decorate([(0x0,schedule_1['Cron'])(schedule_1['CronExpression']['EVERY_5_MINUTES']),__metadata(_0x12d8a0(0x170),Function),__metadata(_0x12d8a0(0x18f),[]),__metadata(_0x12d8a0(0x17f),Promise)],TaskService[_0x12d8a0(0x18e)],_0x12d8a0(0x194),null),TaskService=__decorate([(0x0,common_1[_0x12d8a0(0x196)])(),__param(0x0,(0x0,typeorm_1[_0x12d8a0(0x183)])(userBalance_entity_1[_0x12d8a0(0x16d)])),__metadata(_0x12d8a0(0x18f),[typeorm_2[_0x12d8a0(0x178)],globalConfig_service_1['GlobalConfigService'],models_service_1[_0x12d8a0(0x18b)]])],TaskService),exports[_0x12d8a0(0x16f)]=TaskService;