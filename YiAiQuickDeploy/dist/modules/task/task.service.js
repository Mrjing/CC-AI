'use strict';const _0x15859d=_0x3023;(function(_0x33476b,_0x581289){const _0x5caa16=_0x3023,_0x15e30e=_0x33476b();while(!![]){try{const _0x3c1e00=parseInt(_0x5caa16(0x85))/0x1*(-parseInt(_0x5caa16(0x8f))/0x2)+parseInt(_0x5caa16(0x73))/0x3+-parseInt(_0x5caa16(0x87))/0x4+parseInt(_0x5caa16(0x67))/0x5+-parseInt(_0x5caa16(0x8d))/0x6*(-parseInt(_0x5caa16(0x86))/0x7)+parseInt(_0x5caa16(0x95))/0x8*(-parseInt(_0x5caa16(0x84))/0x9)+parseInt(_0x5caa16(0x8b))/0xa;if(_0x3c1e00===_0x581289)break;else _0x15e30e['push'](_0x15e30e['shift']());}catch(_0x5b0d28){_0x15e30e['push'](_0x15e30e['shift']());}}}(_0x4631,0xd3d0d));function _0x4631(){const _0x19670b=['879656EHuAYh','modelsService','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','globalConfigService','5424840tYSDLo','forEach','metadata','Cron','EVERY_HOUR','object','userBalanceEntity','Logger','__decorate','../userBalance/userBalance.entity','@nestjs/common','getWechatAccessToken','3278316WnQQQG','checkUserMemerExpire','function','Repository','./../globalConfig/globalConfig.service','handleCron','TaskService','Injectable','InjectRepository','decorate','update','会员已到期、清空所有余额并移除会员身份！','GlobalConfigService','defineProperty','UserBalanceEntity','LessThanOrEqual','CronExpression','27Mylnjf','5SjOQSR','3607289MWXWpB','5132384xQVObW','../models/models.service','length','design:type','4903720GObhpj','design:returntype','6TWXFoO','debug','281150lJQyxe','ModelsService','design:paramtypes','find','typeorm','@nestjs/schedule'];_0x4631=function(){return _0x19670b;};return _0x4631();}var __decorate=this&&this[_0x15859d(0x6f)]||function(_0x1f4734,_0x1537ea,_0x1230ba,_0x1639c9){const _0x51a1f3=_0x15859d;var _0x234d09=arguments['length'],_0xd67ae8=_0x234d09<0x3?_0x1537ea:_0x1639c9===null?_0x1639c9=Object['getOwnPropertyDescriptor'](_0x1537ea,_0x1230ba):_0x1639c9,_0x423e99;if(typeof Reflect===_0x51a1f3(0x6c)&&typeof Reflect[_0x51a1f3(0x7c)]===_0x51a1f3(0x75))_0xd67ae8=Reflect[_0x51a1f3(0x7c)](_0x1f4734,_0x1537ea,_0x1230ba,_0x1639c9);else{for(var _0x4854ac=_0x1f4734[_0x51a1f3(0x89)]-0x1;_0x4854ac>=0x0;_0x4854ac--)if(_0x423e99=_0x1f4734[_0x4854ac])_0xd67ae8=(_0x234d09<0x3?_0x423e99(_0xd67ae8):_0x234d09>0x3?_0x423e99(_0x1537ea,_0x1230ba,_0xd67ae8):_0x423e99(_0x1537ea,_0x1230ba))||_0xd67ae8;}return _0x234d09>0x3&&_0xd67ae8&&Object[_0x51a1f3(0x80)](_0x1537ea,_0x1230ba,_0xd67ae8),_0xd67ae8;},__metadata=this&&this['__metadata']||function(_0x596776,_0x3bcbd0){const _0x569a48=_0x15859d;if(typeof Reflect===_0x569a48(0x6c)&&typeof Reflect['metadata']===_0x569a48(0x75))return Reflect[_0x569a48(0x69)](_0x596776,_0x3bcbd0);},__param=this&&this['__param']||function(_0x57fbda,_0x738222){return function(_0x2dfeee,_0x2bf897){_0x738222(_0x2dfeee,_0x2bf897,_0x57fbda);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x15859d(0x79)]=void 0x0;const globalConfig_service_1=require(_0x15859d(0x77)),common_1=require(_0x15859d(0x71)),schedule_1=require(_0x15859d(0x94)),userBalance_entity_1=require(_0x15859d(0x70)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x15859d(0x93)),models_service_1=require(_0x15859d(0x88));function _0x3023(_0x1342ac,_0x58ac1e){const _0x4631a9=_0x4631();return _0x3023=function(_0x3023da,_0x3c5111){_0x3023da=_0x3023da-0x65;let _0x218fae=_0x4631a9[_0x3023da];return _0x218fae;},_0x3023(_0x1342ac,_0x58ac1e);}let TaskService=class TaskService{constructor(_0x3909bf,_0x1bd5e1,_0x3f5638){const _0x4d61bb=_0x15859d;this[_0x4d61bb(0x6d)]=_0x3909bf,this['globalConfigService']=_0x1bd5e1,this[_0x4d61bb(0x96)]=_0x3f5638;}[_0x15859d(0x78)](){const _0x5ed9f1=_0x15859d;common_1[_0x5ed9f1(0x6e)][_0x5ed9f1(0x8e)](_0x5ed9f1(0x65),'TaskService'),this[_0x5ed9f1(0x66)][_0x5ed9f1(0x72)]();}async[_0x15859d(0x74)](){const _0x5473df=_0x15859d,_0x39d124=await this[_0x5473df(0x6d)][_0x5473df(0x92)]({'where':{'expirationTime':(0x0,typeorm_2[_0x5473df(0x82)])(new Date())}});if(!_0x39d124||!_0x39d124[_0x5473df(0x89)])return;_0x39d124[_0x5473df(0x68)](_0xe35aeb=>{const _0x30dbd6=_0x5473df;this[_0x30dbd6(0x6d)][_0x30dbd6(0x7d)]({'id':_0xe35aeb['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})['then'](_0xc86500=>{const _0x490730=_0x30dbd6;common_1[_0x490730(0x6e)][_0x490730(0x8e)](_0xe35aeb['id']+_0x490730(0x7e),_0x490730(0x79));});});}};__decorate([(0x0,schedule_1[_0x15859d(0x6a)])(schedule_1[_0x15859d(0x83)][_0x15859d(0x6b)]),__metadata(_0x15859d(0x8a),Function),__metadata(_0x15859d(0x91),[]),__metadata(_0x15859d(0x8c),void 0x0)],TaskService['prototype'],_0x15859d(0x78),null),__decorate([(0x0,schedule_1[_0x15859d(0x6a)])(schedule_1[_0x15859d(0x83)]['EVERY_5_MINUTES']),__metadata(_0x15859d(0x8a),Function),__metadata('design:paramtypes',[]),__metadata(_0x15859d(0x8c),Promise)],TaskService['prototype'],_0x15859d(0x74),null),TaskService=__decorate([(0x0,common_1[_0x15859d(0x7a)])(),__param(0x0,(0x0,typeorm_1[_0x15859d(0x7b)])(userBalance_entity_1[_0x15859d(0x81)])),__metadata('design:paramtypes',[typeorm_2[_0x15859d(0x76)],globalConfig_service_1[_0x15859d(0x7f)],models_service_1[_0x15859d(0x90)]])],TaskService),exports['TaskService']=TaskService;