'use strict';const _0x143252=_0x4568;(function(_0x10d978,_0x113293){const _0x2b3517=_0x4568,_0x109f36=_0x10d978();while(!![]){try{const _0x4947d9=-parseInt(_0x2b3517(0x187))/0x1+parseInt(_0x2b3517(0x166))/0x2+parseInt(_0x2b3517(0x183))/0x3*(parseInt(_0x2b3517(0x17a))/0x4)+-parseInt(_0x2b3517(0x177))/0x5+parseInt(_0x2b3517(0x172))/0x6+-parseInt(_0x2b3517(0x165))/0x7*(-parseInt(_0x2b3517(0x181))/0x8)+-parseInt(_0x2b3517(0x186))/0x9;if(_0x4947d9===_0x113293)break;else _0x109f36['push'](_0x109f36['shift']());}catch(_0xcd3840){_0x109f36['push'](_0x109f36['shift']());}}}(_0x10b1,0x5dd32));var __decorate=this&&this[_0x143252(0x178)]||function(_0x2e05e4,_0x1ca4ee,_0x117eee,_0x411dcd){const _0x3f8355=_0x143252;var _0x61ca11=arguments[_0x3f8355(0x179)],_0x2bc2e7=_0x61ca11<0x3?_0x1ca4ee:_0x411dcd===null?_0x411dcd=Object[_0x3f8355(0x164)](_0x1ca4ee,_0x117eee):_0x411dcd,_0x11a6ea;if(typeof Reflect==='object'&&typeof Reflect[_0x3f8355(0x180)]===_0x3f8355(0x16e))_0x2bc2e7=Reflect['decorate'](_0x2e05e4,_0x1ca4ee,_0x117eee,_0x411dcd);else{for(var _0x44f031=_0x2e05e4[_0x3f8355(0x179)]-0x1;_0x44f031>=0x0;_0x44f031--)if(_0x11a6ea=_0x2e05e4[_0x44f031])_0x2bc2e7=(_0x61ca11<0x3?_0x11a6ea(_0x2bc2e7):_0x61ca11>0x3?_0x11a6ea(_0x1ca4ee,_0x117eee,_0x2bc2e7):_0x11a6ea(_0x1ca4ee,_0x117eee))||_0x2bc2e7;}return _0x61ca11>0x3&&_0x2bc2e7&&Object[_0x3f8355(0x174)](_0x1ca4ee,_0x117eee,_0x2bc2e7),_0x2bc2e7;},__metadata=this&&this['__metadata']||function(_0x4831b0,_0x2f7010){const _0x57fa71=_0x143252;if(typeof Reflect===_0x57fa71(0x169)&&typeof Reflect['metadata']==='function')return Reflect[_0x57fa71(0x171)](_0x4831b0,_0x2f7010);},__param=this&&this[_0x143252(0x188)]||function(_0x318cb6,_0x149d6a){return function(_0x263799,_0x466301){_0x149d6a(_0x263799,_0x466301,_0x318cb6);};};Object['defineProperty'](exports,_0x143252(0x173),{'value':!![]}),exports[_0x143252(0x17b)]=void 0x0;function _0x4568(_0x2eca4e,_0x490184){const _0x10b1f1=_0x10b1();return _0x4568=function(_0x456852,_0x3d6869){_0x456852=_0x456852-0x163;let _0x3bb0bb=_0x10b1f1[_0x456852];return _0x3bb0bb;},_0x4568(_0x2eca4e,_0x490184);}function _0x10b1(){const _0xd9ff3c=['length','4796cXChAo','TaskService','Repository','EVERY_5_MINUTES','design:returntype','forEach','decorate','13160NJDjsr','getWechatAccessToken','1317eXCYIm','./../globalConfig/globalConfig.service','then','9781200KtSdEh','126257PUgQlD','__param','InjectRepository','debug','prototype','../userBalance/userBalance.entity','design:paramtypes','@nestjs/schedule','@nestjs/typeorm','userBalanceEntity','handleCron','Cron','LessThanOrEqual','Logger','design:type','getOwnPropertyDescriptor','1666SfphZo','1348368UShgrW','modelsService','GlobalConfigService','object','@nestjs/common','checkUserMemerExpire','globalConfigService','update','function','会员已到期、清空所有余额并移除会员身份！','Injectable','metadata','237348FiUNCF','__esModule','defineProperty','typeorm','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','171250PVPpmb','__decorate'];_0x10b1=function(){return _0xd9ff3c;};return _0x10b1();}const globalConfig_service_1=require(_0x143252(0x184)),common_1=require(_0x143252(0x16a)),schedule_1=require(_0x143252(0x18e)),userBalance_entity_1=require(_0x143252(0x18c)),typeorm_1=require(_0x143252(0x18f)),typeorm_2=require(_0x143252(0x175)),models_service_1=require('../models/models.service');let TaskService=class TaskService{constructor(_0x1d4dd6,_0x340a40,_0x22a25f){const _0x218269=_0x143252;this[_0x218269(0x190)]=_0x1d4dd6,this['globalConfigService']=_0x340a40,this[_0x218269(0x167)]=_0x22a25f;}[_0x143252(0x191)](){const _0x1ba748=_0x143252;common_1[_0x1ba748(0x194)][_0x1ba748(0x18a)](_0x1ba748(0x176),'TaskService'),this[_0x1ba748(0x16c)][_0x1ba748(0x182)]();}async[_0x143252(0x16b)](){const _0x5964bd=_0x143252,_0x2bc3ba=await this[_0x5964bd(0x190)]['find']({'where':{'expirationTime':(0x0,typeorm_2[_0x5964bd(0x193)])(new Date())}});if(!_0x2bc3ba||!_0x2bc3ba[_0x5964bd(0x179)])return;_0x2bc3ba[_0x5964bd(0x17f)](_0x549ba6=>{const _0x22a417=_0x5964bd;this['userBalanceEntity'][_0x22a417(0x16d)]({'id':_0x549ba6['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x22a417(0x185)](_0x1ff40c=>{const _0x53723f=_0x22a417;common_1[_0x53723f(0x194)]['debug'](_0x549ba6['id']+_0x53723f(0x16f),_0x53723f(0x17b));});});}};__decorate([(0x0,schedule_1[_0x143252(0x192)])(schedule_1['CronExpression']['EVERY_HOUR']),__metadata(_0x143252(0x163),Function),__metadata('design:paramtypes',[]),__metadata(_0x143252(0x17e),void 0x0)],TaskService[_0x143252(0x18b)],_0x143252(0x191),null),__decorate([(0x0,schedule_1['Cron'])(schedule_1['CronExpression'][_0x143252(0x17d)]),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x143252(0x17e),Promise)],TaskService['prototype'],_0x143252(0x16b),null),TaskService=__decorate([(0x0,common_1[_0x143252(0x170)])(),__param(0x0,(0x0,typeorm_1[_0x143252(0x189)])(userBalance_entity_1['UserBalanceEntity'])),__metadata(_0x143252(0x18d),[typeorm_2[_0x143252(0x17c)],globalConfig_service_1[_0x143252(0x168)],models_service_1['ModelsService']])],TaskService),exports[_0x143252(0x17b)]=TaskService;