'use strict';const _0x1f9e0c=_0x4b1e;function _0x4b1e(_0x5cca9d,_0x3303e6){const _0x214f3d=_0x214f();return _0x4b1e=function(_0x4b1eee,_0x4f7da7){_0x4b1eee=_0x4b1eee-0xed;let _0x34a102=_0x214f3d[_0x4b1eee];return _0x34a102;},_0x4b1e(_0x5cca9d,_0x3303e6);}(function(_0x3c1cf0,_0x344f4f){const _0xd9b6ad=_0x4b1e,_0xffe7a6=_0x3c1cf0();while(!![]){try{const _0x6cf643=parseInt(_0xd9b6ad(0x134))/0x1*(-parseInt(_0xd9b6ad(0x1b3))/0x2)+-parseInt(_0xd9b6ad(0x112))/0x3*(-parseInt(_0xd9b6ad(0x17a))/0x4)+-parseInt(_0xd9b6ad(0x17f))/0x5*(-parseInt(_0xd9b6ad(0x16c))/0x6)+-parseInt(_0xd9b6ad(0x1c0))/0x7+parseInt(_0xd9b6ad(0x1ad))/0x8+parseInt(_0xd9b6ad(0x11e))/0x9*(-parseInt(_0xd9b6ad(0x14b))/0xa)+-parseInt(_0xd9b6ad(0x11a))/0xb*(-parseInt(_0xd9b6ad(0x182))/0xc);if(_0x6cf643===_0x344f4f)break;else _0xffe7a6['push'](_0xffe7a6['shift']());}catch(_0x195fb4){_0xffe7a6['push'](_0xffe7a6['shift']());}}}(_0x214f,0xddc2e));var __decorate=this&&this[_0x1f9e0c(0x175)]||function(_0xe28045,_0x5aa352,_0x170348,_0xf94499){const _0x4b8e27=_0x1f9e0c;var _0x56c8a2=arguments[_0x4b8e27(0x10c)],_0x4226e2=_0x56c8a2<0x3?_0x5aa352:_0xf94499===null?_0xf94499=Object['getOwnPropertyDescriptor'](_0x5aa352,_0x170348):_0xf94499,_0x2e507a;if(typeof Reflect===_0x4b8e27(0x101)&&typeof Reflect[_0x4b8e27(0x15f)]===_0x4b8e27(0x108))_0x4226e2=Reflect['decorate'](_0xe28045,_0x5aa352,_0x170348,_0xf94499);else{for(var _0x1635f9=_0xe28045[_0x4b8e27(0x10c)]-0x1;_0x1635f9>=0x0;_0x1635f9--)if(_0x2e507a=_0xe28045[_0x1635f9])_0x4226e2=(_0x56c8a2<0x3?_0x2e507a(_0x4226e2):_0x56c8a2>0x3?_0x2e507a(_0x5aa352,_0x170348,_0x4226e2):_0x2e507a(_0x5aa352,_0x170348))||_0x4226e2;}return _0x56c8a2>0x3&&_0x4226e2&&Object[_0x4b8e27(0x124)](_0x5aa352,_0x170348,_0x4226e2),_0x4226e2;},__metadata=this&&this[_0x1f9e0c(0x118)]||function(_0x29da7b,_0x4c2acc){const _0x585d1a=_0x1f9e0c;if(typeof Reflect===_0x585d1a(0x101)&&typeof Reflect[_0x585d1a(0x188)]===_0x585d1a(0x108))return Reflect['metadata'](_0x29da7b,_0x4c2acc);},__param=this&&this['__param']||function(_0xf7c71d,_0x1e6401){return function(_0x3088f5,_0x267d7b){_0x1e6401(_0x3088f5,_0x267d7b,_0xf7c71d);};};function _0x214f(){const _0x5c219b=['configs','getNamespace','15134830qWrips','openaiBaseUrl','aliPhoneTemplateCode','pay','initBaiduSensitive','BAD_REQUEST','qqNumber','findOne','payHupiStatus','&secret=','wechatOfficialAppSecret','payWechatStatus','filingNumber','ConfigEntity','hideString','save','wechat\x20refresh\x20access_token\x20\x20==>\x20','隐私内容、非超级管理员无权查看','buyCramiAddress','Repository','decorate','payEpayApiPayUrl','chatGptKey','wechatJsapiTicket','setConfig','wechat','NINEAI','InjectRepository','Logger','initGetAllConfig','queryConfig','registerSendModel4Count','HttpException','564VDcxrV','salesBaseRatio','wechatAccessToken','ali','感谢您使用NineAi、祝您使用愉快~','百度敏感词初始化失败，如果需要敏感检测、请前往后台系统配置!','nineai','log','includes','__decorate','mjProxyImgUrl','package.json','qcloudSecretKey','firstRegisterSendStatus','1516PmUzgy','firstRegisterSendRank','../../common/utils','typeorm','signInMjDrawToken','95320YUjrBR','payEpayChannel','data','684YGRqFI','nineaiBuiltInSensitiveStatus','aliPhoneSignName','configEntity','error_description','Injectable','metadata','epay','appMenuHeaderTips','reduce','qcloudSMSSDKAppId','errMsg','GlobalConfigService','assign','baiduTextStatus','payWeChatPrivateKey','ChatLogEntity','phoneLoginStatus','qcloudPhoneRegisterStatus','clientHomePath','aliPhoneAccessKeyId','salesSeniorRatio','baidu','firstRregisterSendModel4Count','appMenuHeaderBgUrl','json','tencent','invitedGuestSendModel3Count','&grant_type=client_credentials','请配置正确的秘钥、当前秘钥检测不通过！','error:\x20','find','utf-8','手机验证码功能暂未开放!','qcloudPhoneLoginStatus','aliPhoneAccessKeySecret','queryNotice','cos','fetchBaseAccessToken','payWeChatPublicKey','../chatLog/chatLog.entity','百度敏感词配置检测失败，您的参数可能配置的不正确!','every','9562688KSJXGj','phoneRegisterStatus','请填写您的授权码','./config.entity','payEpayStatus','queryFrontConfig','66146ymVCry','baiduTextSecretKey','setGptKeys','Key','configVal','MjdrawCount','https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=','default','firstRregisterSendModel3Count','qcloudSMSTemplateId','mjProxy','parse','post','10615360QDMTnp','mpay','filter','globalConfigs','application/json','registerSendDrawMjCount','robotAvatar','Like','readFileSync','inviteGiveSendModel4Count','configKey','modelsService','inviteGiveSendModel3Count','axios','payMpayChannel','copyrightTitle','getNineAiToken','操作完成！','mjHideNotBlock','queryPayType','getSignatureGiftConfig','baiduTextAccessToken','response','ISDEV','nineaiBuiltInSensitiveApiBase','get','getCopyright','object','缺失ip信息','version','hupi','OfficialService','payMpayStatus','invitedGuestSendModel4Count','function','forEach','isAutoOpenNotice','registerBaseUrl','length','getConfigs','queryAllConfig','update','debug','noticeInfo','6081jWXUIK','TRUE','qcloudSecretId','signInModel3Count','clientLogoPath','https://api.jiangly.com/api/permission/auth','__metadata','nineaiBuiltInSensitiveAuthKey','245883edIDHi','gpt','获取微信access_token失败、错误信息：','emailRegisterStatus','9iCLIGH','nineAiToken','signInModel4Count','\x20current\x20use\x20version\x20in\x20------>:\x20','https://aip.baidubce.com/oauth/2.0/token?client_id=','noticeTitle','defineProperty','delete','chatGptKey:','getWechatAccessToken','wechatSilentLoginStatus','mindDefaultData','firstRregisterSendDrawMjCount','&type=jsapi','entries','wechatOfficialAppId','queryGptKeys','baiduTextApiKey','signInStatus','mjHideWorkIn','&client_secret=','emailLoginStatus','33JBGdaC','getQcloudPhoneVerifyConfig','registerSendStatus','createOrUpdate','HttpStatus','super','map','access_token','Status','baiduCode','__esModule','isUseWxLogin','error','还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！','env','getAuthInfo','user','inviteGiveSendDrawMjCount','getSensitiveConfig','支付功能暂未开放!','siteName'];_0x214f=function(){return _0x5c219b;};return _0x214f();}Object[_0x1f9e0c(0x124)](exports,_0x1f9e0c(0x13e),{'value':!![]}),exports[_0x1f9e0c(0x18e)]=void 0x0;const models_service_1=require('../models/models.service'),chatLog_entity_1=require(_0x1f9e0c(0x1aa)),common_1=require('@nestjs/common'),config_entity_1=require(_0x1f9e0c(0x1b0)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x1f9e0c(0x17d)),utils_1=require(_0x1f9e0c(0x17c)),axios_1=require(_0x1f9e0c(0xf3)),fs=require('fs'),packageJsonContent=fs[_0x1f9e0c(0xee)](_0x1f9e0c(0x177),_0x1f9e0c(0x1a2)),packageJson=JSON[_0x1f9e0c(0x1be)](packageJsonContent),version=packageJson[_0x1f9e0c(0x103)];console[_0x1f9e0c(0x173)](_0x1f9e0c(0x121),version);let GlobalConfigService=class GlobalConfigService{constructor(_0x11b9e9,_0x1c7149,_0x1e0d6d){const _0x3920fb=_0x1f9e0c;this[_0x3920fb(0x185)]=_0x11b9e9,this['chatLogEntity']=_0x1c7149,this[_0x3920fb(0xf1)]=_0x1e0d6d,this[_0x3920fb(0x1c3)]={},this[_0x3920fb(0x11f)]=!![];}async['onModuleInit'](){const _0xecfac1=_0x1f9e0c;await this[_0xecfac1(0x168)]();}async[_0x1f9e0c(0x10d)](_0x42f265){const _0x14d05d=_0x1f9e0c;if(_0x42f265['length']===0x0)return;if(_0x42f265[_0x14d05d(0x174)]('wechatAccessToken')&&_0x42f265[_0x14d05d(0x10c)]===0x1)return this[_0x14d05d(0x16e)];if(_0x42f265[_0x14d05d(0x174)](_0x14d05d(0x162))&&_0x42f265['length']===0x1)return this[_0x14d05d(0x162)];if(_0x42f265[_0x14d05d(0x10c)]===0x1)return this['globalConfigs'][_0x42f265[0x0]];else{const _0x3dc482={};return _0x42f265[_0x14d05d(0x109)](_0x229e35=>_0x3dc482[_0x229e35]=this[_0x14d05d(0x1c3)][_0x229e35]),_0x3dc482;}}async[_0x1f9e0c(0x168)](){const _0x4e0a3f=_0x1f9e0c,_0x378c9b=await this[_0x4e0a3f(0x185)][_0x4e0a3f(0x1a1)]();this[_0x4e0a3f(0x1c3)]=_0x378c9b[_0x4e0a3f(0x18b)]((_0x553860,_0x42df61)=>{const _0x1cd7c4=_0x4e0a3f;return _0x553860[_0x42df61[_0x1cd7c4(0xf0)]]=_0x42df61['configVal'],_0x553860;},{}),this['initBaiduSensitive']();}async[_0x1f9e0c(0x14f)](_0x73d05c=!![]){const _0x2ca9bc=_0x1f9e0c,{baiduTextApiKey:_0x2282f5,baiduTextSecretKey:_0x50b633}=await this[_0x2ca9bc(0x10d)](['baiduTextApiKey',_0x2ca9bc(0x1b4)]);if(!_0x2282f5||!_0x50b633){common_1['Logger'][_0x2ca9bc(0x140)](_0x2ca9bc(0x171),_0x2ca9bc(0x18e));return;}const _0x17ead7={'Content-Type':_0x2ca9bc(0x1c4),'Accept':_0x2ca9bc(0x1c4)},_0x314b56=_0x2ca9bc(0x122)+_0x2282f5+_0x2ca9bc(0x132)+_0x50b633+_0x2ca9bc(0x19e);try{const _0xa35b15=await axios_1['default'][_0x2ca9bc(0x1bf)](_0x314b56,{'headers':_0x17ead7});this['globalConfigs'][_0x2ca9bc(0xfb)]=_0xa35b15[_0x2ca9bc(0x181)][_0x2ca9bc(0x13b)];}catch(_0x5587d5){if(_0x73d05c)common_1[_0x2ca9bc(0x167)][_0x2ca9bc(0x140)](_0x2ca9bc(0x1ab),_0x2ca9bc(0x18e));else throw new common_1[(_0x2ca9bc(0x16b))](_0x5587d5[_0x2ca9bc(0xfc)]['data'][_0x2ca9bc(0x186)],common_1[_0x2ca9bc(0x138)][_0x2ca9bc(0x150)]);}}async[_0x1f9e0c(0x127)](_0x14717e=![]){const _0x175efd=_0x1f9e0c,{wechatOfficialAppId:_0x10ca15,wechatOfficialAppSecret:_0x5b4d4d}=await this[_0x175efd(0x10d)]([_0x175efd(0x12d),_0x175efd(0x155)]);if(!_0x10ca15||!_0x5b4d4d)return common_1[_0x175efd(0x167)][_0x175efd(0x140)](_0x175efd(0x141),_0x175efd(0x105));this[_0x175efd(0x16e)]=await this['fetchBaseAccessToken'](_0x10ca15,_0x5b4d4d,_0x14717e),this[_0x175efd(0x162)]=await this['fetchJsapiTicket'](this[_0x175efd(0x16e)]),common_1[_0x175efd(0x167)][_0x175efd(0x173)](_0x175efd(0x15b)+this[_0x175efd(0x16e)],_0x175efd(0x105));}async[_0x1f9e0c(0x1a8)](_0x1b2ccd,_0x498838,_0x2edd17=![]){const _0x53c190=_0x1f9e0c;if(process[_0x53c190(0x142)][_0x53c190(0xfd)]===_0x53c190(0x113)){this[_0x53c190(0x16e)]='';return;}const {data:{errmsg:_0x4ef742,access_token:_0x1c7aa9}}=await axios_1[_0x53c190(0x1ba)][_0x53c190(0xff)]('https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+_0x1b2ccd+_0x53c190(0x154)+_0x498838);if(_0x4ef742){console[_0x53c190(0x173)](_0x53c190(0x18d),_0x4ef742);if(_0x2edd17)common_1[_0x53c190(0x167)][_0x53c190(0x140)](_0x53c190(0x11c)+_0x4ef742,_0x53c190(0x105));else throw new common_1[(_0x53c190(0x16b))](_0x53c190(0x19f),common_1[_0x53c190(0x138)][_0x53c190(0x150)]);return'';}return _0x1c7aa9;}async['fetchJsapiTicket'](_0x2e65e5){const _0x447a3f=_0x1f9e0c;var _0x1fb161;if(process[_0x447a3f(0x142)]['ISDEV']===_0x447a3f(0x113)){this[_0x447a3f(0x162)]='';return;}const _0x4d4a81=await axios_1[_0x447a3f(0x1ba)][_0x447a3f(0xff)](_0x447a3f(0x1b9)+_0x2e65e5+_0x447a3f(0x12b));return(_0x1fb161=_0x4d4a81===null||_0x4d4a81===void 0x0?void 0x0:_0x4d4a81[_0x447a3f(0x181)])===null||_0x1fb161===void 0x0?void 0x0:_0x1fb161['ticket'];}async[_0x1f9e0c(0x10e)](_0x50fe59){const _0x28a8ca=_0x1f9e0c,{role:_0x24d7d5}=_0x50fe59[_0x28a8ca(0x144)];return this[_0x28a8ca(0x1c3)];}async[_0x1f9e0c(0x1b2)](_0x5e2a8d,_0x1e4d04){const _0x6290bf=_0x1f9e0c,_0x47c242=['vxNumber',_0x6290bf(0x136),'registerSendModel3Count',_0x6290bf(0x16a),_0x6290bf(0x1c5),_0x6290bf(0x179),_0x6290bf(0x17b),_0x6290bf(0x1bb),_0x6290bf(0x199),_0x6290bf(0x12a),'inviteSendStatus',_0x6290bf(0xf2),_0x6290bf(0xef),_0x6290bf(0x145),_0x6290bf(0x19d),_0x6290bf(0x107),'invitedGuestSendDrawMjCount',_0x6290bf(0x195),_0x6290bf(0x116),'clientFavoIconPath',_0x6290bf(0x13f),_0x6290bf(0x148),_0x6290bf(0x1c6),'siteRobotName',_0x6290bf(0x15d),_0x6290bf(0x129),_0x6290bf(0x13d),_0x6290bf(0x180),_0x6290bf(0xf4),_0x6290bf(0x160),'payEpayStatus',_0x6290bf(0x153),_0x6290bf(0x156),_0x6290bf(0x106),_0x6290bf(0x10a),'isShowAppCatIcon',_0x6290bf(0x16d),_0x6290bf(0x197),'salesAllowDrawMoney','companyName',_0x6290bf(0x157),_0x6290bf(0x1ae),_0x6290bf(0x194),_0x6290bf(0x11d),_0x6290bf(0x133),_0x6290bf(0x193),_0x6290bf(0x1a4),'wechatRegisterStatus',_0x6290bf(0x128),_0x6290bf(0x130),_0x6290bf(0x115),_0x6290bf(0x120),'signInMjDrawToken',_0x6290bf(0x18a),_0x6290bf(0x19a),'mjUseBaiduFy',_0x6290bf(0xf8),_0x6290bf(0x131),'isVerifyEmail'],_0xf65b4d=await this[_0x6290bf(0x185)][_0x6290bf(0x1a1)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x47c242)}}),{domain:_0xc82a17}=_0x5e2a8d,_0x20c8e4=this[_0x6290bf(0x1c3)]['domain'];_0x20c8e4!==_0xc82a17&&(this[_0x6290bf(0x137)]({'configKey':'domain','configVal':_0xc82a17,'status':0x1}),await this[_0x6290bf(0x168)]());const _0x3398be=_0xf65b4d['reduce']((_0x22345a,_0x4ea853)=>{const _0x294402=_0x6290bf;return _0x22345a[_0x4ea853[_0x294402(0xf0)]]=_0x4ea853[_0x294402(0x1b7)],_0x22345a;},{}),{wechatOfficialAppId:_0x11c966,wechatOfficialAppSecret:_0x5c52ee}=await this[_0x6290bf(0x10d)]([_0x6290bf(0x12d),_0x6290bf(0x155)]),_0x1be695=!!(_0x11c966&&_0x5c52ee);return Object[_0x6290bf(0x18f)](Object[_0x6290bf(0x18f)]({},_0x3398be),{'isUseWxLogin':_0x1be695});}async[_0x1f9e0c(0x12e)](_0x364b2e){const _0x4924d0=_0x1f9e0c,{role:_0x2b29a6}=_0x364b2e['user'],_0x204151=await this[_0x4924d0(0x185)][_0x4924d0(0x1a1)]({'where':{'configKey':(0x0,typeorm_2[_0x4924d0(0xed)])('%'+_0x4924d0(0x161)+'%')}});if(_0x2b29a6===_0x4924d0(0x139))return _0x204151;return _0x204151['map'](_0x697b6b=>{const _0x40d9f3=_0x4924d0;return _0x697b6b[_0x40d9f3(0x1b7)]=(0x0,utils_1['hideString'])(_0x697b6b[_0x40d9f3(0x1b7)]),_0x697b6b;});}async[_0x1f9e0c(0x1b5)](_0x154bd2){const _0x4c8b19=_0x1f9e0c,_0x251c89=_0x154bd2[_0x4c8b19(0x149)][_0x4c8b19(0x1c2)](_0x47c359=>_0x47c359[_0x4c8b19(0x1b7)]),_0x1f5097=_0x251c89['map'](_0x83b47e=>_0x83b47e[_0x4c8b19(0xf0)]);for(const [_0x427b0f,_0x696201]of _0x251c89[_0x4c8b19(0x12c)]()){const {configKey:_0x1da03f,configVal:_0x10a33e,status:_0x47ae9e}=_0x696201;await this[_0x4c8b19(0x137)]({'configKey':_0x4c8b19(0x126)+(_0x427b0f+0x1),'configVal':_0x10a33e,'status':_0x47ae9e});}const _0xc7bacd=await this[_0x4c8b19(0x185)]['find']({'where':{'configKey':(0x0,typeorm_2[_0x4c8b19(0xed)])('%'+_0x4c8b19(0x161)+'%')}}),_0x202107=_0xc7bacd[_0x4c8b19(0x13a)](_0x33690c=>_0x33690c[_0x4c8b19(0xf0)]);if(_0x202107[_0x4c8b19(0x10c)]>_0x1f5097['length']){const _0x4504a6=(0x0,utils_1['getDiffArray'])(_0x202107[_0x4c8b19(0x10c)],_0x1f5097[_0x4c8b19(0x10c)],'chatGptKey:');for(const _0x3b0e1a of _0x4504a6){await this[_0x4c8b19(0x185)][_0x4c8b19(0x125)]({'configKey':_0x3b0e1a});}}return await this[_0x4c8b19(0x168)](),_0x4c8b19(0xf7);}async[_0x1f9e0c(0x169)](_0xcc002b,_0x2aaf23){const _0x2ffccd=_0x1f9e0c,{role:_0x50c4c3}=_0x2aaf23[_0x2ffccd(0x144)],{keys:_0x2ffa58}=_0xcc002b,_0x2a4ad6=await this[_0x2ffccd(0x185)][_0x2ffccd(0x1a1)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x2ffa58)}});return _0x50c4c3!==_0x2ffccd(0x139)&&_0x2a4ad6[_0x2ffccd(0x109)](_0x145430=>{const _0x25e47c=_0x2ffccd;if(_0x145430[_0x25e47c(0xf0)][_0x25e47c(0x174)]('mj')||_0x145430[_0x25e47c(0xf0)]['includes'](_0x25e47c(0x1b6))||_0x145430[_0x25e47c(0xf0)][_0x25e47c(0x174)](_0x25e47c(0x11b))||_0x145430[_0x25e47c(0xf0)]['includes'](_0x25e47c(0x1a7))||_0x145430['configKey'][_0x25e47c(0x174)](_0x25e47c(0x198))||_0x145430['configKey']['includes'](_0x25e47c(0x16f))||_0x145430['configKey'][_0x25e47c(0x174)](_0x25e47c(0x19c))||_0x145430['configKey'][_0x25e47c(0x174)](_0x25e47c(0x14e))||_0x145430[_0x25e47c(0xf0)][_0x25e47c(0x174)]('wechat')||_0x145430[_0x25e47c(0xf0)][_0x25e47c(0x174)](_0x25e47c(0x176))||_0x145430[_0x25e47c(0xf0)]===_0x25e47c(0x14c)){const _0x3d77ff=[_0x25e47c(0x1a9),_0x25e47c(0x191)];if(_0x3d77ff[_0x25e47c(0x174)](_0x145430[_0x25e47c(0xf0)]))return _0x145430[_0x25e47c(0x1b7)]=(0x0,utils_1[_0x25e47c(0x159)])(_0x145430[_0x25e47c(0x1b7)],_0x25e47c(0x15c));const _0x14a53d=[_0x25e47c(0x1b1),_0x25e47c(0x153),_0x25e47c(0x1bd)];!_0x14a53d[_0x25e47c(0x174)](_0x145430['configKey'])&&!_0x145430[_0x25e47c(0xf0)][_0x25e47c(0x174)](_0x25e47c(0x13c))&&(_0x145430[_0x25e47c(0x1b7)]=(0x0,utils_1['hideString'])(_0x145430[_0x25e47c(0x1b7)]));}}),_0x2a4ad6['reduce']((_0x780a19,_0x1d03c5)=>{const _0x4543b6=_0x2ffccd;return _0x780a19[_0x1d03c5[_0x4543b6(0xf0)]]=_0x1d03c5[_0x4543b6(0x1b7)],_0x780a19;},{});}[_0x1f9e0c(0xf6)](){const _0x4eb3a2=_0x1f9e0c,_0x266714=this[_0x4eb3a2(0x1c3)][_0x4eb3a2(0x1b8)],_0x1c5965=this[_0x4eb3a2(0x11f)];return!_0x1c5965||Number(_0x266714)===0x1;}async[_0x1f9e0c(0x163)](_0x2c48aa){const _0x257e40=_0x1f9e0c;try{const {settings:_0x41a8e1}=_0x2c48aa;for(const _0x4f69e2 of _0x41a8e1){await this[_0x257e40(0x137)](_0x4f69e2);}await this[_0x257e40(0x168)]();const _0x22e388=_0x41a8e1[_0x257e40(0x13a)](_0x59256a=>_0x59256a[_0x257e40(0xf0)]);return(_0x22e388[_0x257e40(0x174)](_0x257e40(0x12f))||_0x22e388[_0x257e40(0x174)](_0x257e40(0x1b4)))&&await this[_0x257e40(0x14f)](![]),(_0x22e388[_0x257e40(0x174)](_0x257e40(0x12d))||_0x22e388[_0x257e40(0x174)](_0x257e40(0x155)))&&await this['getWechatAccessToken'](),'设置完成！';}catch(_0x4b0faa){console[_0x257e40(0x173)](_0x257e40(0x1a0),_0x4b0faa);}}async[_0x1f9e0c(0x137)](_0x451d37){const _0x4218e8=_0x1f9e0c;try{const {configKey:_0x36ee25,configVal:_0x346b22,status:status=0x1}=_0x451d37,_0x71237f=await this[_0x4218e8(0x185)][_0x4218e8(0x152)]({'where':{'configKey':_0x36ee25}});if(_0x71237f){const _0x3803fe=await this[_0x4218e8(0x185)][_0x4218e8(0x10f)]({'configKey':_0x36ee25},{'configVal':_0x346b22,'status':status});}else{const _0x40a893=await this[_0x4218e8(0x185)][_0x4218e8(0x15a)]({'configKey':_0x36ee25,'configVal':_0x346b22,'status':status});}}catch(_0x90d24d){console[_0x4218e8(0x173)](_0x4218e8(0x1a0),_0x90d24d);throw new common_1['HttpException']('设置配置信息错误！',common_1[_0x4218e8(0x138)][_0x4218e8(0x150)]);}}async[_0x1f9e0c(0x1a6)](){const _0x52633c=_0x1f9e0c;return await this[_0x52633c(0x10d)]([_0x52633c(0x111),_0x52633c(0x123)]);}async[_0x1f9e0c(0x100)](){const _0x23270f=_0x1f9e0c;return await this[_0x23270f(0x10d)](['copyrightUrl',_0x23270f(0xf5)]);}async[_0x1f9e0c(0xf9)](){const _0x284edd=_0x1f9e0c,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this[_0x284edd(0x10d)]([_0x284edd(0x153),_0x284edd(0x1b1),_0x284edd(0x106),_0x284edd(0x156)]);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus][_0x284edd(0x1ac)](_0xe5caa9=>_0xe5caa9===0x0))throw new common_1[(_0x284edd(0x16b))](_0x284edd(0x147),common_1['HttpStatus'][_0x284edd(0x150)]);if(Number(payWechatStatus)===0x1)return _0x284edd(0x164);if(Number(payEpayStatus)===0x1)return _0x284edd(0x189);if(Number(payMpayStatus)===0x1)return _0x284edd(0x1c1);if(Number(payHupiStatus)===0x1)return _0x284edd(0x104);}async[_0x1f9e0c(0x143)](){const _0x2a8850=_0x1f9e0c,{siteName:_0x38f3ec,qqNumber:_0x210e42,vxNumber:_0x1ea115,registerBaseUrl:_0x278494,domain:_0x401f10}=await this[_0x2a8850(0x10d)](['siteName',_0x2a8850(0x151),'vxNumber',_0x2a8850(0x10b),'domain']);return{'siteName':_0x38f3ec,'qqNumber':_0x210e42,'vxNumber':_0x1ea115,'registerBaseUrl':_0x278494,'domain':_0x401f10};}async['getPhoneVerifyConfig'](){const _0x3cff16=_0x1f9e0c,{phoneRegisterStatus:_0x223794,aliPhoneAccessKeyId:_0xa42605,aliPhoneAccessKeySecret:_0x4c50b3,aliPhoneSignName:_0x4e2f9b,aliPhoneTemplateCode:_0x2f566d}=await this[_0x3cff16(0x10d)]([_0x3cff16(0x1ae),_0x3cff16(0x196),_0x3cff16(0x1a5),_0x3cff16(0x184),_0x3cff16(0x14d)]);if(Number(_0x223794)!==0x1)throw new common_1[(_0x3cff16(0x16b))](_0x3cff16(0x1a3),common_1['HttpStatus'][_0x3cff16(0x150)]);return{'accessKeyId':_0xa42605,'accessKeySecret':_0x4c50b3,'SignName':_0x4e2f9b,'TemplateCode':_0x2f566d};}async[_0x1f9e0c(0x135)](){const _0x55a246=_0x1f9e0c,{qcloudPhoneRegisterStatus:_0x544a23,qcloudSecretId:_0x417ec8,qcloudSecretKey:_0x57b611,qcloudPhoneSignName:_0x207bf4,qcloudSMSTemplateId:_0x193fd0,qcloudSMSSDKAppId:_0x24a54c}=await this['getConfigs']([_0x55a246(0x194),_0x55a246(0x114),_0x55a246(0x178),'qcloudPhoneSignName',_0x55a246(0x1bc),_0x55a246(0x18c)]);if(Number(_0x544a23)!==0x1)throw new common_1[(_0x55a246(0x16b))](_0x55a246(0x1a3),common_1[_0x55a246(0x138)][_0x55a246(0x150)]);return{'secretId':_0x417ec8,'secretKey':_0x57b611,'signName':_0x207bf4,'templateId':_0x193fd0,'sdkAppId':_0x24a54c};}[_0x1f9e0c(0x14a)](){const _0xf3f4f1=_0x1f9e0c;return process[_0xf3f4f1(0x142)]['NAMESPACE']||_0xf3f4f1(0x165);}async[_0x1f9e0c(0xfa)](){const _0x4324a9=_0x1f9e0c,{signInStatus:signInStatus=0x0,signInModel3Count:signInModel3Count=0x0,signInModel4Count:signInModel4Count=0x0,signInMjDrawToken:signInMjDrawToken=0x0}=await this[_0x4324a9(0x10d)]([_0x4324a9(0x130),_0x4324a9(0x115),_0x4324a9(0x120),_0x4324a9(0x17e)]);if(Number(signInStatus)!==0x1)throw new common_1[(_0x4324a9(0x16b))]('签到功能暂未开放!',common_1[_0x4324a9(0x138)]['BAD_REQUEST']);return{'model3Count':Number(signInModel3Count),'model4Count':Number(signInModel4Count),'drawMjCount':Number(signInMjDrawToken)};}async['auth'](){const _0x1c2cd1=_0x1f9e0c,_0x91bef1=_0x1c2cd1(0x117),_0xfc3114=await fetch(_0x91bef1,{}),_0x1c88a4=await _0xfc3114[_0x1c2cd1(0x19b)](),{success:success=!![],message:_0xdc2405}=_0x1c88a4;common_1['Logger'][_0x1c2cd1(0x140)]('请按要求填写正确的授权信息'),common_1[_0x1c2cd1(0x167)]['error'](_0x1c2cd1(0x1af)),common_1[_0x1c2cd1(0x167)]['error'](_0x1c2cd1(0x102)),common_1[_0x1c2cd1(0x167)][_0x1c2cd1(0x140)](_0x1c2cd1(0x102)),common_1[_0x1c2cd1(0x167)][_0x1c2cd1(0x110)](_0x1c2cd1(0x170));}async[_0x1f9e0c(0x146)](){const _0x107460=_0x1f9e0c,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0x15aa6b,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0x5f2cf6,nineaiBuiltInSensitiveAuthKey:_0x211889}=await this[_0x107460(0x10d)]([_0x107460(0x190),'baiduTextAccessToken',_0x107460(0x183),_0x107460(0xfe),_0x107460(0x119)]);if(Number(baiduTextStatus)===0x1)return{'useType':'baidu','baiduTextAccessToken':_0x15aa6b};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x107460(0x172),'nineaiBuiltInSensitiveApiBase':_0x5f2cf6,'nineaiBuiltInSensitiveAuthKey':_0x211889};return null;}};GlobalConfigService=__decorate([(0x0,common_1[_0x1f9e0c(0x187)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(config_entity_1[_0x1f9e0c(0x158)])),__param(0x1,(0x0,typeorm_1[_0x1f9e0c(0x166)])(chatLog_entity_1[_0x1f9e0c(0x192)])),__metadata('design:paramtypes',[typeorm_2[_0x1f9e0c(0x15e)],typeorm_2[_0x1f9e0c(0x15e)],models_service_1['ModelsService']])],GlobalConfigService),exports['GlobalConfigService']=GlobalConfigService;