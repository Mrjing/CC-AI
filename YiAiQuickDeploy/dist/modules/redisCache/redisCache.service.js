'use strict';function _0x1890(_0x429364,_0x1ff408){const _0x4d3c1b=_0x4d3c();return _0x1890=function(_0x1890b2,_0x45e329){_0x1890b2=_0x1890b2-0x14a;let _0x69472b=_0x4d3c1b[_0x1890b2];return _0x69472b;},_0x1890(_0x429364,_0x1ff408);}const _0x45fc25=_0x1890;function _0x4d3c(){const _0x5e01be=['metadata','includes','HttpException','invalidateTokens','token:','@nestjs/common','ttl','set','UNAUTHORIZED','defineProperty','Inject','redisClient','forEach','40504byGaHn','55264WOeQpd','expire','decorate','120vBprGw','super','length','105LaGYKF','aaa','design:paramtypes','1970VQbXbL','664fHaFQT','function','checkTokenAuth','test','tokens:','__param','get','2096159TuVBfi','26004LYdTwt','RedisCacheService','object','您已在其他设备覆盖登录、请您重新登录！','128LSctBE','BAD_REQUEST','del','HttpStatus','visitor','53157eRBOrD','zRange','809AmXszu','Injectable','onModuleInit','8199tquqmP','saveToken','238ueDcoi'];_0x4d3c=function(){return _0x5e01be;};return _0x4d3c();}(function(_0x1d2979,_0x5136b7){const _0x380360=_0x1890,_0x4027cd=_0x1d2979();while(!![]){try{const _0xc5536d=-parseInt(_0x380360(0x178))/0x1*(parseInt(_0x380360(0x165))/0x2)+-parseInt(_0x380360(0x176))/0x3*(-parseInt(_0x380360(0x171))/0x4)+-parseInt(_0x380360(0x161))/0x5*(parseInt(_0x380360(0x16d))/0x6)+parseInt(_0x380360(0x14c))/0x7*(parseInt(_0x380360(0x15a))/0x8)+parseInt(_0x380360(0x14a))/0x9*(parseInt(_0x380360(0x164))/0xa)+parseInt(_0x380360(0x15b))/0xb*(-parseInt(_0x380360(0x15e))/0xc)+-parseInt(_0x380360(0x16c))/0xd;if(_0xc5536d===_0x5136b7)break;else _0x4027cd['push'](_0x4027cd['shift']());}catch(_0x4a42c1){_0x4027cd['push'](_0x4027cd['shift']());}}}(_0x4d3c,0x54d8c));var __decorate=this&&this['__decorate']||function(_0x1606e6,_0x2a5bc5,_0x3446c0,_0x2ca82f){const _0xe6c9ad=_0x1890;var _0x12cbd5=arguments[_0xe6c9ad(0x160)],_0x2c6832=_0x12cbd5<0x3?_0x2a5bc5:_0x2ca82f===null?_0x2ca82f=Object['getOwnPropertyDescriptor'](_0x2a5bc5,_0x3446c0):_0x2ca82f,_0x1c2a53;if(typeof Reflect===_0xe6c9ad(0x16f)&&typeof Reflect[_0xe6c9ad(0x15d)]==='function')_0x2c6832=Reflect[_0xe6c9ad(0x15d)](_0x1606e6,_0x2a5bc5,_0x3446c0,_0x2ca82f);else{for(var _0x1259db=_0x1606e6[_0xe6c9ad(0x160)]-0x1;_0x1259db>=0x0;_0x1259db--)if(_0x1c2a53=_0x1606e6[_0x1259db])_0x2c6832=(_0x12cbd5<0x3?_0x1c2a53(_0x2c6832):_0x12cbd5>0x3?_0x1c2a53(_0x2a5bc5,_0x3446c0,_0x2c6832):_0x1c2a53(_0x2a5bc5,_0x3446c0))||_0x2c6832;}return _0x12cbd5>0x3&&_0x2c6832&&Object[_0xe6c9ad(0x156)](_0x2a5bc5,_0x3446c0,_0x2c6832),_0x2c6832;},__metadata=this&&this['__metadata']||function(_0x5b215d,_0x2b2df7){const _0x2ab3b1=_0x1890;if(typeof Reflect===_0x2ab3b1(0x16f)&&typeof Reflect[_0x2ab3b1(0x14d)]===_0x2ab3b1(0x166))return Reflect[_0x2ab3b1(0x14d)](_0x5b215d,_0x2b2df7);},__param=this&&this[_0x45fc25(0x16a)]||function(_0x2433ce,_0x1b734f){return function(_0xd5065e,_0x3b14fb){_0x1b734f(_0xd5065e,_0x3b14fb,_0x2433ce);};};Object[_0x45fc25(0x156)](exports,'__esModule',{'value':!![]}),exports[_0x45fc25(0x16e)]=void 0x0;const common_1=require(_0x45fc25(0x152));let RedisCacheService=class RedisCacheService{constructor(_0x615c97){const _0x5f90a3=_0x45fc25;this[_0x5f90a3(0x158)]=_0x615c97;}async[_0x45fc25(0x17a)](){}[_0x45fc25(0x168)](){const _0x5cc6cf=_0x45fc25;return this['redisClient'][_0x5cc6cf(0x154)](_0x5cc6cf(0x162),0x6f),0x1;}async[_0x45fc25(0x16b)](_0x4610ab){const _0x13c261=_0x45fc25,{key:_0x503d66}=_0x4610ab,_0x767932=await this[_0x13c261(0x158)][_0x13c261(0x16b)](_0x503d66);return await this[_0x13c261(0x158)][_0x13c261(0x16b)](_0x503d66);}async[_0x45fc25(0x154)](_0x5f13bb,_0x35c558){const _0x5b45b9=_0x45fc25;try{const {key:_0x46dab2,val:_0x42bd4a}=_0x5f13bb;await this[_0x5b45b9(0x158)]['set'](_0x46dab2,_0x42bd4a),_0x35c558&&await this[_0x5b45b9(0x158)][_0x5b45b9(0x15c)](_0x46dab2,_0x35c558);return;}catch(_0x1b5d1f){throw new common_1[(_0x5b45b9(0x14f))](_0x1b5d1f,common_1[_0x5b45b9(0x174)][_0x5b45b9(0x172)]);}}async['ttl'](_0x3d896f){const _0x3f7eb8=_0x45fc25;return await this[_0x3f7eb8(0x158)][_0x3f7eb8(0x153)](_0x3d896f);}async['del'](_0x5887c5){const _0x2a86a3=_0x45fc25,{key:_0x3da226}=_0x5887c5;await this['redisClient'][_0x2a86a3(0x173)](_0x3da226);return;}async[_0x45fc25(0x14b)](_0x4b3fd7,_0x4c8dd2){const _0x2cccdb=_0x45fc25,_0x5ed616=await this[_0x2cccdb(0x158)][_0x2cccdb(0x177)](_0x2cccdb(0x169)+_0x4b3fd7,0x0,-0x1);await this[_0x2cccdb(0x150)](_0x4b3fd7,_0x5ed616),this[_0x2cccdb(0x158)]['set']('token:'+_0x4b3fd7,_0x4c8dd2);}async['invalidateTokens'](_0x46f9fc,_0x2350a8){const _0xa07285=_0x45fc25;_0x2350a8[_0xa07285(0x159)](_0x12facb=>{const _0x3f63f7=_0xa07285;this[_0x3f63f7(0x158)][_0x3f63f7(0x173)]('token:'+_0x46f9fc+':'+_0x12facb);});}async[_0x45fc25(0x167)](_0x503794,_0xda0ec2){const _0x5ecef1=_0x45fc25,{id:_0x45bac9,role:_0x52103e}=_0xda0ec2['user'];if(_0x52103e===_0x5ecef1(0x175))return!![];const _0x919c00=await this[_0x5ecef1(0x158)][_0x5ecef1(0x16b)]('token:'+_0x45bac9);if(_0x919c00===null)return await this[_0x5ecef1(0x158)][_0x5ecef1(0x154)](_0x5ecef1(0x151)+_0x45bac9,_0x503794),!![];if(_0x919c00!==_0x503794){if([_0x5ecef1(0x15f),'admin'][_0x5ecef1(0x14e)](_0x52103e))return!![];throw new common_1[(_0x5ecef1(0x14f))](_0x5ecef1(0x170),common_1[_0x5ecef1(0x174)][_0x5ecef1(0x155)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x45fc25(0x179)])(),__param(0x0,(0x0,common_1[_0x45fc25(0x157)])('REDIS_CLIENT')),__metadata(_0x45fc25(0x163),[Object])],RedisCacheService),exports[_0x45fc25(0x16e)]=RedisCacheService;