'use strict';const _0x345808=_0x27a2;(function(_0x4547e5,_0x38d496){const _0x5e2618=_0x27a2,_0x51098f=_0x4547e5();while(!![]){try{const _0x2c3be8=-parseInt(_0x5e2618(0xb4))/0x1*(-parseInt(_0x5e2618(0xad))/0x2)+-parseInt(_0x5e2618(0xc3))/0x3*(-parseInt(_0x5e2618(0xc5))/0x4)+parseInt(_0x5e2618(0xb6))/0x5+-parseInt(_0x5e2618(0xb5))/0x6+parseInt(_0x5e2618(0xc9))/0x7+parseInt(_0x5e2618(0xd0))/0x8*(parseInt(_0x5e2618(0xb0))/0x9)+-parseInt(_0x5e2618(0xc7))/0xa;if(_0x2c3be8===_0x38d496)break;else _0x51098f['push'](_0x51098f['shift']());}catch(_0x1dad75){_0x51098f['push'](_0x51098f['shift']());}}}(_0x5a74,0x50779));var __decorate=this&&this['__decorate']||function(_0x1c05df,_0x191e90,_0x47ca7e,_0x3be14f){const _0xc58bc4=_0x27a2;var _0x4f4d24=arguments[_0xc58bc4(0xce)],_0x53a683=_0x4f4d24<0x3?_0x191e90:_0x3be14f===null?_0x3be14f=Object[_0xc58bc4(0xbf)](_0x191e90,_0x47ca7e):_0x3be14f,_0x4265ed;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0xc58bc4(0xbc))_0x53a683=Reflect[_0xc58bc4(0xb1)](_0x1c05df,_0x191e90,_0x47ca7e,_0x3be14f);else{for(var _0x2724eb=_0x1c05df['length']-0x1;_0x2724eb>=0x0;_0x2724eb--)if(_0x4265ed=_0x1c05df[_0x2724eb])_0x53a683=(_0x4f4d24<0x3?_0x4265ed(_0x53a683):_0x4f4d24>0x3?_0x4265ed(_0x191e90,_0x47ca7e,_0x53a683):_0x4265ed(_0x191e90,_0x47ca7e))||_0x53a683;}return _0x4f4d24>0x3&&_0x53a683&&Object['defineProperty'](_0x191e90,_0x47ca7e,_0x53a683),_0x53a683;},__metadata=this&&this['__metadata']||function(_0x30ac6f,_0x4512ce){const _0x2a39e6=_0x27a2;if(typeof Reflect===_0x2a39e6(0xb7)&&typeof Reflect[_0x2a39e6(0xba)]==='function')return Reflect[_0x2a39e6(0xba)](_0x30ac6f,_0x4512ce);},__param=this&&this[_0x345808(0xb2)]||function(_0x1593a7,_0x56bdf5){return function(_0x127686,_0x23ba21){_0x56bdf5(_0x127686,_0x23ba21,_0x1593a7);};};Object[_0x345808(0xcd)](exports,'__esModule',{'value':!![]}),exports['RedisCacheService']=void 0x0;const common_1=require(_0x345808(0xaf));function _0x5a74(){const _0x466e26=['forEach','112AvEFMX','tokens:','expire','onModuleInit','ttl','token:','14692CefXhN','super','@nestjs/common','379701hcqaAa','decorate','__param','set','5BuaERB','1375818iOmiRU','1205965GoQAeu','object','Injectable','get','metadata','HttpException','function','HttpStatus','Inject','getOwnPropertyDescriptor','visitor','您已在其他设备覆盖登录、请您重新登录！','aaa','6obVyvA','redisClient','591684RKHeYd','saveToken','6923210VmLAvz','del','607642QxyLVQ','checkTokenAuth','invalidateTokens','test','defineProperty','length'];_0x5a74=function(){return _0x466e26;};return _0x5a74();}let RedisCacheService=class RedisCacheService{constructor(_0x2d104a){this['redisClient']=_0x2d104a;}async[_0x345808(0xaa)](){}[_0x345808(0xcc)](){const _0x3e4007=_0x345808;return this[_0x3e4007(0xc4)]['set'](_0x3e4007(0xc2),0x6f),0x1;}async[_0x345808(0xb9)](_0x55acdb){const _0x6e792b=_0x345808,{key:_0xfcd637}=_0x55acdb,_0x371de3=await this[_0x6e792b(0xc4)][_0x6e792b(0xb9)](_0xfcd637);return await this[_0x6e792b(0xc4)][_0x6e792b(0xb9)](_0xfcd637);}async[_0x345808(0xb3)](_0x2520b3,_0x5ac69d){const _0x4fbd52=_0x345808;try{const {key:_0x451cb4,val:_0x54fe57}=_0x2520b3;await this['redisClient'][_0x4fbd52(0xb3)](_0x451cb4,_0x54fe57),_0x5ac69d&&await this[_0x4fbd52(0xc4)][_0x4fbd52(0xa9)](_0x451cb4,_0x5ac69d);return;}catch(_0x33fc7e){throw new common_1[(_0x4fbd52(0xbb))](_0x33fc7e,common_1['HttpStatus']['BAD_REQUEST']);}}async[_0x345808(0xab)](_0x40df55){const _0xb2a1e1=_0x345808;return await this['redisClient'][_0xb2a1e1(0xab)](_0x40df55);}async['del'](_0x4f8384){const _0x3060e9=_0x345808,{key:_0x546b66}=_0x4f8384;await this['redisClient'][_0x3060e9(0xc8)](_0x546b66);return;}async[_0x345808(0xc6)](_0x184a3a,_0x400a1b){const _0x1ded08=_0x345808,_0x53541c=await this[_0x1ded08(0xc4)]['zRange'](_0x1ded08(0xa8)+_0x184a3a,0x0,-0x1);await this[_0x1ded08(0xcb)](_0x184a3a,_0x53541c),this[_0x1ded08(0xc4)][_0x1ded08(0xb3)]('token:'+_0x184a3a,_0x400a1b);}async[_0x345808(0xcb)](_0x32a553,_0x368a59){const _0x2dd256=_0x345808;_0x368a59[_0x2dd256(0xcf)](_0x5bade9=>{const _0x3f1f35=_0x2dd256;this[_0x3f1f35(0xc4)][_0x3f1f35(0xc8)](_0x3f1f35(0xac)+_0x32a553+':'+_0x5bade9);});}async[_0x345808(0xca)](_0x146e02,_0x39cff9){const _0x3c1e87=_0x345808,{id:_0x3da6d2,role:_0x440a6d}=_0x39cff9['user'];if(_0x440a6d===_0x3c1e87(0xc0))return!![];const _0x5f5a25=await this[_0x3c1e87(0xc4)][_0x3c1e87(0xb9)](_0x3c1e87(0xac)+_0x3da6d2);if(_0x5f5a25===null)return await this[_0x3c1e87(0xc4)][_0x3c1e87(0xb3)](_0x3c1e87(0xac)+_0x3da6d2,_0x146e02),!![];if(_0x5f5a25!==_0x146e02){if([_0x3c1e87(0xae),'admin']['includes'](_0x440a6d))return!![];throw new common_1[(_0x3c1e87(0xbb))](_0x3c1e87(0xc1),common_1[_0x3c1e87(0xbd)]['UNAUTHORIZED']);}}};function _0x27a2(_0xb29e9d,_0x2c376b){const _0x5a7482=_0x5a74();return _0x27a2=function(_0x27a24b,_0x11208e){_0x27a24b=_0x27a24b-0xa8;let _0x350211=_0x5a7482[_0x27a24b];return _0x350211;},_0x27a2(_0xb29e9d,_0x2c376b);}RedisCacheService=__decorate([(0x0,common_1[_0x345808(0xb8)])(),__param(0x0,(0x0,common_1[_0x345808(0xbe)])('REDIS_CLIENT')),__metadata('design:paramtypes',[Object])],RedisCacheService),exports['RedisCacheService']=RedisCacheService;