'use strict';const _0x47f101=_0xf665;(function(_0x323b15,_0x14723d){const _0x249aa7=_0xf665,_0x1b29cb=_0x323b15();while(!![]){try{const _0x474a89=-parseInt(_0x249aa7(0x161))/0x1+parseInt(_0x249aa7(0x16c))/0x2+-parseInt(_0x249aa7(0x16f))/0x3*(parseInt(_0x249aa7(0x153))/0x4)+-parseInt(_0x249aa7(0x174))/0x5+-parseInt(_0x249aa7(0x15c))/0x6*(-parseInt(_0x249aa7(0x15e))/0x7)+-parseInt(_0x249aa7(0x171))/0x8*(parseInt(_0x249aa7(0x178))/0x9)+-parseInt(_0x249aa7(0x169))/0xa*(-parseInt(_0x249aa7(0x14f))/0xb);if(_0x474a89===_0x14723d)break;else _0x1b29cb['push'](_0x1b29cb['shift']());}catch(_0x416233){_0x1b29cb['push'](_0x1b29cb['shift']());}}}(_0x3a69,0x294d8));function _0x3a69(){const _0x3a42f3=['length','240052aALLvo','aaa','visitor','ttl','__param','checkTokenAuth','token:','object','10ALgPWE','get','getOwnPropertyDescriptor','110882nVMmtB','zRange','expire','40962WqzSmX','forEach','128YRHIEK','__metadata','Inject','1247510UTIPub','redisClient','user','RedisCacheService','18342PHEvJg','您已在其他设备覆盖登录、请您重新登录！','5098621DCWbum','invalidateTokens','decorate','metadata','16samnSw','tokens:','saveToken','super','design:paramtypes','del','set','HttpException','Injectable','12lnMcgD','BAD_REQUEST','794507aIdzRK','admin'];_0x3a69=function(){return _0x3a42f3;};return _0x3a69();}var __decorate=this&&this['__decorate']||function(_0x427a50,_0x551e27,_0x14ed54,_0x4a9b6e){const _0xc67a55=_0xf665;var _0x2cf2e1=arguments[_0xc67a55(0x160)],_0x320832=_0x2cf2e1<0x3?_0x551e27:_0x4a9b6e===null?_0x4a9b6e=Object[_0xc67a55(0x16b)](_0x551e27,_0x14ed54):_0x4a9b6e,_0x1afb31;if(typeof Reflect==='object'&&typeof Reflect[_0xc67a55(0x151)]==='function')_0x320832=Reflect[_0xc67a55(0x151)](_0x427a50,_0x551e27,_0x14ed54,_0x4a9b6e);else{for(var _0x199155=_0x427a50['length']-0x1;_0x199155>=0x0;_0x199155--)if(_0x1afb31=_0x427a50[_0x199155])_0x320832=(_0x2cf2e1<0x3?_0x1afb31(_0x320832):_0x2cf2e1>0x3?_0x1afb31(_0x551e27,_0x14ed54,_0x320832):_0x1afb31(_0x551e27,_0x14ed54))||_0x320832;}return _0x2cf2e1>0x3&&_0x320832&&Object['defineProperty'](_0x551e27,_0x14ed54,_0x320832),_0x320832;},__metadata=this&&this[_0x47f101(0x172)]||function(_0x1aa72f,_0x442f1e){const _0x2b0547=_0x47f101;if(typeof Reflect===_0x2b0547(0x168)&&typeof Reflect[_0x2b0547(0x152)]==='function')return Reflect[_0x2b0547(0x152)](_0x1aa72f,_0x442f1e);},__param=this&&this[_0x47f101(0x165)]||function(_0x2f3253,_0x4e2193){return function(_0x742a34,_0x48282d){_0x4e2193(_0x742a34,_0x48282d,_0x2f3253);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x47f101(0x177)]=void 0x0;const common_1=require('@nestjs/common');let RedisCacheService=class RedisCacheService{constructor(_0xe4c5f6){const _0x2f929d=_0x47f101;this[_0x2f929d(0x175)]=_0xe4c5f6;}async['onModuleInit'](){}['test'](){const _0x2ffe85=_0x47f101;return this[_0x2ffe85(0x175)][_0x2ffe85(0x159)](_0x2ffe85(0x162),0x6f),0x1;}async[_0x47f101(0x16a)](_0x28b093){const _0x3587a2=_0x47f101,{key:_0x56497e}=_0x28b093,_0x4869c3=await this[_0x3587a2(0x175)][_0x3587a2(0x16a)](_0x56497e);return await this[_0x3587a2(0x175)][_0x3587a2(0x16a)](_0x56497e);}async[_0x47f101(0x159)](_0xb5291e,_0x4a1bee){const _0x5aca93=_0x47f101;try{const {key:_0x1f9edc,val:_0x57a034}=_0xb5291e;await this[_0x5aca93(0x175)][_0x5aca93(0x159)](_0x1f9edc,_0x57a034),_0x4a1bee&&await this[_0x5aca93(0x175)][_0x5aca93(0x16e)](_0x1f9edc,_0x4a1bee);return;}catch(_0x2afe64){throw new common_1['HttpException'](_0x2afe64,common_1['HttpStatus'][_0x5aca93(0x15d)]);}}async[_0x47f101(0x164)](_0x2ce412){const _0x2b8e45=_0x47f101;return await this['redisClient'][_0x2b8e45(0x164)](_0x2ce412);}async[_0x47f101(0x158)](_0x3390ee){const _0x296a98=_0x47f101,{key:_0x3508fe}=_0x3390ee;await this[_0x296a98(0x175)]['del'](_0x3508fe);return;}async[_0x47f101(0x155)](_0x23991c,_0x46c162){const _0x5eccbd=_0x47f101,_0x2bce06=await this[_0x5eccbd(0x175)][_0x5eccbd(0x16d)](_0x5eccbd(0x154)+_0x23991c,0x0,-0x1);await this['invalidateTokens'](_0x23991c,_0x2bce06),this['redisClient'][_0x5eccbd(0x159)]('token:'+_0x23991c,_0x46c162);}async[_0x47f101(0x150)](_0x1c00b2,_0x30c33b){const _0x4199f7=_0x47f101;_0x30c33b[_0x4199f7(0x170)](_0x51e9ea=>{const _0x2177d6=_0x4199f7;this[_0x2177d6(0x175)][_0x2177d6(0x158)]('token:'+_0x1c00b2+':'+_0x51e9ea);});}async[_0x47f101(0x166)](_0x4b07c5,_0x452f3b){const _0x38f26d=_0x47f101,{id:_0x278bcc,role:_0x4d08db}=_0x452f3b[_0x38f26d(0x176)];if(_0x4d08db===_0x38f26d(0x163))return!![];const _0x6ed75b=await this[_0x38f26d(0x175)][_0x38f26d(0x16a)]('token:'+_0x278bcc);if(_0x6ed75b===null)return await this['redisClient'][_0x38f26d(0x159)](_0x38f26d(0x167)+_0x278bcc,_0x4b07c5),!![];if(_0x6ed75b!==_0x4b07c5){if([_0x38f26d(0x156),_0x38f26d(0x15f)]['includes'](_0x4d08db))return!![];throw new common_1[(_0x38f26d(0x15a))](_0x38f26d(0x14e),common_1['HttpStatus']['UNAUTHORIZED']);}}};function _0xf665(_0x29bae0,_0x4956a7){const _0x3a69a9=_0x3a69();return _0xf665=function(_0xf6657a,_0x41bd81){_0xf6657a=_0xf6657a-0x14e;let _0x1eb27a=_0x3a69a9[_0xf6657a];return _0x1eb27a;},_0xf665(_0x29bae0,_0x4956a7);}RedisCacheService=__decorate([(0x0,common_1[_0x47f101(0x15b)])(),__param(0x0,(0x0,common_1[_0x47f101(0x173)])('REDIS_CLIENT')),__metadata(_0x47f101(0x157),[Object])],RedisCacheService),exports[_0x47f101(0x177)]=RedisCacheService;