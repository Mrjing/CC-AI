'use strict';function _0x29a9(_0x2c080f,_0x292a24){const _0x1afcaf=_0x1afc();return _0x29a9=function(_0x29a91b,_0x18a375){_0x29a91b=_0x29a91b-0x178;let _0x2d7425=_0x1afcaf[_0x29a91b];return _0x2d7425;},_0x29a9(_0x2c080f,_0x292a24);}const _0x2c6008=_0x29a9;(function(_0x26d5b0,_0x1d60db){const _0x5e45d8=_0x29a9,_0x5c9e0b=_0x26d5b0();while(!![]){try{const _0xc58277=-parseInt(_0x5e45d8(0x192))/0x1+parseInt(_0x5e45d8(0x17d))/0x2*(parseInt(_0x5e45d8(0x19d))/0x3)+parseInt(_0x5e45d8(0x179))/0x4*(-parseInt(_0x5e45d8(0x193))/0x5)+-parseInt(_0x5e45d8(0x1a0))/0x6*(-parseInt(_0x5e45d8(0x18e))/0x7)+-parseInt(_0x5e45d8(0x19e))/0x8+parseInt(_0x5e45d8(0x17c))/0x9+-parseInt(_0x5e45d8(0x191))/0xa*(-parseInt(_0x5e45d8(0x19a))/0xb);if(_0xc58277===_0x1d60db)break;else _0x5c9e0b['push'](_0x5c9e0b['shift']());}catch(_0x166c5e){_0x5c9e0b['push'](_0x5c9e0b['shift']());}}}(_0x1afc,0xb3885));var __decorate=this&&this[_0x2c6008(0x1a4)]||function(_0x54939c,_0x157ba7,_0x462a72,_0x39c715){const _0x269769=_0x2c6008;var _0x32a3b0=arguments[_0x269769(0x1a5)],_0xea691b=_0x32a3b0<0x3?_0x157ba7:_0x39c715===null?_0x39c715=Object[_0x269769(0x185)](_0x157ba7,_0x462a72):_0x39c715,_0x4ddf49;if(typeof Reflect===_0x269769(0x189)&&typeof Reflect['decorate']===_0x269769(0x17e))_0xea691b=Reflect[_0x269769(0x19b)](_0x54939c,_0x157ba7,_0x462a72,_0x39c715);else{for(var _0x5ea9d8=_0x54939c[_0x269769(0x1a5)]-0x1;_0x5ea9d8>=0x0;_0x5ea9d8--)if(_0x4ddf49=_0x54939c[_0x5ea9d8])_0xea691b=(_0x32a3b0<0x3?_0x4ddf49(_0xea691b):_0x32a3b0>0x3?_0x4ddf49(_0x157ba7,_0x462a72,_0xea691b):_0x4ddf49(_0x157ba7,_0x462a72))||_0xea691b;}return _0x32a3b0>0x3&&_0xea691b&&Object[_0x269769(0x197)](_0x157ba7,_0x462a72,_0xea691b),_0xea691b;},__metadata=this&&this[_0x2c6008(0x18d)]||function(_0x2de105,_0x3ff4e3){const _0x20b30e=_0x2c6008;if(typeof Reflect===_0x20b30e(0x189)&&typeof Reflect[_0x20b30e(0x1a6)]==='function')return Reflect['metadata'](_0x2de105,_0x3ff4e3);},__param=this&&this['__param']||function(_0x2bbb70,_0x235ed9){return function(_0x34a05e,_0x520ed8){_0x235ed9(_0x34a05e,_0x520ed8,_0x2bbb70);};};function _0x1afc(){const _0x391fa8=['RedisCacheService','visitor','admin','object','saveToken','token:','UNAUTHORIZED','__metadata','312557vpRmsJ','user','super','2130JanQXZ','1259990iTJHRg','196815RcZLEw','invalidateTokens','redisClient','get','defineProperty','aaa','onModuleInit','43593WiSicw','decorate','design:paramtypes','1077mhZbPk','465848MrNvpn','del','192FsvHcs','@nestjs/common','test','expire','__decorate','length','metadata','Injectable','116dUGdBx','set','tokens:','2167020CxKSEQ','3796eUbNZy','function','HttpException','REDIS_CLIENT','forEach','ttl','Inject','HttpStatus','getOwnPropertyDescriptor'];_0x1afc=function(){return _0x391fa8;};return _0x1afc();}Object[_0x2c6008(0x197)](exports,'__esModule',{'value':!![]}),exports[_0x2c6008(0x186)]=void 0x0;const common_1=require(_0x2c6008(0x1a1));let RedisCacheService=class RedisCacheService{constructor(_0x80b2c2){this['redisClient']=_0x80b2c2;}async[_0x2c6008(0x199)](){}[_0x2c6008(0x1a2)](){const _0x583f33=_0x2c6008;return this[_0x583f33(0x195)][_0x583f33(0x17a)](_0x583f33(0x198),0x6f),0x1;}async[_0x2c6008(0x196)](_0xa7dcd3){const _0x4db104=_0x2c6008,{key:_0x1a81ca}=_0xa7dcd3,_0x146005=await this[_0x4db104(0x195)]['get'](_0x1a81ca);return await this[_0x4db104(0x195)][_0x4db104(0x196)](_0x1a81ca);}async[_0x2c6008(0x17a)](_0x329943,_0x20b2d7){const _0x37104e=_0x2c6008;try{const {key:_0x42f473,val:_0x1f70c7}=_0x329943;await this[_0x37104e(0x195)][_0x37104e(0x17a)](_0x42f473,_0x1f70c7),_0x20b2d7&&await this[_0x37104e(0x195)][_0x37104e(0x1a3)](_0x42f473,_0x20b2d7);return;}catch(_0x481d46){throw new common_1[(_0x37104e(0x17f))](_0x481d46,common_1[_0x37104e(0x184)]['BAD_REQUEST']);}}async[_0x2c6008(0x182)](_0x471f5b){const _0x361355=_0x2c6008;return await this[_0x361355(0x195)][_0x361355(0x182)](_0x471f5b);}async['del'](_0x3f4b58){const _0x42b5bf=_0x2c6008,{key:_0x3097ae}=_0x3f4b58;await this[_0x42b5bf(0x195)][_0x42b5bf(0x19f)](_0x3097ae);return;}async[_0x2c6008(0x18a)](_0x12691b,_0x5190dc){const _0x25f688=_0x2c6008,_0x1c8c5c=await this[_0x25f688(0x195)]['zRange'](_0x25f688(0x17b)+_0x12691b,0x0,-0x1);await this[_0x25f688(0x194)](_0x12691b,_0x1c8c5c),this[_0x25f688(0x195)][_0x25f688(0x17a)](_0x25f688(0x18b)+_0x12691b,_0x5190dc);}async[_0x2c6008(0x194)](_0x497894,_0x52d166){const _0x339c19=_0x2c6008;_0x52d166[_0x339c19(0x181)](_0x574b00=>{const _0x15a634=_0x339c19;this['redisClient'][_0x15a634(0x19f)]('token:'+_0x497894+':'+_0x574b00);});}async['checkTokenAuth'](_0x3d5438,_0x7ab8d6){const _0x2a4510=_0x2c6008,{id:_0xea890e,role:_0x539607}=_0x7ab8d6[_0x2a4510(0x18f)];if(_0x539607===_0x2a4510(0x187))return!![];const _0x3891ae=await this[_0x2a4510(0x195)]['get'](_0x2a4510(0x18b)+_0xea890e);if(_0x3891ae===null)return await this[_0x2a4510(0x195)][_0x2a4510(0x17a)]('token:'+_0xea890e,_0x3d5438),!![];if(_0x3891ae!==_0x3d5438){if([_0x2a4510(0x190),_0x2a4510(0x188)]['includes'](_0x539607))return!![];throw new common_1[(_0x2a4510(0x17f))]('您已在其他设备覆盖登录、请您重新登录！',common_1['HttpStatus'][_0x2a4510(0x18c)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x2c6008(0x178)])(),__param(0x0,(0x0,common_1[_0x2c6008(0x183)])(_0x2c6008(0x180))),__metadata(_0x2c6008(0x19c),[Object])],RedisCacheService),exports[_0x2c6008(0x186)]=RedisCacheService;