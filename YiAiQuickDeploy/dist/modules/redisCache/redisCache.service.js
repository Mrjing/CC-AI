'use strict';const _0x3dc2e8=_0x43d9;(function(_0x4424a6,_0x5a7d84){const _0x32c01d=_0x43d9,_0x57ea70=_0x4424a6();while(!![]){try{const _0x1d12f2=-parseInt(_0x32c01d(0x1a7))/0x1*(-parseInt(_0x32c01d(0x1c1))/0x2)+parseInt(_0x32c01d(0x1c0))/0x3+parseInt(_0x32c01d(0x1a2))/0x4*(parseInt(_0x32c01d(0x1ac))/0x5)+parseInt(_0x32c01d(0x1b3))/0x6*(parseInt(_0x32c01d(0x1ab))/0x7)+-parseInt(_0x32c01d(0x1a5))/0x8*(-parseInt(_0x32c01d(0x1a8))/0x9)+parseInt(_0x32c01d(0x1c6))/0xa+-parseInt(_0x32c01d(0x1af))/0xb*(parseInt(_0x32c01d(0x1a6))/0xc);if(_0x1d12f2===_0x5a7d84)break;else _0x57ea70['push'](_0x57ea70['shift']());}catch(_0x4a8977){_0x57ea70['push'](_0x57ea70['shift']());}}}(_0x4d1c,0xbe0ee));function _0x43d9(_0xba78cf,_0x19f466){const _0x4d1c58=_0x4d1c();return _0x43d9=function(_0x43d96b,_0x109d29){_0x43d96b=_0x43d96b-0x197;let _0x307123=_0x4d1c58[_0x43d96b];return _0x307123;},_0x43d9(_0xba78cf,_0x19f466);}function _0x4d1c(){const _0x2e7b3a=['__metadata','HttpException','checkTokenAuth','Injectable','5267300ssQZMW','REDIS_CLIENT','design:paramtypes','getOwnPropertyDescriptor','zRange','del','__decorate','onModuleInit','test','user','redisClient','Inject','36IhIyHT','set','BAD_REQUEST','6782168QaCIZj','10308siEbXo','80nzzpmu','9INtKbV','tokens:','metadata','7YXgxdN','860500VrwUzM','@nestjs/common','object','68123JynvtY','includes','get','HttpStatus','6741498MQGTLz','visitor','invalidateTokens','RedisCacheService','length','admin','saveToken','您已在其他设备覆盖登录、请您重新登录！','defineProperty','UNAUTHORIZED','token:','function','ttl','3614883RHQHDj','21158AXvJZh'];_0x4d1c=function(){return _0x2e7b3a;};return _0x4d1c();}var __decorate=this&&this[_0x3dc2e8(0x19c)]||function(_0x50ac1f,_0x30ce26,_0x10ee07,_0x294c23){const _0x45feba=_0x3dc2e8;var _0x3597e6=arguments['length'],_0x4ecba6=_0x3597e6<0x3?_0x30ce26:_0x294c23===null?_0x294c23=Object[_0x45feba(0x199)](_0x30ce26,_0x10ee07):_0x294c23,_0x267183;if(typeof Reflect===_0x45feba(0x1ae)&&typeof Reflect['decorate']===_0x45feba(0x1be))_0x4ecba6=Reflect['decorate'](_0x50ac1f,_0x30ce26,_0x10ee07,_0x294c23);else{for(var _0x54f74f=_0x50ac1f[_0x45feba(0x1b7)]-0x1;_0x54f74f>=0x0;_0x54f74f--)if(_0x267183=_0x50ac1f[_0x54f74f])_0x4ecba6=(_0x3597e6<0x3?_0x267183(_0x4ecba6):_0x3597e6>0x3?_0x267183(_0x30ce26,_0x10ee07,_0x4ecba6):_0x267183(_0x30ce26,_0x10ee07))||_0x4ecba6;}return _0x3597e6>0x3&&_0x4ecba6&&Object[_0x45feba(0x1bb)](_0x30ce26,_0x10ee07,_0x4ecba6),_0x4ecba6;},__metadata=this&&this[_0x3dc2e8(0x1c2)]||function(_0x4fbd5f,_0x58bf56){const _0x158667=_0x3dc2e8;if(typeof Reflect===_0x158667(0x1ae)&&typeof Reflect['metadata']==='function')return Reflect[_0x158667(0x1aa)](_0x4fbd5f,_0x58bf56);},__param=this&&this['__param']||function(_0x35befc,_0x461973){return function(_0x36b11a,_0x1d7747){_0x461973(_0x36b11a,_0x1d7747,_0x35befc);};};Object[_0x3dc2e8(0x1bb)](exports,'__esModule',{'value':!![]}),exports['RedisCacheService']=void 0x0;const common_1=require(_0x3dc2e8(0x1ad));let RedisCacheService=class RedisCacheService{constructor(_0x5386c9){const _0x20751c=_0x3dc2e8;this[_0x20751c(0x1a0)]=_0x5386c9;}async[_0x3dc2e8(0x19d)](){}[_0x3dc2e8(0x19e)](){const _0x4332e0=_0x3dc2e8;return this[_0x4332e0(0x1a0)][_0x4332e0(0x1a3)]('aaa',0x6f),0x1;}async[_0x3dc2e8(0x1b1)](_0x295102){const _0x4587ce=_0x3dc2e8,{key:_0x1c0941}=_0x295102,_0x130809=await this[_0x4587ce(0x1a0)][_0x4587ce(0x1b1)](_0x1c0941);return await this[_0x4587ce(0x1a0)][_0x4587ce(0x1b1)](_0x1c0941);}async['set'](_0x1e5b53,_0x5d7e37){const _0x506c0b=_0x3dc2e8;try{const {key:_0x416b09,val:_0x57a4c2}=_0x1e5b53;await this[_0x506c0b(0x1a0)][_0x506c0b(0x1a3)](_0x416b09,_0x57a4c2),_0x5d7e37&&await this[_0x506c0b(0x1a0)]['expire'](_0x416b09,_0x5d7e37);return;}catch(_0x5d29a2){throw new common_1['HttpException'](_0x5d29a2,common_1[_0x506c0b(0x1b2)][_0x506c0b(0x1a4)]);}}async[_0x3dc2e8(0x1bf)](_0x571b7c){const _0x357e34=_0x3dc2e8;return await this[_0x357e34(0x1a0)][_0x357e34(0x1bf)](_0x571b7c);}async[_0x3dc2e8(0x19b)](_0xb3dc24){const _0x381666=_0x3dc2e8,{key:_0x5e5a7e}=_0xb3dc24;await this[_0x381666(0x1a0)][_0x381666(0x19b)](_0x5e5a7e);return;}async[_0x3dc2e8(0x1b9)](_0x48b963,_0x422258){const _0x31e23f=_0x3dc2e8,_0x7e18be=await this[_0x31e23f(0x1a0)][_0x31e23f(0x19a)](_0x31e23f(0x1a9)+_0x48b963,0x0,-0x1);await this['invalidateTokens'](_0x48b963,_0x7e18be),this['redisClient'][_0x31e23f(0x1a3)]('token:'+_0x48b963,_0x422258);}async[_0x3dc2e8(0x1b5)](_0x1a0558,_0x342b25){_0x342b25['forEach'](_0x44c811=>{const _0x34879e=_0x43d9;this[_0x34879e(0x1a0)][_0x34879e(0x19b)]('token:'+_0x1a0558+':'+_0x44c811);});}async[_0x3dc2e8(0x1c4)](_0x3e9906,_0x3b7aab){const _0x1d1dbf=_0x3dc2e8,{id:_0x1621bd,role:_0x3a0f80}=_0x3b7aab[_0x1d1dbf(0x19f)];if(_0x3a0f80===_0x1d1dbf(0x1b4))return!![];const _0xfa19b0=await this[_0x1d1dbf(0x1a0)]['get'](_0x1d1dbf(0x1bd)+_0x1621bd);if(_0xfa19b0===null)return await this['redisClient']['set'](_0x1d1dbf(0x1bd)+_0x1621bd,_0x3e9906),!![];if(_0xfa19b0!==_0x3e9906){if(['super',_0x1d1dbf(0x1b8)][_0x1d1dbf(0x1b0)](_0x3a0f80))return!![];throw new common_1[(_0x1d1dbf(0x1c3))](_0x1d1dbf(0x1ba),common_1[_0x1d1dbf(0x1b2)][_0x1d1dbf(0x1bc)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x3dc2e8(0x1c5)])(),__param(0x0,(0x0,common_1[_0x3dc2e8(0x1a1)])(_0x3dc2e8(0x197))),__metadata(_0x3dc2e8(0x198),[Object])],RedisCacheService),exports[_0x3dc2e8(0x1b6)]=RedisCacheService;