'use strict';const _0x9e1ba7=_0x2ad1;(function(_0x44a4e5,_0xd907a8){const _0x590bda=_0x2ad1,_0x327c45=_0x44a4e5();while(!![]){try{const _0x2363f9=-parseInt(_0x590bda(0x1bd))/0x1+parseInt(_0x590bda(0x1cd))/0x2*(parseInt(_0x590bda(0x1e1))/0x3)+-parseInt(_0x590bda(0x1e3))/0x4*(parseInt(_0x590bda(0x1e0))/0x5)+parseInt(_0x590bda(0x1d9))/0x6+parseInt(_0x590bda(0x1c4))/0x7+parseInt(_0x590bda(0x1c1))/0x8*(-parseInt(_0x590bda(0x1bf))/0x9)+parseInt(_0x590bda(0x1db))/0xa*(parseInt(_0x590bda(0x1d7))/0xb);if(_0x2363f9===_0xd907a8)break;else _0x327c45['push'](_0x327c45['shift']());}catch(_0x42adc6){_0x327c45['push'](_0x327c45['shift']());}}}(_0x3e71,0x770ea));function _0x3e71(){const _0x198fef=['get','admin','4081091EhrObY','RedisCacheService','del','design:paramtypes','token:','metadata','@nestjs/common','set','ttl','16054CxcpGb','zRange','__metadata','UNAUTHORIZED','invalidateTokens','__param','object','visitor','includes','aaa','176KnytOq','function','566706ZiIQzZ','user','796620JzLsqn','decorate','Injectable','HttpException','HttpStatus','10AxfXwg','3KZsdBS','__decorate','1703456dxFlSg','length','saveToken','BAD_REQUEST','redisClient','defineProperty','test','super','445455fJrCAF','REDIS_CLIENT','262863fuArAN','您已在其他设备覆盖登录、请您重新登录！','48WmlwYa'];_0x3e71=function(){return _0x198fef;};return _0x3e71();}var __decorate=this&&this[_0x9e1ba7(0x1e2)]||function(_0x20e481,_0xa27156,_0x3ca003,_0x1d3006){const _0x5026c5=_0x9e1ba7;var _0x20777c=arguments[_0x5026c5(0x1e4)],_0x5c3048=_0x20777c<0x3?_0xa27156:_0x1d3006===null?_0x1d3006=Object['getOwnPropertyDescriptor'](_0xa27156,_0x3ca003):_0x1d3006,_0x1a6db0;if(typeof Reflect==='object'&&typeof Reflect[_0x5026c5(0x1dc)]===_0x5026c5(0x1d8))_0x5c3048=Reflect[_0x5026c5(0x1dc)](_0x20e481,_0xa27156,_0x3ca003,_0x1d3006);else{for(var _0x35ffb5=_0x20e481[_0x5026c5(0x1e4)]-0x1;_0x35ffb5>=0x0;_0x35ffb5--)if(_0x1a6db0=_0x20e481[_0x35ffb5])_0x5c3048=(_0x20777c<0x3?_0x1a6db0(_0x5c3048):_0x20777c>0x3?_0x1a6db0(_0xa27156,_0x3ca003,_0x5c3048):_0x1a6db0(_0xa27156,_0x3ca003))||_0x5c3048;}return _0x20777c>0x3&&_0x5c3048&&Object[_0x5026c5(0x1e8)](_0xa27156,_0x3ca003,_0x5c3048),_0x5c3048;},__metadata=this&&this[_0x9e1ba7(0x1cf)]||function(_0x3c95b8,_0x294ce9){const _0x3b192c=_0x9e1ba7;if(typeof Reflect===_0x3b192c(0x1d3)&&typeof Reflect[_0x3b192c(0x1c9)]===_0x3b192c(0x1d8))return Reflect[_0x3b192c(0x1c9)](_0x3c95b8,_0x294ce9);},__param=this&&this[_0x9e1ba7(0x1d2)]||function(_0x1937a9,_0x47760b){return function(_0x52b4bb,_0x5bcbdc){_0x47760b(_0x52b4bb,_0x5bcbdc,_0x1937a9);};};function _0x2ad1(_0x326d32,_0x99041c){const _0x3e7178=_0x3e71();return _0x2ad1=function(_0x2ad197,_0x5e2b01){_0x2ad197=_0x2ad197-0x1bd;let _0x20a34a=_0x3e7178[_0x2ad197];return _0x20a34a;},_0x2ad1(_0x326d32,_0x99041c);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x9e1ba7(0x1c5)]=void 0x0;const common_1=require(_0x9e1ba7(0x1ca));let RedisCacheService=class RedisCacheService{constructor(_0x341317){const _0x2cd1bf=_0x9e1ba7;this[_0x2cd1bf(0x1e7)]=_0x341317;}async['onModuleInit'](){}[_0x9e1ba7(0x1e9)](){const _0x369ff6=_0x9e1ba7;return this[_0x369ff6(0x1e7)][_0x369ff6(0x1cb)](_0x369ff6(0x1d6),0x6f),0x1;}async[_0x9e1ba7(0x1c2)](_0x6fd160){const _0xe28394=_0x9e1ba7,{key:_0x1f85c3}=_0x6fd160,_0x18fe70=await this[_0xe28394(0x1e7)]['get'](_0x1f85c3);return await this[_0xe28394(0x1e7)]['get'](_0x1f85c3);}async['set'](_0x108b00,_0x15ea69){const _0x4168b8=_0x9e1ba7;try{const {key:_0x1c723f,val:_0x20d091}=_0x108b00;await this[_0x4168b8(0x1e7)][_0x4168b8(0x1cb)](_0x1c723f,_0x20d091),_0x15ea69&&await this[_0x4168b8(0x1e7)]['expire'](_0x1c723f,_0x15ea69);return;}catch(_0x474643){throw new common_1['HttpException'](_0x474643,common_1[_0x4168b8(0x1df)][_0x4168b8(0x1e6)]);}}async[_0x9e1ba7(0x1cc)](_0x252224){const _0x3a2e3=_0x9e1ba7;return await this[_0x3a2e3(0x1e7)][_0x3a2e3(0x1cc)](_0x252224);}async['del'](_0x3783de){const _0x3875a5=_0x9e1ba7,{key:_0x1d30a0}=_0x3783de;await this[_0x3875a5(0x1e7)][_0x3875a5(0x1c6)](_0x1d30a0);return;}async[_0x9e1ba7(0x1e5)](_0x112342,_0x451516){const _0x1ed129=_0x9e1ba7,_0x578b2f=await this[_0x1ed129(0x1e7)][_0x1ed129(0x1ce)]('tokens:'+_0x112342,0x0,-0x1);await this[_0x1ed129(0x1d1)](_0x112342,_0x578b2f),this['redisClient'][_0x1ed129(0x1cb)](_0x1ed129(0x1c8)+_0x112342,_0x451516);}async['invalidateTokens'](_0x5c6c26,_0x536e9e){_0x536e9e['forEach'](_0x27d433=>{const _0x404994=_0x2ad1;this[_0x404994(0x1e7)]['del']('token:'+_0x5c6c26+':'+_0x27d433);});}async['checkTokenAuth'](_0x44310f,_0x13dc55){const _0x28f3d4=_0x9e1ba7,{id:_0x597050,role:_0x2f57e8}=_0x13dc55[_0x28f3d4(0x1da)];if(_0x2f57e8===_0x28f3d4(0x1d4))return!![];const _0x15de85=await this['redisClient'][_0x28f3d4(0x1c2)]('token:'+_0x597050);if(_0x15de85===null)return await this[_0x28f3d4(0x1e7)][_0x28f3d4(0x1cb)](_0x28f3d4(0x1c8)+_0x597050,_0x44310f),!![];if(_0x15de85!==_0x44310f){if([_0x28f3d4(0x1ea),_0x28f3d4(0x1c3)][_0x28f3d4(0x1d5)](_0x2f57e8))return!![];throw new common_1[(_0x28f3d4(0x1de))](_0x28f3d4(0x1c0),common_1['HttpStatus'][_0x28f3d4(0x1d0)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x9e1ba7(0x1dd)])(),__param(0x0,(0x0,common_1['Inject'])(_0x9e1ba7(0x1be))),__metadata(_0x9e1ba7(0x1c7),[Object])],RedisCacheService),exports[_0x9e1ba7(0x1c5)]=RedisCacheService;