'use strict';const _0x25486d=_0x12c2;function _0x12c2(_0x4e64c4,_0x5e3caf){const _0x46a41d=_0x46a4();return _0x12c2=function(_0x12c29a,_0x164ea3){_0x12c29a=_0x12c29a-0x157;let _0x3f66f1=_0x46a41d[_0x12c29a];return _0x3f66f1;},_0x12c2(_0x4e64c4,_0x5e3caf);}function _0x46a4(){const _0x1a4f43=['bcryptjs',']\x20==============>\x20请注意查阅','4oiXkti','isVerifyEmail','public','__decorate','registerSendStatus','firstRregisterSendModel3Count','1800','invitedGuestSendDrawMjCount','registerVerifyEmailFrom','初始化创建','default@cooper.com','typeorm','configVal','length','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','inviteGiveSendModel4Count','checkSiteBaseConfig','Yi\x20Ai','HttpStatus','firstRregisterSendDrawMjCount','创建默认超级管理员失败！','baiduToken','\x0a####\x20YiAi\x20欢迎您\x0a\x20-\x20欢迎使用YiAi\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','registerVerifyEmailDesc','onModuleInit','inviteGiveSendDrawMjCount','Injectable','registerFailEmailTeamName','hashSync','registerSendDrawMjCount','join','connection','4069460pqufJM','defineProperty','HttpException','function',',请妥善保管您的账号，祝您使用愉快','metadata','baiduCode','2205738kQBXCh','DatabaseService','object','defaultAdmin@cooper.com','12373JkABDi','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','log','admin','siteName',']、初始密码为[','noticeInfo','https://api.openai.com','getOwnPropertyDescriptor','5310263ZlfCfw','500','createDefaultUser','\x27,\x200,\x201000,\x20100)','buyCramiAddress','HelloWordYi819','inviteGiveSendModel3Count','userDefautlAvatar','用户成功、用户名为[','firstRegisterSendStatus','createBaseSiteConfig','firstRregisterSendModel4Count','registerFailEmailTitle','qqNumber','欢迎使用Yi\x20Ai团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','baiduSiteId','robotAvatar','error:\x20','\x27,\x20\x27','checkSuperAdmin','Yi\x20Ai团队','Yi\x20Ai账号激活成功','registerSendModel3Count','registerSuccessEmailTitle','query','invitedGuestSendModel4Count','super','Logger','design:paramtypes','registerSuccessEmaileAppend','805239273','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','Yi\x20Ai账号激活失败','6807848IGiEix','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','registerSendModel4Count','registerVerifyExpir','map','INTERNAL_SERVER_ERROR','firstRegisterSendRank','123456','Connection','18htOjRz','5332254MAyBNQ','nine-super','__esModule','2815767XNuYyK','vxNumber'];_0x46a4=function(){return _0x1a4f43;};return _0x46a4();}(function(_0x178bff,_0x5a9df2){const _0x151b5e=_0x12c2,_0x16d403=_0x178bff();while(!![]){try{const _0x58afae=-parseInt(_0x151b5e(0x191))/0x1+-parseInt(_0x151b5e(0x18d))/0x2+parseInt(_0x151b5e(0x162))/0x3+-parseInt(_0x151b5e(0x166))/0x4*(-parseInt(_0x151b5e(0x186))/0x5)+parseInt(_0x151b5e(0x15f))/0x6+parseInt(_0x151b5e(0x19a))/0x7+-parseInt(_0x151b5e(0x1bb))/0x8*(parseInt(_0x151b5e(0x15e))/0x9);if(_0x58afae===_0x5a9df2)break;else _0x16d403['push'](_0x16d403['shift']());}catch(_0x41f306){_0x16d403['push'](_0x16d403['shift']());}}}(_0x46a4,0x8e3c3));var __decorate=this&&this[_0x25486d(0x169)]||function(_0x421ecb,_0x32f9d2,_0x57285c,_0x201155){const _0x27efbb=_0x25486d;var _0x1d4fea=arguments[_0x27efbb(0x173)],_0x2dc8fd=_0x1d4fea<0x3?_0x32f9d2:_0x201155===null?_0x201155=Object[_0x27efbb(0x199)](_0x32f9d2,_0x57285c):_0x201155,_0x9d1bfe;if(typeof Reflect===_0x27efbb(0x18f)&&typeof Reflect['decorate']===_0x27efbb(0x189))_0x2dc8fd=Reflect['decorate'](_0x421ecb,_0x32f9d2,_0x57285c,_0x201155);else{for(var _0x3da38f=_0x421ecb[_0x27efbb(0x173)]-0x1;_0x3da38f>=0x0;_0x3da38f--)if(_0x9d1bfe=_0x421ecb[_0x3da38f])_0x2dc8fd=(_0x1d4fea<0x3?_0x9d1bfe(_0x2dc8fd):_0x1d4fea>0x3?_0x9d1bfe(_0x32f9d2,_0x57285c,_0x2dc8fd):_0x9d1bfe(_0x32f9d2,_0x57285c))||_0x2dc8fd;}return _0x1d4fea>0x3&&_0x2dc8fd&&Object[_0x27efbb(0x187)](_0x32f9d2,_0x57285c,_0x2dc8fd),_0x2dc8fd;},__metadata=this&&this['__metadata']||function(_0x2ec389,_0x4cfdbe){const _0x5b0f74=_0x25486d;if(typeof Reflect===_0x5b0f74(0x18f)&&typeof Reflect[_0x5b0f74(0x18b)]===_0x5b0f74(0x189))return Reflect[_0x5b0f74(0x18b)](_0x2ec389,_0x4cfdbe);};Object[_0x25486d(0x187)](exports,_0x25486d(0x161),{'value':!![]}),exports[_0x25486d(0x18e)]=void 0x0;const common_1=require('@nestjs/common'),typeorm_1=require(_0x25486d(0x171)),bcrypt=require(_0x25486d(0x164));let DatabaseService=class DatabaseService{constructor(_0x14a5ee){const _0x58c5f7=_0x25486d;this[_0x58c5f7(0x185)]=_0x14a5ee;}async[_0x25486d(0x17e)](){const _0x10e4a1=_0x25486d;await this[_0x10e4a1(0x1ad)](),await this[_0x10e4a1(0x176)]();}async[_0x25486d(0x1ad)](){const _0x5965a2=_0x25486d,_0x5b9522=await this[_0x5965a2(0x185)][_0x5965a2(0x1b2)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27');if(!_0x5b9522||_0x5b9522['length']===0x0){const _0x5264da=bcrypt['hashSync'](_0x5965a2(0x15c),0xa),_0x547db0=bcrypt[_0x5965a2(0x182)](_0x5965a2(0x15c),0xa),_0x31a409=_0x5965a2(0x170),_0x35a32d=_0x5965a2(0x190),_0x58ce9d={'username':_0x5965a2(0x1b4),'password':_0x5264da,'status':0x1,'email':_0x31a409,'sex':0x1,'role':_0x5965a2(0x1b4)},_0x230e65={'username':'admin','password':_0x547db0,'status':0x1,'email':_0x35a32d,'sex':0x1,'role':_0x5965a2(0x194)};await this[_0x5965a2(0x19c)](_0x58ce9d),await this[_0x5965a2(0x19c)](_0x230e65);}}async[_0x25486d(0x19c)](_0x113abd){const _0x5a3156=_0x25486d;try{const {username:_0x5e4f16,password:_0x5f31c1,status:_0x30896b,email:_0x2377d3,role:_0x1e8765}=_0x113abd,_0x2eab4d=await this[_0x5a3156(0x185)][_0x5a3156(0x1b2)](_0x5a3156(0x1b9)+_0x5e4f16+_0x5a3156(0x1ac)+_0x5f31c1+_0x5a3156(0x1ac)+_0x30896b+'\x27,\x20\x27'+_0x2377d3+_0x5a3156(0x1ac)+_0x1e8765+'\x27)'),_0xe11751=_0x2eab4d['insertId'],_0x538a1f=await this[_0x5a3156(0x185)][_0x5a3156(0x1b2)](_0x5a3156(0x192)+_0xe11751+_0x5a3156(0x19d));common_1[_0x5a3156(0x1b5)][_0x5a3156(0x193)](_0x5a3156(0x16f)+_0x1e8765+_0x5a3156(0x1a2)+_0x5e4f16+_0x5a3156(0x196)+(_0x5e4f16===_0x5a3156(0x1b4)?_0x5a3156(0x160):_0x5a3156(0x15c))+_0x5a3156(0x165),_0x5a3156(0x18e));}catch(_0x48f126){console[_0x5a3156(0x193)](_0x5a3156(0x1ab),_0x48f126);throw new common_1['HttpException'](_0x5a3156(0x17a),common_1['HttpStatus'][_0x5a3156(0x15a)]);}}async['checkSiteBaseConfig'](){const _0x35a4fa=_0x25486d,_0x1cdf70=['siteName',_0x35a4fa(0x1a7),_0x35a4fa(0x163),_0x35a4fa(0x1aa),_0x35a4fa(0x1a1)],_0x51afb6=await this[_0x35a4fa(0x185)]['query'](_0x35a4fa(0x1bc)+_0x1cdf70['map'](_0x5d834b=>'\x27'+_0x5d834b+'\x27')[_0x35a4fa(0x184)](',')+')\x0a'),_0x4a65b8=parseInt(_0x51afb6[0x0]['count']);_0x4a65b8===0x0&&await this[_0x35a4fa(0x1a4)]();}async[_0x25486d(0x1a4)](){const _0x160003=_0x25486d;try{const _0x3ee3e6='',_0x1b54bc=_0x160003(0x17c),_0x3de968=[{'configKey':_0x160003(0x195),'configVal':_0x160003(0x177),'public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a7),'configVal':_0x160003(0x1b8),'public':0x1,'encry':0x0},{'configKey':'vxNumber','configVal':_0x160003(0x19f),'public':0x1,'encry':0x0},{'configKey':_0x160003(0x1aa),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a1),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x160003(0x18c),'configVal':_0x3ee3e6,'public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a9),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x160003(0x17b),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x160003(0x19e),'configVal':'','public':0x1,'encry':0x0},{'configKey':'openaiBaseUrl','configVal':_0x160003(0x198),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x197),'configVal':_0x1b54bc,'public':0x1,'encry':0x0},{'configKey':'registerVerifyEmailTitle','configVal':'Yi\x20Ai团队账号验证','public':0x0,'encry':0x0},{'configKey':_0x160003(0x17d),'configVal':_0x160003(0x1a8),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x16e),'configVal':'Yi\x20Ai团队','public':0x0,'encry':0x0},{'configKey':_0x160003(0x158),'configVal':_0x160003(0x16c),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x1b1),'configVal':_0x160003(0x1af),'public':0x0,'encry':0x0},{'configKey':'registerSuccessEmailTeamName','configVal':_0x160003(0x177),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x1b7),'configVal':_0x160003(0x18a),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x1a6),'configVal':_0x160003(0x1ba),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x181),'configVal':_0x160003(0x1ae),'public':0x0,'encry':0x0},{'configKey':_0x160003(0x16a),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1b0),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x160003(0x157),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x160003(0x183),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a3),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x160003(0x15b),'configVal':_0x160003(0x19b),'public':0x1,'encry':0x0},{'configKey':_0x160003(0x16b),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a5),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x160003(0x179),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'inviteSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1a0),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x160003(0x175),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x160003(0x17f),'configVal':'0','public':0x1,'encry':0x0},{'configKey':'invitedGuestSendModel3Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x160003(0x1b3),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x160003(0x16d),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x160003(0x167),'configVal':'1','public':0x1,'encry':0x0}],_0x4d3b0d=await this['connection']['query']('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x3de968[_0x160003(0x159)](_0x57f461=>'(\x27'+_0x57f461['configKey']+'\x27,\x20\x27'+_0x57f461[_0x160003(0x172)]['replace'](/'/g,'\x5c\x27')+_0x160003(0x1ac)+_0x57f461[_0x160003(0x168)]+'\x27,\x20\x27'+_0x57f461['encry']+'\x27)')[_0x160003(0x184)](',\x20'));common_1[_0x160003(0x1b5)][_0x160003(0x193)](_0x160003(0x174),_0x160003(0x18e));}catch(_0xd723f0){console[_0x160003(0x193)](_0x160003(0x1ab),_0xd723f0);throw new common_1[(_0x160003(0x188))]('创建默认网站配置失败！',common_1[_0x160003(0x178)][_0x160003(0x15a)]);}}};DatabaseService=__decorate([(0x0,common_1[_0x25486d(0x180)])(),__metadata(_0x25486d(0x1b6),[typeorm_1[_0x25486d(0x15d)]])],DatabaseService),exports[_0x25486d(0x18e)]=DatabaseService;