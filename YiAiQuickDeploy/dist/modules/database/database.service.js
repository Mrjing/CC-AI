'use strict';const _0xd7a8a6=_0x472c;(function(_0x22eb50,_0x3e052c){const _0xc95b4f=_0x472c,_0xef07a1=_0x22eb50();while(!![]){try{const _0x1c18f1=parseInt(_0xc95b4f(0xaa))/0x1*(parseInt(_0xc95b4f(0x85))/0x2)+-parseInt(_0xc95b4f(0xd6))/0x3*(parseInt(_0xc95b4f(0xae))/0x4)+-parseInt(_0xc95b4f(0xa5))/0x5*(-parseInt(_0xc95b4f(0x9e))/0x6)+parseInt(_0xc95b4f(0x84))/0x7+-parseInt(_0xc95b4f(0xb9))/0x8*(parseInt(_0xc95b4f(0xb8))/0x9)+parseInt(_0xc95b4f(0xa7))/0xa+parseInt(_0xc95b4f(0xbf))/0xb*(-parseInt(_0xc95b4f(0xd8))/0xc);if(_0x1c18f1===_0x3e052c)break;else _0xef07a1['push'](_0xef07a1['shift']());}catch(_0x8d1e6f){_0xef07a1['push'](_0xef07a1['shift']());}}}(_0x4744,0x48ab2));var __decorate=this&&this[_0xd7a8a6(0x87)]||function(_0x4f5193,_0xf5e4df,_0xbd3e6c,_0x2e68ce){const _0x2cf6da=_0xd7a8a6;var _0x10c6d6=arguments[_0x2cf6da(0xbb)],_0x57ea3f=_0x10c6d6<0x3?_0xf5e4df:_0x2e68ce===null?_0x2e68ce=Object['getOwnPropertyDescriptor'](_0xf5e4df,_0xbd3e6c):_0x2e68ce,_0x26d5d9;if(typeof Reflect===_0x2cf6da(0xc9)&&typeof Reflect[_0x2cf6da(0xd0)]===_0x2cf6da(0x8f))_0x57ea3f=Reflect[_0x2cf6da(0xd0)](_0x4f5193,_0xf5e4df,_0xbd3e6c,_0x2e68ce);else{for(var _0x599d38=_0x4f5193[_0x2cf6da(0xbb)]-0x1;_0x599d38>=0x0;_0x599d38--)if(_0x26d5d9=_0x4f5193[_0x599d38])_0x57ea3f=(_0x10c6d6<0x3?_0x26d5d9(_0x57ea3f):_0x10c6d6>0x3?_0x26d5d9(_0xf5e4df,_0xbd3e6c,_0x57ea3f):_0x26d5d9(_0xf5e4df,_0xbd3e6c))||_0x57ea3f;}return _0x10c6d6>0x3&&_0x57ea3f&&Object[_0x2cf6da(0x8c)](_0xf5e4df,_0xbd3e6c,_0x57ea3f),_0x57ea3f;},__metadata=this&&this[_0xd7a8a6(0xad)]||function(_0x14aac4,_0x210fdb){const _0x27f759=_0xd7a8a6;if(typeof Reflect===_0x27f759(0xc9)&&typeof Reflect[_0x27f759(0x94)]==='function')return Reflect['metadata'](_0x14aac4,_0x210fdb);};Object[_0xd7a8a6(0x8c)](exports,'__esModule',{'value':!![]}),exports[_0xd7a8a6(0xd5)]=void 0x0;const common_1=require(_0xd7a8a6(0xaf)),typeorm_1=require(_0xd7a8a6(0xc8)),bcrypt=require(_0xd7a8a6(0xa9));function _0x472c(_0x7e1ead,_0x11a755){const _0x47442e=_0x4744();return _0x472c=function(_0x472c36,_0x2a0ca0){_0x472c36=_0x472c36-0x7f;let _0x2422ca=_0x47442e[_0x472c36];return _0x2422ca;},_0x472c(_0x7e1ead,_0x11a755);}let DatabaseService=class DatabaseService{constructor(_0x58cf0e){const _0x37b517=_0xd7a8a6;this[_0x37b517(0xcd)]=_0x58cf0e;}async['onModuleInit'](){const _0x2f5184=_0xd7a8a6;await this[_0x2f5184(0x9d)](),await this[_0x2f5184(0x9a)]();}async[_0xd7a8a6(0x9d)](){const _0x37a1c0=_0xd7a8a6,_0x4c0925=await this[_0x37a1c0(0xcd)][_0x37a1c0(0x8e)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27');if(!_0x4c0925||_0x4c0925[_0x37a1c0(0xbb)]===0x0){const _0x1008f4=bcrypt[_0x37a1c0(0x97)](_0x37a1c0(0x81),0xa),_0x4038bc=bcrypt[_0x37a1c0(0x97)]('123456',0xa),_0xbef1b5='default@cooper.com',_0x39839f=_0x37a1c0(0xbc),_0x3cd8bb={'username':_0x37a1c0(0xb6),'password':_0x1008f4,'status':0x1,'email':_0xbef1b5,'sex':0x1,'role':_0x37a1c0(0xb6)},_0x466707={'username':_0x37a1c0(0xcb),'password':_0x4038bc,'status':0x1,'email':_0x39839f,'sex':0x1,'role':_0x37a1c0(0xcb)};await this[_0x37a1c0(0xc4)](_0x3cd8bb),await this[_0x37a1c0(0xc4)](_0x466707);}}async['createDefaultUser'](_0x4545a7){const _0x2c4799=_0xd7a8a6;try{const {username:_0x417b04,password:_0x43a1c3,status:_0x549c70,email:_0x57e202,role:_0x229a78}=_0x4545a7,_0x34d1f4=await this[_0x2c4799(0xcd)][_0x2c4799(0x8e)](_0x2c4799(0x86)+_0x417b04+'\x27,\x20\x27'+_0x43a1c3+'\x27,\x20\x27'+_0x549c70+'\x27,\x20\x27'+_0x57e202+_0x2c4799(0xdb)+_0x229a78+'\x27)'),_0xdb1f05=_0x34d1f4[_0x2c4799(0xa1)],_0x3fd0c1=await this[_0x2c4799(0xcd)]['query']('INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27'+_0xdb1f05+_0x2c4799(0xcf));common_1['Logger'][_0x2c4799(0xd7)]('初始化创建'+_0x229a78+'用户成功、用户名为['+_0x417b04+']、初始密码为['+(_0x417b04==='super'?_0x2c4799(0x80):_0x2c4799(0x81))+_0x2c4799(0xab),_0x2c4799(0xd5));}catch(_0x1fe16c){console[_0x2c4799(0xd7)](_0x2c4799(0xa8),_0x1fe16c);throw new common_1[(_0x2c4799(0xc1))](_0x2c4799(0x7f),common_1[_0x2c4799(0xd2)]['INTERNAL_SERVER_ERROR']);}}async['checkSiteBaseConfig'](){const _0x2da7e1=_0xd7a8a6,_0x1e8542=[_0x2da7e1(0xa0),_0x2da7e1(0x99),_0x2da7e1(0xa3),_0x2da7e1(0xd3),'userDefautlAvatar'],_0x2d1d25=await this[_0x2da7e1(0xcd)][_0x2da7e1(0x8e)](_0x2da7e1(0xb3)+_0x1e8542['map'](_0x36eb19=>'\x27'+_0x36eb19+'\x27')['join'](',')+')\x0a'),_0x51df28=parseInt(_0x2d1d25[0x0][_0x2da7e1(0xce)]);_0x51df28===0x0&&await this['createBaseSiteConfig']();}async['createBaseSiteConfig'](){const _0x33d2c5=_0xd7a8a6;try{const _0xd0eb3c='',_0x29e2aa='\x0a####\x20YiAi\x20欢迎您\x0a\x20-\x20欢迎使用YiAi\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a',_0x25ab9d=[{'configKey':_0x33d2c5(0xa0),'configVal':_0x33d2c5(0xa4),'public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x99),'configVal':'805239273','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xa3),'configVal':_0x33d2c5(0x89),'public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xd3),'configVal':'','public':0x1,'encry':0x0},{'configKey':'userDefautlAvatar','configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x82),'configVal':_0xd0eb3c,'public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x9c),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x88),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x9b),'configVal':'','public':0x1,'encry':0x0},{'configKey':'openaiBaseUrl','configVal':'https://api.openai.com','public':0x0,'encry':0x0},{'configKey':'noticeInfo','configVal':_0x29e2aa,'public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xac),'configVal':_0x33d2c5(0xbd),'public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0xa6),'configVal':_0x33d2c5(0xb0),'public':0x0,'encry':0x0},{'configKey':'registerVerifyEmailFrom','configVal':_0x33d2c5(0xdc),'public':0x0,'encry':0x0},{'configKey':'registerVerifyExpir','configVal':_0x33d2c5(0xb5),'public':0x0,'encry':0x0},{'configKey':'registerSuccessEmailTitle','configVal':_0x33d2c5(0x8a),'public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0xb7),'configVal':_0x33d2c5(0xa4),'public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0xde),'configVal':_0x33d2c5(0x83),'public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x92),'configVal':_0x33d2c5(0xc7),'public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x9f),'configVal':'Yi\x20Ai团队','public':0x0,'encry':0x0},{'configKey':_0x33d2c5(0x8d),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xa2),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xc3),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xc6),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x96),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xc0),'configVal':_0x33d2c5(0x98),'public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xb1),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel4Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xba),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xc2),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x93),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xc5),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x91),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x90),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0x95),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d2c5(0xb4),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'isVerifyEmail','configVal':'1','public':0x1,'encry':0x0}],_0x23c2a4=await this[_0x33d2c5(0xcd)][_0x33d2c5(0x8e)]('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x25ab9d[_0x33d2c5(0xbe)](_0x2b1865=>'(\x27'+_0x2b1865[_0x33d2c5(0xd9)]+_0x33d2c5(0xdb)+_0x2b1865[_0x33d2c5(0xb2)]['replace'](/'/g,'\x5c\x27')+_0x33d2c5(0xdb)+_0x2b1865[_0x33d2c5(0xcc)]+'\x27,\x20\x27'+_0x2b1865[_0x33d2c5(0xd4)]+'\x27)')[_0x33d2c5(0xda)](',\x20'));common_1['Logger']['log']('初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅',_0x33d2c5(0xd5));}catch(_0x15b9d7){console['log']('error:\x20',_0x15b9d7);throw new common_1[(_0x33d2c5(0xc1))](_0x33d2c5(0xca),common_1['HttpStatus'][_0x33d2c5(0xd1)]);}}};DatabaseService=__decorate([(0x0,common_1[_0xd7a8a6(0x8b)])(),__metadata(_0xd7a8a6(0xdd),[typeorm_1['Connection']])],DatabaseService),exports[_0xd7a8a6(0xd5)]=DatabaseService;function _0x4744(){const _0x3dd5e2=['1143474EOabpp','log','98232ErirZM','configKey','join','\x27,\x20\x27','Yi\x20Ai团队','design:paramtypes','registerSuccessEmaileAppend','创建默认超级管理员失败！','nine-super','123456','baiduCode',',请妥善保管您的账号，祝您使用愉快','1003982SEsosT','538160jnODZR','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','__decorate','baiduToken','HelloWordYi819','Yi\x20Ai账号激活成功','Injectable','defineProperty','registerSendStatus','query','function','invitedGuestSendModel3Count','inviteGiveSendDrawMjCount','registerFailEmailTitle','inviteGiveSendModel3Count','metadata','invitedGuestSendModel4Count','firstRegisterSendStatus','hashSync','500','qqNumber','checkSiteBaseConfig','buyCramiAddress','baiduSiteId','checkSuperAdmin','660InEYrY','registerFailEmailTeamName','siteName','insertId','registerSendModel3Count','vxNumber','Yi\x20Ai','19630lItURL','registerVerifyEmailDesc','161120YfjsnV','error:\x20','bcryptjs','1knOlaK',']\x20==============>\x20请注意查阅','registerVerifyEmailTitle','__metadata','4JUStVn','@nestjs/common','欢迎使用Yi\x20Ai团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','firstRregisterSendModel3Count','configVal','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','invitedGuestSendDrawMjCount','1800','super','registerSuccessEmailTeamName','522819LNYgEC','16WCiqpK','firstRregisterSendDrawMjCount','length','defaultAdmin@cooper.com','Yi\x20Ai团队账号验证','map','88ueREkC','firstRegisterSendRank','HttpException','inviteSendStatus','registerSendModel4Count','createDefaultUser','inviteGiveSendModel4Count','registerSendDrawMjCount','Yi\x20Ai账号激活失败','typeorm','object','创建默认网站配置失败！','admin','public','connection','count','\x27,\x200,\x201000,\x20100)','decorate','INTERNAL_SERVER_ERROR','HttpStatus','robotAvatar','encry','DatabaseService'];_0x4744=function(){return _0x3dd5e2;};return _0x4744();}