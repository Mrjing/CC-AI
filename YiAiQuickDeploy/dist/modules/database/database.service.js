'use strict';const _0x458e73=_0x372a;function _0x222a(){const _0x17db08=['439566dTteoG','baiduSiteId','18884PVBiwC','\x27,\x20\x27','buyCramiAddress','1800','inviteGiveSendDrawMjCount','hashSync','firstRregisterSendModel3Count','5ZKkVcZ','创建默认网站配置失败！','invitedGuestSendModel3Count','Yi\x20Ai账号激活失败','Logger','length','connection','openaiBaseUrl','nine-super','defaultAdmin@cooper.com','用户成功、用户名为[','configVal','vxNumber','registerSendModel3Count','function','欢迎使用Yi\x20Ai团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','1129248qAXPGf','__metadata','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','inviteGiveSendModel4Count','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','Yi\x20Ai账号激活成功','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','236574KwCDWk','configKey','firstRegisterSendStatus','423507ITwvVh','123456','HttpStatus','500','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27',']、初始密码为[','904620CdrbBa','noticeInfo','@nestjs/common','map','super','userDefautlAvatar','robotAvatar','firstRegisterSendRank','replace','__decorate','createBaseSiteConfig','registerVerifyEmailDesc','registerSuccessEmailTitle','object','创建默认超级管理员失败！','7ALXsNP','query','Yi\x20Ai','admin','firstRregisterSendDrawMjCount','registerVerifyEmailTitle','encry','Yi\x20Ai团队','metadata','registerSuccessEmaileAppend','HttpException','log','registerSendModel4Count','INTERNAL_SERVER_ERROR','count','createDefaultUser','qqNumber','baiduToken','decorate','registerSuccessEmailTeamName','DatabaseService','typeorm','siteName','checkSiteBaseConfig','error:\x20','design:paramtypes','4760yzmOMT','11412aRxpvG','checkSuperAdmin','firstRregisterSendModel4Count','805239273','Injectable','join','\x27,\x200,\x201000,\x20100)','inviteSendStatus','registerFailEmailTeamName','defineProperty'];_0x222a=function(){return _0x17db08;};return _0x222a();}(function(_0x530bfd,_0x4b253a){const _0x44284b=_0x372a,_0x2e9ec9=_0x530bfd();while(!![]){try{const _0x58491e=-parseInt(_0x44284b(0x150))/0x1+parseInt(_0x44284b(0x111))/0x2+-parseInt(_0x44284b(0x114))/0x3+parseInt(_0x44284b(0x11a))/0x4*(-parseInt(_0x44284b(0x157))/0x5)+parseInt(_0x44284b(0x14e))/0x6*(-parseInt(_0x44284b(0x129))/0x7)+-parseInt(_0x44284b(0x167))/0x8+parseInt(_0x44284b(0x144))/0x9*(parseInt(_0x44284b(0x143))/0xa);if(_0x58491e===_0x4b253a)break;else _0x2e9ec9['push'](_0x2e9ec9['shift']());}catch(_0x340ade){_0x2e9ec9['push'](_0x2e9ec9['shift']());}}}(_0x222a,0x1d98e));function _0x372a(_0x3c2c40,_0x5df238){const _0x222acf=_0x222a();return _0x372a=function(_0x372afb,_0x3cf839){_0x372afb=_0x372afb-0x10b;let _0x240bd6=_0x222acf[_0x372afb];return _0x240bd6;},_0x372a(_0x3c2c40,_0x5df238);}var __decorate=this&&this[_0x458e73(0x123)]||function(_0x5da3f,_0x18a833,_0x3590ae,_0x73c246){const _0x5dd305=_0x458e73;var _0xa4054e=arguments[_0x5dd305(0x15c)],_0x1ee2cb=_0xa4054e<0x3?_0x18a833:_0x73c246===null?_0x73c246=Object['getOwnPropertyDescriptor'](_0x18a833,_0x3590ae):_0x73c246,_0x1accfe;if(typeof Reflect==='object'&&typeof Reflect[_0x5dd305(0x13b)]==='function')_0x1ee2cb=Reflect[_0x5dd305(0x13b)](_0x5da3f,_0x18a833,_0x3590ae,_0x73c246);else{for(var _0x4ef11c=_0x5da3f[_0x5dd305(0x15c)]-0x1;_0x4ef11c>=0x0;_0x4ef11c--)if(_0x1accfe=_0x5da3f[_0x4ef11c])_0x1ee2cb=(_0xa4054e<0x3?_0x1accfe(_0x1ee2cb):_0xa4054e>0x3?_0x1accfe(_0x18a833,_0x3590ae,_0x1ee2cb):_0x1accfe(_0x18a833,_0x3590ae))||_0x1ee2cb;}return _0xa4054e>0x3&&_0x1ee2cb&&Object[_0x5dd305(0x14d)](_0x18a833,_0x3590ae,_0x1ee2cb),_0x1ee2cb;},__metadata=this&&this[_0x458e73(0x10b)]||function(_0x3fc7d4,_0x2d38b7){const _0x4d022b=_0x458e73;if(typeof Reflect===_0x4d022b(0x127)&&typeof Reflect[_0x4d022b(0x131)]===_0x4d022b(0x165))return Reflect[_0x4d022b(0x131)](_0x3fc7d4,_0x2d38b7);};Object[_0x458e73(0x14d)](exports,'__esModule',{'value':!![]}),exports[_0x458e73(0x13d)]=void 0x0;const common_1=require(_0x458e73(0x11c)),typeorm_1=require(_0x458e73(0x13e)),bcrypt=require('bcryptjs');let DatabaseService=class DatabaseService{constructor(_0x211d07){const _0x218069=_0x458e73;this[_0x218069(0x15d)]=_0x211d07;}async['onModuleInit'](){const _0x229c63=_0x458e73;await this['checkSuperAdmin'](),await this[_0x229c63(0x140)]();}async[_0x458e73(0x145)](){const _0x535ce2=_0x458e73,_0x3338a9=await this[_0x535ce2(0x15d)][_0x535ce2(0x12a)](_0x535ce2(0x118));if(!_0x3338a9||_0x3338a9[_0x535ce2(0x15c)]===0x0){const _0x4bcb09=bcrypt[_0x535ce2(0x155)](_0x535ce2(0x115),0xa),_0x69bcff=bcrypt[_0x535ce2(0x155)](_0x535ce2(0x115),0xa),_0x1026ff='default@cooper.com',_0x191d8d=_0x535ce2(0x160),_0x53a116={'username':'super','password':_0x4bcb09,'status':0x1,'email':_0x1026ff,'sex':0x1,'role':_0x535ce2(0x11e)},_0x5b53da={'username':_0x535ce2(0x12c),'password':_0x69bcff,'status':0x1,'email':_0x191d8d,'sex':0x1,'role':_0x535ce2(0x12c)};await this[_0x535ce2(0x138)](_0x53a116),await this[_0x535ce2(0x138)](_0x5b53da);}}async[_0x458e73(0x138)](_0xecbdc9){const _0x9fa254=_0x458e73;try{const {username:_0xf30b03,password:_0x4c3a7e,status:_0x5b345b,email:_0x556214,role:_0x23589e}=_0xecbdc9,_0x1a924a=await this[_0x9fa254(0x15d)][_0x9fa254(0x12a)]('INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27'+_0xf30b03+_0x9fa254(0x151)+_0x4c3a7e+_0x9fa254(0x151)+_0x5b345b+_0x9fa254(0x151)+_0x556214+'\x27,\x20\x27'+_0x23589e+'\x27)'),_0x4d0ee6=_0x1a924a['insertId'],_0x938cae=await this[_0x9fa254(0x15d)][_0x9fa254(0x12a)](_0x9fa254(0x10c)+_0x4d0ee6+_0x9fa254(0x14a));common_1[_0x9fa254(0x15b)][_0x9fa254(0x134)]('初始化创建'+_0x23589e+_0x9fa254(0x161)+_0xf30b03+_0x9fa254(0x119)+(_0xf30b03===_0x9fa254(0x11e)?_0x9fa254(0x15f):_0x9fa254(0x115))+']\x20==============>\x20请注意查阅',_0x9fa254(0x13d));}catch(_0x385831){console['log'](_0x9fa254(0x141),_0x385831);throw new common_1['HttpException'](_0x9fa254(0x128),common_1[_0x9fa254(0x116)][_0x9fa254(0x136)]);}}async[_0x458e73(0x140)](){const _0x2680df=_0x458e73,_0x57dc18=[_0x2680df(0x13f),_0x2680df(0x139),_0x2680df(0x163),_0x2680df(0x120),_0x2680df(0x11f)],_0x4bbb3c=await this['connection']['query'](_0x2680df(0x10e)+_0x57dc18[_0x2680df(0x11d)](_0x4ce74d=>'\x27'+_0x4ce74d+'\x27')[_0x2680df(0x149)](',')+')\x0a'),_0x3552b8=parseInt(_0x4bbb3c[0x0][_0x2680df(0x137)]);_0x3552b8===0x0&&await this[_0x2680df(0x124)]();}async['createBaseSiteConfig'](){const _0x483b6e=_0x458e73;try{const _0x1b9d7a='',_0x504265='\x0a####\x20YiAi\x20欢迎您\x0a\x20-\x20欢迎使用YiAi\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a',_0x480aef=[{'configKey':'siteName','configVal':_0x483b6e(0x12b),'public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x139),'configVal':_0x483b6e(0x147),'public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x163),'configVal':'HelloWordYi819','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x120),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x11f),'configVal':'','public':0x0,'encry':0x0},{'configKey':'baiduCode','configVal':_0x1b9d7a,'public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x14f),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x13a),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x152),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x15e),'configVal':'https://api.openai.com','public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x11b),'configVal':_0x504265,'public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x12e),'configVal':'Yi\x20Ai团队账号验证','public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x125),'configVal':_0x483b6e(0x166),'public':0x0,'encry':0x0},{'configKey':'registerVerifyEmailFrom','configVal':_0x483b6e(0x130),'public':0x0,'encry':0x0},{'configKey':'registerVerifyExpir','configVal':_0x483b6e(0x153),'public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x126),'configVal':_0x483b6e(0x10f),'public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x13c),'configVal':'Yi\x20Ai','public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x132),'configVal':',请妥善保管您的账号，祝您使用愉快','public':0x0,'encry':0x0},{'configKey':'registerFailEmailTitle','configVal':_0x483b6e(0x15a),'public':0x0,'encry':0x0},{'configKey':_0x483b6e(0x14c),'configVal':_0x483b6e(0x130),'public':0x0,'encry':0x0},{'configKey':'registerSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x164),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x135),'configVal':'3','public':0x1,'encry':0x0},{'configKey':'registerSendDrawMjCount','configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x113),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x121),'configVal':_0x483b6e(0x117),'public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x156),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x146),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x12d),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x14b),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'inviteGiveSendModel3Count','configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x10d),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x154),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x483b6e(0x159),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'invitedGuestSendModel4Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':'invitedGuestSendDrawMjCount','configVal':'10','public':0x1,'encry':0x0},{'configKey':'isVerifyEmail','configVal':'1','public':0x1,'encry':0x0}],_0x15c15d=await this[_0x483b6e(0x15d)][_0x483b6e(0x12a)](_0x483b6e(0x110)+_0x480aef[_0x483b6e(0x11d)](_0x5c56be=>'(\x27'+_0x5c56be[_0x483b6e(0x112)]+_0x483b6e(0x151)+_0x5c56be[_0x483b6e(0x162)][_0x483b6e(0x122)](/'/g,'\x5c\x27')+_0x483b6e(0x151)+_0x5c56be['public']+_0x483b6e(0x151)+_0x5c56be[_0x483b6e(0x12f)]+'\x27)')[_0x483b6e(0x149)](',\x20'));common_1['Logger'][_0x483b6e(0x134)]('初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','DatabaseService');}catch(_0x407497){console[_0x483b6e(0x134)](_0x483b6e(0x141),_0x407497);throw new common_1[(_0x483b6e(0x133))](_0x483b6e(0x158),common_1[_0x483b6e(0x116)][_0x483b6e(0x136)]);}}};DatabaseService=__decorate([(0x0,common_1[_0x458e73(0x148)])(),__metadata(_0x458e73(0x142),[typeorm_1['Connection']])],DatabaseService),exports[_0x458e73(0x13d)]=DatabaseService;