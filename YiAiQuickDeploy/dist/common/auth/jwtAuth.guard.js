'use strict';const _0x293824=_0x47b5;(function(_0x36aefe,_0x252015){const _0x481495=_0x47b5,_0x4385cc=_0x36aefe();while(!![]){try{const _0x2c2121=parseInt(_0x481495(0x83))/0x1*(-parseInt(_0x481495(0x7b))/0x2)+-parseInt(_0x481495(0x79))/0x3*(-parseInt(_0x481495(0x6e))/0x4)+parseInt(_0x481495(0x81))/0x5*(parseInt(_0x481495(0x71))/0x6)+-parseInt(_0x481495(0x74))/0x7+-parseInt(_0x481495(0x7f))/0x8+parseInt(_0x481495(0xa5))/0x9*(-parseInt(_0x481495(0x89))/0xa)+parseInt(_0x481495(0x8a))/0xb;if(_0x2c2121===_0x252015)break;else _0x4385cc['push'](_0x4385cc['shift']());}catch(_0x48c2ad){_0x4385cc['push'](_0x4385cc['shift']());}}}(_0x4cf1,0x74e46));var __decorate=this&&this[_0x293824(0x6c)]||function(_0x272391,_0x3b8610,_0x396774,_0x3b1262){const _0x5e2589=_0x293824;var _0xbbe539=arguments[_0x5e2589(0x78)],_0x3552ab=_0xbbe539<0x3?_0x3b8610:_0x3b1262===null?_0x3b1262=Object[_0x5e2589(0x86)](_0x3b8610,_0x396774):_0x3b1262,_0x2f8394;if(typeof Reflect===_0x5e2589(0x9b)&&typeof Reflect[_0x5e2589(0x7d)]===_0x5e2589(0xa3))_0x3552ab=Reflect[_0x5e2589(0x7d)](_0x272391,_0x3b8610,_0x396774,_0x3b1262);else{for(var _0x447b4d=_0x272391[_0x5e2589(0x78)]-0x1;_0x447b4d>=0x0;_0x447b4d--)if(_0x2f8394=_0x272391[_0x447b4d])_0x3552ab=(_0xbbe539<0x3?_0x2f8394(_0x3552ab):_0xbbe539>0x3?_0x2f8394(_0x3b8610,_0x396774,_0x3552ab):_0x2f8394(_0x3b8610,_0x396774))||_0x3552ab;}return _0xbbe539>0x3&&_0x3552ab&&Object['defineProperty'](_0x3b8610,_0x396774,_0x3552ab),_0x3552ab;},__metadata=this&&this[_0x293824(0x8b)]||function(_0x501c6e,_0x785fe2){const _0x1fd1d9=_0x293824;if(typeof Reflect==='object'&&typeof Reflect[_0x1fd1d9(0x76)]===_0x1fd1d9(0xa3))return Reflect[_0x1fd1d9(0x76)](_0x501c6e,_0x785fe2);};Object[_0x293824(0x82)](exports,_0x293824(0x92),{'value':!![]}),exports[_0x293824(0x96)]=void 0x0;function _0x47b5(_0x2aa9c5,_0x2a8e51){const _0x4cf178=_0x4cf1();return _0x47b5=function(_0x47b5ad,_0x1a2616){_0x47b5ad=_0x47b5ad-0x6c;let _0x53e537=_0x4cf178[_0x47b5ad];return _0x53e537;},_0x47b5(_0x2aa9c5,_0x2a8e51);}function _0x4cf1(){const _0x10b125=['env','x-website-domain','JwtAuthGuard','Bearer','Injectable','RedisCacheService','authorization','object','design:paramtypes','ModuleRef','fingerprint','createTokenFromFingerprint','@nestjs/core','redisCacheService','AuthGuard','function','canActivate','9kVSGHr','split','@nestjs/passport','../../modules/redisCache/redisCache.service','__decorate','authService','575708tNpGJA','validateToken','moduleRef','2778iOGuuz','HttpException','jsonwebtoken','6118098wYVxEk','getRequest','metadata','getNineAiToken','length','9NadKUZ','GlobalConfigService','928722UNiESF','HttpStatus','decorate','err:\x20','658936UNvFkb','jwt','5155cGUJfN','defineProperty','2FCuHSO','UnauthorizedException','checkTokenAuth','getOwnPropertyDescriptor','token','verify','2808610qglPnF','19091820GjtJJF','__metadata','user','@nestjs/common','globalConfigService','extractToken','headers','log','__esModule','slice'];_0x4cf1=function(){return _0x10b125;};return _0x4cf1();}const redisCache_service_1=require(_0x293824(0xa8)),common_1=require(_0x293824(0x8d)),passport_1=require(_0x293824(0xa7)),jwt=require(_0x293824(0x73)),core_1=require(_0x293824(0xa0)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require('../../modules/auth/auth.service');let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x293824(0xa2)])(_0x293824(0x80)){constructor(_0x31bc24,_0x1874b4,_0x493157,_0x27a4d8){const _0x4e47c7=_0x293824;super(),this[_0x4e47c7(0xa1)]=_0x31bc24,this[_0x4e47c7(0x70)]=_0x1874b4,this[_0x4e47c7(0x8e)]=_0x493157,this['authService']=_0x27a4d8;}async[_0x293824(0xa4)](_0x2247eb){const _0x280538=_0x293824;!this[_0x280538(0xa1)]&&(this[_0x280538(0xa1)]=this[_0x280538(0x70)]['get'](redisCache_service_1[_0x280538(0x99)],{'strict':![]}));const _0x49b62e=_0x2247eb['switchToHttp']()[_0x280538(0x75)](),_0x431fc3=_0x49b62e[_0x280538(0x90)][_0x280538(0x95)],_0x292ff5=this[_0x280538(0x8f)](_0x49b62e);console[_0x280538(0x91)](_0x280538(0x87),_0x292ff5),_0x49b62e[_0x280538(0x8c)]=this[_0x280538(0x6f)](_0x292ff5),console['log']('user',_0x49b62e[_0x280538(0x8c)]);const _0x3b521d=this['globalConfigService'][_0x280538(0x77)]();return await this[_0x280538(0xa1)][_0x280538(0x85)](_0x292ff5,_0x49b62e),!![];}[_0x293824(0x8f)](_0x1bfe78){const _0x55c57e=_0x293824;console['log'](_0x55c57e(0x90),_0x1bfe78[_0x55c57e(0x90)]);if(!_0x1bfe78['headers']['authorization']){if(_0x1bfe78[_0x55c57e(0x90)][_0x55c57e(0x9e)]){let _0x5075a8=_0x1bfe78[_0x55c57e(0x90)][_0x55c57e(0x9e)];_0x5075a8>0x7fffffff&&(_0x5075a8=_0x5075a8['toString']()[_0x55c57e(0x93)](-0x9),_0x5075a8=Number(String(Number(_0x5075a8))));const _0x11df28=this[_0x55c57e(0x6d)][_0x55c57e(0x9f)](_0x5075a8);return _0x11df28;}return null;}const _0x553a88=_0x1bfe78[_0x55c57e(0x90)][_0x55c57e(0x9a)][_0x55c57e(0xa6)]('\x20');if(_0x553a88['length']!==0x2||_0x553a88[0x0]!==_0x55c57e(0x97))return null;return _0x553a88[0x1];}[_0x293824(0x6f)](_0x22a745){const _0x232a7b=_0x293824;try{return jwt[_0x232a7b(0x88)](_0x22a745,process[_0x232a7b(0x94)]['JWT_SECRET']);}catch(_0x5fc01f){throw new common_1[(_0x232a7b(0x72))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0x232a7b(0x7c)]['UNAUTHORIZED']);}}['handleRequest'](_0x529e40,_0x890bf5,_0x509755){const _0x19b043=_0x293824;if(_0x529e40||!_0x890bf5){console['log'](_0x19b043(0x7e),_0x529e40);throw _0x529e40||new common_1[(_0x19b043(0x84))]();}return _0x890bf5;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x293824(0x98)])(),__metadata(_0x293824(0x9c),[redisCache_service_1['RedisCacheService'],core_1[_0x293824(0x9d)],globalConfig_service_1[_0x293824(0x7a)],auth_service_1['AuthService']])],JwtAuthGuard),exports[_0x293824(0x96)]=JwtAuthGuard;