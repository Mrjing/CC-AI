'use strict';const _0x371dc5=_0xa97f;function _0xa97f(_0x5d5656,_0x31627c){const _0x307317=_0x3073();return _0xa97f=function(_0xa97ff3,_0x41b3cf){_0xa97ff3=_0xa97ff3-0x17c;let _0x2d7543=_0x307317[_0xa97ff3];return _0x2d7543;},_0xa97f(_0x5d5656,_0x31627c);}(function(_0x52f557,_0x21b1ba){const _0x47f0dd=_0xa97f,_0x4f613a=_0x52f557();while(!![]){try{const _0x4a20df=parseInt(_0x47f0dd(0x193))/0x1*(-parseInt(_0x47f0dd(0x1ac))/0x2)+parseInt(_0x47f0dd(0x181))/0x3+-parseInt(_0x47f0dd(0x1a1))/0x4+parseInt(_0x47f0dd(0x180))/0x5*(parseInt(_0x47f0dd(0x1ab))/0x6)+-parseInt(_0x47f0dd(0x186))/0x7+parseInt(_0x47f0dd(0x18b))/0x8+parseInt(_0x47f0dd(0x1a4))/0x9*(parseInt(_0x47f0dd(0x187))/0xa);if(_0x4a20df===_0x21b1ba)break;else _0x4f613a['push'](_0x4f613a['shift']());}catch(_0x56649e){_0x4f613a['push'](_0x4f613a['shift']());}}}(_0x3073,0x8f3c0));var __decorate=this&&this[_0x371dc5(0x192)]||function(_0x41f8be,_0x37aaa2,_0xa3dcb9,_0x27f741){const _0x8877dd=_0x371dc5;var _0x530723=arguments[_0x8877dd(0x18f)],_0x4961ee=_0x530723<0x3?_0x37aaa2:_0x27f741===null?_0x27f741=Object['getOwnPropertyDescriptor'](_0x37aaa2,_0xa3dcb9):_0x27f741,_0x6c48f2;if(typeof Reflect===_0x8877dd(0x183)&&typeof Reflect['decorate']===_0x8877dd(0x1a7))_0x4961ee=Reflect[_0x8877dd(0x17c)](_0x41f8be,_0x37aaa2,_0xa3dcb9,_0x27f741);else{for(var _0xdc1f9f=_0x41f8be[_0x8877dd(0x18f)]-0x1;_0xdc1f9f>=0x0;_0xdc1f9f--)if(_0x6c48f2=_0x41f8be[_0xdc1f9f])_0x4961ee=(_0x530723<0x3?_0x6c48f2(_0x4961ee):_0x530723>0x3?_0x6c48f2(_0x37aaa2,_0xa3dcb9,_0x4961ee):_0x6c48f2(_0x37aaa2,_0xa3dcb9))||_0x4961ee;}return _0x530723>0x3&&_0x4961ee&&Object[_0x8877dd(0x1a0)](_0x37aaa2,_0xa3dcb9,_0x4961ee),_0x4961ee;},__metadata=this&&this[_0x371dc5(0x194)]||function(_0x115f1a,_0x1f3519){const _0x32bc41=_0x371dc5;if(typeof Reflect===_0x32bc41(0x183)&&typeof Reflect[_0x32bc41(0x198)]===_0x32bc41(0x1a7))return Reflect[_0x32bc41(0x198)](_0x115f1a,_0x1f3519);};Object[_0x371dc5(0x1a0)](exports,_0x371dc5(0x1ad),{'value':!![]}),exports[_0x371dc5(0x1b1)]=void 0x0;function _0x3073(){const _0x176493=['canActivate','6381INBTUb','UNAUTHORIZED','AuthGuard','function','@nestjs/common','@nestjs/passport','Bearer','18dtRCAC','406506yGjNzO','__esModule','validateToken','ModuleRef','env','JwtAuthGuard','decorate','../../modules/globalConfig/globalConfig.service','extractToken','checkTokenAuth','895150YcleuI','2745498VUPRDW','redisCacheService','object','get','headers','2485105oXxhQO','5660TfIgcj','HttpStatus','jsonwebtoken','handleRequest','4869192rSTIYe','split','HttpException','user','length','AuthService','slice','__decorate','3xLBjBx','__metadata','globalConfigService','authorization','getNineAiToken','metadata','亲爱的用户,请登录后继续操作,我们正在等您的到来！','verify','fingerprint','err:\x20','authService','moduleRef','UnauthorizedException','defineProperty','3642948NwhNbn','../../modules/auth/auth.service'];_0x3073=function(){return _0x176493;};return _0x3073();}const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x371dc5(0x1a8)),passport_1=require(_0x371dc5(0x1a9)),jwt=require(_0x371dc5(0x189)),core_1=require('@nestjs/core'),globalConfig_service_1=require(_0x371dc5(0x17d)),auth_service_1=require(_0x371dc5(0x1a2));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x371dc5(0x1a6)])('jwt'){constructor(_0x6b179,_0x4d54e0,_0x25d30a,_0xd30284){const _0x310bb5=_0x371dc5;super(),this[_0x310bb5(0x182)]=_0x6b179,this[_0x310bb5(0x19e)]=_0x4d54e0,this[_0x310bb5(0x195)]=_0x25d30a,this['authService']=_0xd30284;}async[_0x371dc5(0x1a3)](_0x5a2e66){const _0x517501=_0x371dc5;!this['redisCacheService']&&(this['redisCacheService']=this[_0x517501(0x19e)][_0x517501(0x184)](redisCache_service_1['RedisCacheService'],{'strict':![]}));const _0x3b587c=_0x5a2e66['switchToHttp']()['getRequest'](),_0x2f78c3=_0x3b587c[_0x517501(0x185)]['x-website-domain'],_0x475c16=this[_0x517501(0x17e)](_0x3b587c);_0x3b587c[_0x517501(0x18e)]=this[_0x517501(0x1ae)](_0x475c16);const _0x327aa7=this[_0x517501(0x195)][_0x517501(0x197)]();return await this['redisCacheService'][_0x517501(0x17f)](_0x475c16,_0x3b587c),!![];}[_0x371dc5(0x17e)](_0x465197){const _0x51fc25=_0x371dc5;if(!_0x465197[_0x51fc25(0x185)][_0x51fc25(0x196)]){if(_0x465197[_0x51fc25(0x185)]['fingerprint']){let _0x7575c7=_0x465197['headers'][_0x51fc25(0x19b)];_0x7575c7>0x7fffffff&&(_0x7575c7=_0x7575c7['toString']()[_0x51fc25(0x191)](-0x9),_0x7575c7=Number(String(Number(_0x7575c7))));const _0x46da67=this[_0x51fc25(0x19d)]['createTokenFromFingerprint'](_0x7575c7);return _0x46da67;}return null;}const _0x244658=_0x465197[_0x51fc25(0x185)][_0x51fc25(0x196)][_0x51fc25(0x18c)]('\x20');if(_0x244658['length']!==0x2||_0x244658[0x0]!==_0x51fc25(0x1aa))return null;return _0x244658[0x1];}[_0x371dc5(0x1ae)](_0x4b83e0){const _0x442e79=_0x371dc5;try{return jwt[_0x442e79(0x19a)](_0x4b83e0,process[_0x442e79(0x1b0)]['JWT_SECRET']);}catch(_0x3610b1){throw new common_1[(_0x442e79(0x18d))](_0x442e79(0x199),common_1[_0x442e79(0x188)][_0x442e79(0x1a5)]);}}[_0x371dc5(0x18a)](_0x2ec79b,_0x5745b6,_0x76a013){const _0x5c0508=_0x371dc5;if(_0x2ec79b||!_0x5745b6){console['log'](_0x5c0508(0x19c),_0x2ec79b);throw _0x2ec79b||new common_1[(_0x5c0508(0x19f))]();}return _0x5745b6;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata('design:paramtypes',[redisCache_service_1['RedisCacheService'],core_1[_0x371dc5(0x1af)],globalConfig_service_1['GlobalConfigService'],auth_service_1[_0x371dc5(0x190)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;