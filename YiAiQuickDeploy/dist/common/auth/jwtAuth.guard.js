'use strict';const _0x36343a=_0x42f9;(function(_0x3d976b,_0x355ccb){const _0x35eaba=_0x42f9,_0x6e3bc0=_0x3d976b();while(!![]){try{const _0x553b67=-parseInt(_0x35eaba(0xd2))/0x1*(-parseInt(_0x35eaba(0xb9))/0x2)+-parseInt(_0x35eaba(0xbd))/0x3+-parseInt(_0x35eaba(0xc8))/0x4+parseInt(_0x35eaba(0xc4))/0x5*(-parseInt(_0x35eaba(0xb0))/0x6)+-parseInt(_0x35eaba(0xb3))/0x7+parseInt(_0x35eaba(0xc7))/0x8+parseInt(_0x35eaba(0xdd))/0x9*(parseInt(_0x35eaba(0xd9))/0xa);if(_0x553b67===_0x355ccb)break;else _0x6e3bc0['push'](_0x6e3bc0['shift']());}catch(_0x4e4f61){_0x6e3bc0['push'](_0x6e3bc0['shift']());}}}(_0x169d,0x5edf8));function _0x42f9(_0x57d89a,_0x560a33){const _0x169d3e=_0x169d();return _0x42f9=function(_0x42f9d0,_0x256f9a){_0x42f9d0=_0x42f9d0-0xa3;let _0x4b71ad=_0x169d3e[_0x42f9d0];return _0x4b71ad;},_0x42f9(_0x57d89a,_0x560a33);}var __decorate=this&&this[_0x36343a(0xad)]||function(_0xfca4a2,_0x3527c3,_0xc1f2d3,_0x1416c1){const _0x5acab6=_0x36343a;var _0x5b2d57=arguments[_0x5acab6(0xb8)],_0x5bf34d=_0x5b2d57<0x3?_0x3527c3:_0x1416c1===null?_0x1416c1=Object[_0x5acab6(0xcc)](_0x3527c3,_0xc1f2d3):_0x1416c1,_0x324016;if(typeof Reflect===_0x5acab6(0xc3)&&typeof Reflect[_0x5acab6(0xd7)]===_0x5acab6(0xa3))_0x5bf34d=Reflect[_0x5acab6(0xd7)](_0xfca4a2,_0x3527c3,_0xc1f2d3,_0x1416c1);else{for(var _0x2c69f4=_0xfca4a2[_0x5acab6(0xb8)]-0x1;_0x2c69f4>=0x0;_0x2c69f4--)if(_0x324016=_0xfca4a2[_0x2c69f4])_0x5bf34d=(_0x5b2d57<0x3?_0x324016(_0x5bf34d):_0x5b2d57>0x3?_0x324016(_0x3527c3,_0xc1f2d3,_0x5bf34d):_0x324016(_0x3527c3,_0xc1f2d3))||_0x5bf34d;}return _0x5b2d57>0x3&&_0x5bf34d&&Object[_0x5acab6(0xd8)](_0x3527c3,_0xc1f2d3,_0x5bf34d),_0x5bf34d;},__metadata=this&&this[_0x36343a(0xc6)]||function(_0x3c6045,_0x338957){const _0x4077a0=_0x36343a;if(typeof Reflect===_0x4077a0(0xc3)&&typeof Reflect[_0x4077a0(0xbb)]==='function')return Reflect['metadata'](_0x3c6045,_0x338957);};Object[_0x36343a(0xd8)](exports,_0x36343a(0xd6),{'value':!![]}),exports[_0x36343a(0xb7)]=void 0x0;const redisCache_service_1=require(_0x36343a(0xce)),common_1=require('@nestjs/common'),passport_1=require(_0x36343a(0xa8)),jwt=require(_0x36343a(0xdb)),core_1=require(_0x36343a(0xbf)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require(_0x36343a(0xd5));function _0x169d(){const _0x72d508=['JWT_SECRET','@nestjs/passport','jwt','getNineAiToken','design:paramtypes','ModuleRef','__decorate','RedisCacheService','x-website-domain','1027086AJWwpf','validateToken','switchToHttp','1754907YyKzhn','extractToken','globalConfigService','toString','JwtAuthGuard','length','131658LcHMTu','GlobalConfigService','metadata','HttpException','2239308OjiaWz','AuthService','@nestjs/core','UnauthorizedException','get','log','object','10Pfbzdx','亲爱的用户,请登录后继续操作,我们正在等您的到来！','__metadata','2445168xomOMM','572964UsTNvU','verify','moduleRef','redisCacheService','getOwnPropertyDescriptor','fingerprint','../../modules/redisCache/redisCache.service','AuthGuard','slice','checkTokenAuth','1TIAaoS','authorization','Injectable','../../modules/auth/auth.service','__esModule','decorate','defineProperty','14998650CvClAe','createTokenFromFingerprint','jsonwebtoken','Bearer','9YZMHnL','HttpStatus','function','headers','err:\x20','env'];_0x169d=function(){return _0x72d508;};return _0x169d();}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x36343a(0xcf)])(_0x36343a(0xa9)){constructor(_0x1ce876,_0x1aeb98,_0x3073ef,_0x4cc230){const _0x1c7019=_0x36343a;super(),this[_0x1c7019(0xcb)]=_0x1ce876,this[_0x1c7019(0xca)]=_0x1aeb98,this[_0x1c7019(0xb5)]=_0x3073ef,this['authService']=_0x4cc230;}async['canActivate'](_0x3b022f){const _0x1544a9=_0x36343a;!this['redisCacheService']&&(this[_0x1544a9(0xcb)]=this['moduleRef'][_0x1544a9(0xc1)](redisCache_service_1[_0x1544a9(0xae)],{'strict':![]}));const _0x6b5dd8=_0x3b022f[_0x1544a9(0xb2)]()['getRequest'](),_0x1a3ad6=_0x6b5dd8[_0x1544a9(0xa4)][_0x1544a9(0xaf)],_0x35b950=this[_0x1544a9(0xb4)](_0x6b5dd8);_0x6b5dd8['user']=this[_0x1544a9(0xb1)](_0x35b950);const _0x21efb3=this['globalConfigService'][_0x1544a9(0xaa)]();return await this['redisCacheService'][_0x1544a9(0xd1)](_0x35b950,_0x6b5dd8),!![];}[_0x36343a(0xb4)](_0x18ef7e){const _0x262434=_0x36343a;if(!_0x18ef7e[_0x262434(0xa4)][_0x262434(0xd3)]){if(_0x18ef7e['headers'][_0x262434(0xcd)]){let _0x458398=_0x18ef7e['headers']['fingerprint'];_0x458398>0x7fffffff&&(_0x458398=_0x458398[_0x262434(0xb6)]()[_0x262434(0xd0)](-0x9),_0x458398=Number(String(Number(_0x458398))));const _0x154499=this['authService'][_0x262434(0xda)](_0x458398);return _0x154499;}return null;}const _0x49e8cb=_0x18ef7e[_0x262434(0xa4)][_0x262434(0xd3)]['split']('\x20');if(_0x49e8cb[_0x262434(0xb8)]!==0x2||_0x49e8cb[0x0]!==_0x262434(0xdc))return null;return _0x49e8cb[0x1];}[_0x36343a(0xb1)](_0x3a486c){const _0x72dead=_0x36343a;try{return jwt[_0x72dead(0xc9)](_0x3a486c,process[_0x72dead(0xa6)][_0x72dead(0xa7)]);}catch(_0x26d6a0){throw new common_1[(_0x72dead(0xbc))](_0x72dead(0xc5),common_1[_0x72dead(0xde)]['UNAUTHORIZED']);}}['handleRequest'](_0x199d24,_0x164b94,_0x150730){const _0x5c400f=_0x36343a;if(_0x199d24||!_0x164b94){console[_0x5c400f(0xc2)](_0x5c400f(0xa5),_0x199d24);throw _0x199d24||new common_1[(_0x5c400f(0xc0))]();}return _0x164b94;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x36343a(0xd4)])(),__metadata(_0x36343a(0xab),[redisCache_service_1['RedisCacheService'],core_1[_0x36343a(0xac)],globalConfig_service_1[_0x36343a(0xba)],auth_service_1[_0x36343a(0xbe)]])],JwtAuthGuard),exports[_0x36343a(0xb7)]=JwtAuthGuard;