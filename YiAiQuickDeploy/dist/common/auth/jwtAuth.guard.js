'use strict';const _0x29ae18=_0x5e37;(function(_0x147b38,_0x3bfbe4){const _0x172d51=_0x5e37,_0x106118=_0x147b38();while(!![]){try{const _0x43f829=-parseInt(_0x172d51(0x1bb))/0x1*(-parseInt(_0x172d51(0x196))/0x2)+-parseInt(_0x172d51(0x1b7))/0x3+parseInt(_0x172d51(0x19f))/0x4+parseInt(_0x172d51(0x18a))/0x5*(-parseInt(_0x172d51(0x1b0))/0x6)+-parseInt(_0x172d51(0x192))/0x7+-parseInt(_0x172d51(0x187))/0x8+parseInt(_0x172d51(0x19d))/0x9;if(_0x43f829===_0x3bfbe4)break;else _0x106118['push'](_0x106118['shift']());}catch(_0x3245ff){_0x106118['push'](_0x106118['shift']());}}}(_0x4e13,0x74865));var __decorate=this&&this[_0x29ae18(0x18d)]||function(_0x132db7,_0x49e96b,_0x29b602,_0x1af8d3){const _0x16e22c=_0x29ae18;var _0x31b9f6=arguments[_0x16e22c(0x1b8)],_0x49ee48=_0x31b9f6<0x3?_0x49e96b:_0x1af8d3===null?_0x1af8d3=Object[_0x16e22c(0x19b)](_0x49e96b,_0x29b602):_0x1af8d3,_0x196301;if(typeof Reflect===_0x16e22c(0x1b3)&&typeof Reflect[_0x16e22c(0x1a6)]==='function')_0x49ee48=Reflect[_0x16e22c(0x1a6)](_0x132db7,_0x49e96b,_0x29b602,_0x1af8d3);else{for(var _0x132690=_0x132db7[_0x16e22c(0x1b8)]-0x1;_0x132690>=0x0;_0x132690--)if(_0x196301=_0x132db7[_0x132690])_0x49ee48=(_0x31b9f6<0x3?_0x196301(_0x49ee48):_0x31b9f6>0x3?_0x196301(_0x49e96b,_0x29b602,_0x49ee48):_0x196301(_0x49e96b,_0x29b602))||_0x49ee48;}return _0x31b9f6>0x3&&_0x49ee48&&Object[_0x16e22c(0x185)](_0x49e96b,_0x29b602,_0x49ee48),_0x49ee48;},__metadata=this&&this[_0x29ae18(0x1a7)]||function(_0x534138,_0x153506){const _0x31cdbd=_0x29ae18;if(typeof Reflect==='object'&&typeof Reflect[_0x31cdbd(0x1a8)]===_0x31cdbd(0x19c))return Reflect[_0x31cdbd(0x1a8)](_0x534138,_0x153506);};function _0x5e37(_0x2f0bd0,_0x3e3c3f){const _0x4e13b2=_0x4e13();return _0x5e37=function(_0x5e37db,_0x1f3dff){_0x5e37db=_0x5e37db-0x182;let _0x2e9e99=_0x4e13b2[_0x5e37db];return _0x2e9e99;},_0x5e37(_0x2f0bd0,_0x3e3c3f);}Object[_0x29ae18(0x185)](exports,_0x29ae18(0x1b2),{'value':!![]}),exports[_0x29ae18(0x1aa)]=void 0x0;const redisCache_service_1=require(_0x29ae18(0x18c)),common_1=require(_0x29ae18(0x1a2)),passport_1=require(_0x29ae18(0x1ae)),jwt=require(_0x29ae18(0x186)),core_1=require(_0x29ae18(0x197)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require(_0x29ae18(0x191));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1['AuthGuard'])(_0x29ae18(0x1b5)){constructor(_0x509e2f,_0x16cddc,_0x34dad3,_0x5a78b3){const _0x3d1bd7=_0x29ae18;super(),this[_0x3d1bd7(0x1b9)]=_0x509e2f,this[_0x3d1bd7(0x1bc)]=_0x16cddc,this[_0x3d1bd7(0x198)]=_0x34dad3,this[_0x3d1bd7(0x1b4)]=_0x5a78b3;}async[_0x29ae18(0x199)](_0x2afd52){const _0x2cd5e8=_0x29ae18;!this[_0x2cd5e8(0x1b9)]&&(this[_0x2cd5e8(0x1b9)]=this[_0x2cd5e8(0x1bc)][_0x2cd5e8(0x18e)](redisCache_service_1[_0x2cd5e8(0x1ab)],{'strict':![]}));const _0x1aabbd=_0x2afd52[_0x2cd5e8(0x18f)]()[_0x2cd5e8(0x195)](),_0x2f053e=_0x1aabbd[_0x2cd5e8(0x1a4)]['x-website-domain'],_0xf4af13=this[_0x2cd5e8(0x1a1)](_0x1aabbd);_0x1aabbd[_0x2cd5e8(0x182)]=this[_0x2cd5e8(0x190)](_0xf4af13);const _0xa4857b=this['globalConfigService']['getNineAiToken']();return await this['redisCacheService'][_0x2cd5e8(0x188)](_0xf4af13,_0x1aabbd),!![];}[_0x29ae18(0x1a1)](_0x512419){const _0x5ef7b4=_0x29ae18;if(!_0x512419[_0x5ef7b4(0x1a4)][_0x5ef7b4(0x1b6)]){if(_0x512419[_0x5ef7b4(0x1a4)][_0x5ef7b4(0x19e)]){let _0x3ff0b4=_0x512419[_0x5ef7b4(0x1a4)]['fingerprint'];_0x3ff0b4>0x7fffffff&&(_0x3ff0b4=_0x3ff0b4[_0x5ef7b4(0x1a9)]()[_0x5ef7b4(0x193)](-0x9),_0x3ff0b4=Number(String(Number(_0x3ff0b4))));const _0x10ed19=this['authService'][_0x5ef7b4(0x189)](_0x3ff0b4);return _0x10ed19;}return null;}const _0x573a1f=_0x512419[_0x5ef7b4(0x1a4)][_0x5ef7b4(0x1b6)][_0x5ef7b4(0x1a0)]('\x20');if(_0x573a1f[_0x5ef7b4(0x1b8)]!==0x2||_0x573a1f[0x0]!=='Bearer')return null;return _0x573a1f[0x1];}[_0x29ae18(0x190)](_0x2b2be3){const _0x4971d0=_0x29ae18;try{return jwt['verify'](_0x2b2be3,process[_0x4971d0(0x1a3)]['JWT_SECRET']);}catch(_0x133a18){throw new common_1[(_0x4971d0(0x1ba))](_0x4971d0(0x1ac),common_1[_0x4971d0(0x184)]['UNAUTHORIZED']);}}[_0x29ae18(0x1b1)](_0x32a38d,_0x206b3e,_0x452568){const _0x4bea97=_0x29ae18;if(_0x32a38d||!_0x206b3e){console[_0x4bea97(0x1a5)](_0x4bea97(0x18b),_0x32a38d);throw _0x32a38d||new common_1[(_0x4bea97(0x1ad))]();}return _0x206b3e;}};function _0x4e13(){const _0x6c5d58=['__metadata','metadata','toString','JwtAuthGuard','RedisCacheService','亲爱的用户,请登录后继续操作,我们正在等您的到来！','UnauthorizedException','@nestjs/passport','GlobalConfigService','204LDtNiu','handleRequest','__esModule','object','authService','jwt','authorization','252885HWUqbk','length','redisCacheService','HttpException','76npXfPM','moduleRef','user','ModuleRef','HttpStatus','defineProperty','jsonwebtoken','7342744gPdxJA','checkTokenAuth','createTokenFromFingerprint','58805GrYbMR','err:\x20','../../modules/redisCache/redisCache.service','__decorate','get','switchToHttp','validateToken','../../modules/auth/auth.service','603127dsrqSn','slice','design:paramtypes','getRequest','20122xdAdBb','@nestjs/core','globalConfigService','canActivate','Injectable','getOwnPropertyDescriptor','function','10632474UvKnCe','fingerprint','77744GKJnLh','split','extractToken','@nestjs/common','env','headers','log','decorate'];_0x4e13=function(){return _0x6c5d58;};return _0x4e13();}JwtAuthGuard=__decorate([(0x0,common_1[_0x29ae18(0x19a)])(),__metadata(_0x29ae18(0x194),[redisCache_service_1['RedisCacheService'],core_1[_0x29ae18(0x183)],globalConfig_service_1[_0x29ae18(0x1af)],auth_service_1['AuthService']])],JwtAuthGuard),exports[_0x29ae18(0x1aa)]=JwtAuthGuard;