'use strict';const _0x338a01=_0x3153;(function(_0x427af3,_0x95919e){const _0x5aeeba=_0x3153,_0x5167ed=_0x427af3();while(!![]){try{const _0x12fe68=parseInt(_0x5aeeba(0x13f))/0x1*(parseInt(_0x5aeeba(0x12b))/0x2)+-parseInt(_0x5aeeba(0x12d))/0x3+parseInt(_0x5aeeba(0x138))/0x4*(parseInt(_0x5aeeba(0x143))/0x5)+-parseInt(_0x5aeeba(0x124))/0x6+-parseInt(_0x5aeeba(0x11a))/0x7*(parseInt(_0x5aeeba(0x11f))/0x8)+-parseInt(_0x5aeeba(0x13d))/0x9*(parseInt(_0x5aeeba(0x134))/0xa)+parseInt(_0x5aeeba(0x146))/0xb;if(_0x12fe68===_0x95919e)break;else _0x5167ed['push'](_0x5167ed['shift']());}catch(_0x3e4b47){_0x5167ed['push'](_0x5167ed['shift']());}}}(_0x5261,0x65930));var __decorate=this&&this['__decorate']||function(_0x56b879,_0x2e3864,_0x504c4c,_0x25a5a9){const _0x50186c=_0x3153;var _0xd44e=arguments[_0x50186c(0x149)],_0x1343fa=_0xd44e<0x3?_0x2e3864:_0x25a5a9===null?_0x25a5a9=Object[_0x50186c(0x139)](_0x2e3864,_0x504c4c):_0x25a5a9,_0x46fa15;if(typeof Reflect===_0x50186c(0x14b)&&typeof Reflect[_0x50186c(0x126)]===_0x50186c(0x131))_0x1343fa=Reflect[_0x50186c(0x126)](_0x56b879,_0x2e3864,_0x504c4c,_0x25a5a9);else{for(var _0x3cb9b3=_0x56b879[_0x50186c(0x149)]-0x1;_0x3cb9b3>=0x0;_0x3cb9b3--)if(_0x46fa15=_0x56b879[_0x3cb9b3])_0x1343fa=(_0xd44e<0x3?_0x46fa15(_0x1343fa):_0xd44e>0x3?_0x46fa15(_0x2e3864,_0x504c4c,_0x1343fa):_0x46fa15(_0x2e3864,_0x504c4c))||_0x1343fa;}return _0xd44e>0x3&&_0x1343fa&&Object[_0x50186c(0x14a)](_0x2e3864,_0x504c4c,_0x1343fa),_0x1343fa;},__metadata=this&&this['__metadata']||function(_0x15f01,_0x22e9e0){const _0x22162c=_0x3153;if(typeof Reflect===_0x22162c(0x14b)&&typeof Reflect['metadata']===_0x22162c(0x131))return Reflect[_0x22162c(0x12c)](_0x15f01,_0x22e9e0);};Object[_0x338a01(0x14a)](exports,_0x338a01(0x13e),{'value':!![]}),exports['JwtAuthGuard']=void 0x0;function _0x3153(_0x22d017,_0x417f47){const _0x526197=_0x5261();return _0x3153=function(_0x31536d,_0x574246){_0x31536d=_0x31536d-0x115;let _0x3ce076=_0x526197[_0x31536d];return _0x3ce076;},_0x3153(_0x22d017,_0x417f47);}const redisCache_service_1=require(_0x338a01(0x12a)),common_1=require('@nestjs/common'),passport_1=require(_0x338a01(0x12f)),jwt=require('jsonwebtoken'),core_1=require(_0x338a01(0x14c)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require(_0x338a01(0x128));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x338a01(0x132)])(_0x338a01(0x121)){constructor(_0x1d11c2,_0x1ca184,_0x35c0ad,_0x312768){const _0x23ccb9=_0x338a01;super(),this[_0x23ccb9(0x115)]=_0x1d11c2,this['moduleRef']=_0x1ca184,this[_0x23ccb9(0x140)]=_0x35c0ad,this[_0x23ccb9(0x118)]=_0x312768;}async[_0x338a01(0x117)](_0x450dba){const _0x3473c8=_0x338a01;!this['redisCacheService']&&(this[_0x3473c8(0x115)]=this[_0x3473c8(0x11b)][_0x3473c8(0x125)](redisCache_service_1[_0x3473c8(0x12e)],{'strict':![]}));const _0x5009d0=_0x450dba['switchToHttp']()['getRequest'](),_0xb2ae2f=_0x5009d0[_0x3473c8(0x122)][_0x3473c8(0x127)],_0x5a618e=this[_0x3473c8(0x137)](_0x5009d0);_0x5009d0['user']=this[_0x3473c8(0x13b)](_0x5a618e);const _0x3ffb7e=this['globalConfigService'][_0x3473c8(0x116)]();return await this[_0x3473c8(0x115)][_0x3473c8(0x142)](_0x5a618e,_0x5009d0),!![];}[_0x338a01(0x137)](_0x1e7242){const _0x61d29d=_0x338a01;if(!_0x1e7242['headers'][_0x61d29d(0x11e)]){if(_0x1e7242[_0x61d29d(0x122)]['fingerprint']){let _0x1774b8=_0x1e7242[_0x61d29d(0x122)][_0x61d29d(0x148)];_0x1774b8>0x7fffffff&&(_0x1774b8=_0x1774b8[_0x61d29d(0x11d)]()[_0x61d29d(0x147)](-0x9),_0x1774b8=Number(String(Number(_0x1774b8))));const _0x1b0631=this[_0x61d29d(0x118)][_0x61d29d(0x120)](_0x1774b8);return _0x1b0631;}return null;}const _0x5d57ed=_0x1e7242[_0x61d29d(0x122)][_0x61d29d(0x11e)][_0x61d29d(0x13c)]('\x20');if(_0x5d57ed[_0x61d29d(0x149)]!==0x2||_0x5d57ed[0x0]!=='Bearer')return null;return _0x5d57ed[0x1];}[_0x338a01(0x13b)](_0x555f0e){const _0x288a1f=_0x338a01;try{return jwt[_0x288a1f(0x129)](_0x555f0e,process['env'][_0x288a1f(0x123)]);}catch(_0x41a6f4){throw new common_1['HttpException'](_0x288a1f(0x130),common_1[_0x288a1f(0x133)]['UNAUTHORIZED']);}}[_0x338a01(0x141)](_0x3bbfec,_0x2c3781,_0x465dff){const _0x357018=_0x338a01;if(_0x3bbfec||!_0x2c3781){console[_0x357018(0x135)](_0x357018(0x144),_0x3bbfec);throw _0x3bbfec||new common_1[(_0x357018(0x11c))]();}return _0x2c3781;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x338a01(0x136),[redisCache_service_1[_0x338a01(0x12e)],core_1['ModuleRef'],globalConfig_service_1[_0x338a01(0x13a)],auth_service_1[_0x338a01(0x119)]])],JwtAuthGuard),exports[_0x338a01(0x145)]=JwtAuthGuard;function _0x5261(){const _0xc40fc=['JWT_SECRET','2883798vFgdrZ','get','decorate','x-website-domain','../../modules/auth/auth.service','verify','../../modules/redisCache/redisCache.service','1068wvTkbD','metadata','1621983EauDdY','RedisCacheService','@nestjs/passport','亲爱的用户,请登录后继续操作,我们正在等您的到来！','function','AuthGuard','HttpStatus','5946530NIvVIR','log','design:paramtypes','extractToken','4SxLQQw','getOwnPropertyDescriptor','GlobalConfigService','validateToken','split','9GwLNtX','__esModule','1409EHRUaa','globalConfigService','handleRequest','checkTokenAuth','2512065wvXFDV','err:\x20','JwtAuthGuard','13647084EbzQHo','slice','fingerprint','length','defineProperty','object','@nestjs/core','redisCacheService','getNineAiToken','canActivate','authService','AuthService','763gsneuN','moduleRef','UnauthorizedException','toString','authorization','34016rSCYFo','createTokenFromFingerprint','jwt','headers'];_0x5261=function(){return _0xc40fc;};return _0x5261();}