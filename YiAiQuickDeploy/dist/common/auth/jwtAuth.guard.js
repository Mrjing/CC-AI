'use strict';const _0x53d5d3=_0x5176;(function(_0x40c74b,_0x21e8c6){const _0x1dc97a=_0x5176,_0x13b18e=_0x40c74b();while(!![]){try{const _0x164177=parseInt(_0x1dc97a(0x1c1))/0x1*(-parseInt(_0x1dc97a(0x1a4))/0x2)+parseInt(_0x1dc97a(0x1b2))/0x3*(parseInt(_0x1dc97a(0x1ac))/0x4)+-parseInt(_0x1dc97a(0x1a9))/0x5+parseInt(_0x1dc97a(0x1cd))/0x6*(-parseInt(_0x1dc97a(0x1c9))/0x7)+parseInt(_0x1dc97a(0x1a8))/0x8+-parseInt(_0x1dc97a(0x1b3))/0x9+parseInt(_0x1dc97a(0x1cf))/0xa*(parseInt(_0x1dc97a(0x1b9))/0xb);if(_0x164177===_0x21e8c6)break;else _0x13b18e['push'](_0x13b18e['shift']());}catch(_0x5df1c0){_0x13b18e['push'](_0x13b18e['shift']());}}}(_0x1fea,0x324db));function _0x5176(_0x78bbc3,_0x1f9165){const _0x1fea38=_0x1fea();return _0x5176=function(_0x51761b,_0x105a8b){_0x51761b=_0x51761b-0x1a0;let _0x5a4613=_0x1fea38[_0x51761b];return _0x5a4613;},_0x5176(_0x78bbc3,_0x1f9165);}var __decorate=this&&this['__decorate']||function(_0x413769,_0x31a2d7,_0x1568ae,_0x40f723){const _0x4feef1=_0x5176;var _0x17b49b=arguments['length'],_0x40ccb3=_0x17b49b<0x3?_0x31a2d7:_0x40f723===null?_0x40f723=Object['getOwnPropertyDescriptor'](_0x31a2d7,_0x1568ae):_0x40f723,_0x396253;if(typeof Reflect===_0x4feef1(0x1b0)&&typeof Reflect[_0x4feef1(0x1cc)]==='function')_0x40ccb3=Reflect[_0x4feef1(0x1cc)](_0x413769,_0x31a2d7,_0x1568ae,_0x40f723);else{for(var _0x17428b=_0x413769[_0x4feef1(0x1c0)]-0x1;_0x17428b>=0x0;_0x17428b--)if(_0x396253=_0x413769[_0x17428b])_0x40ccb3=(_0x17b49b<0x3?_0x396253(_0x40ccb3):_0x17b49b>0x3?_0x396253(_0x31a2d7,_0x1568ae,_0x40ccb3):_0x396253(_0x31a2d7,_0x1568ae))||_0x40ccb3;}return _0x17b49b>0x3&&_0x40ccb3&&Object['defineProperty'](_0x31a2d7,_0x1568ae,_0x40ccb3),_0x40ccb3;},__metadata=this&&this[_0x53d5d3(0x1af)]||function(_0x2568a4,_0x4820fb){const _0x8ce91=_0x53d5d3;if(typeof Reflect===_0x8ce91(0x1b0)&&typeof Reflect[_0x8ce91(0x1d0)]===_0x8ce91(0x1cb))return Reflect[_0x8ce91(0x1d0)](_0x2568a4,_0x4820fb);};Object[_0x53d5d3(0x1ae)](exports,_0x53d5d3(0x1ce),{'value':!![]}),exports['JwtAuthGuard']=void 0x0;const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x53d5d3(0x1a1)),passport_1=require(_0x53d5d3(0x1a6)),jwt=require(_0x53d5d3(0x1ba)),core_1=require(_0x53d5d3(0x1bc)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require(_0x53d5d3(0x1bf));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x53d5d3(0x1bb)])(_0x53d5d3(0x1d2)){constructor(_0x3434f3,_0x5b0a8c,_0x32bc57,_0x246c6e){const _0x8b7c82=_0x53d5d3;super(),this[_0x8b7c82(0x1d4)]=_0x3434f3,this['moduleRef']=_0x5b0a8c,this[_0x8b7c82(0x1a0)]=_0x32bc57,this[_0x8b7c82(0x1ab)]=_0x246c6e;}async[_0x53d5d3(0x1be)](_0x5dad22){const _0x18ca59=_0x53d5d3;!this['redisCacheService']&&(this[_0x18ca59(0x1d4)]=this[_0x18ca59(0x1d3)]['get'](redisCache_service_1[_0x18ca59(0x1c6)],{'strict':![]}));const _0x362c35=_0x5dad22['switchToHttp']()[_0x18ca59(0x1d1)](),_0x699ccc=_0x362c35['headers'][_0x18ca59(0x1c5)],_0x814246=this[_0x18ca59(0x1d6)](_0x362c35);_0x362c35[_0x18ca59(0x1d5)]=this[_0x18ca59(0x1d7)](_0x814246);const _0x1727f2=this[_0x18ca59(0x1a0)][_0x18ca59(0x1a2)]();return await this[_0x18ca59(0x1d4)][_0x18ca59(0x1b6)](_0x814246,_0x362c35),!![];}[_0x53d5d3(0x1d6)](_0x1c91b1){const _0x85bc07=_0x53d5d3;if(!_0x1c91b1[_0x85bc07(0x1c4)]['authorization']){if(_0x1c91b1[_0x85bc07(0x1c4)][_0x85bc07(0x1a3)]){let _0x3d17b6=_0x1c91b1[_0x85bc07(0x1c4)][_0x85bc07(0x1a3)];_0x3d17b6>0x7fffffff&&(_0x3d17b6=_0x3d17b6['toString']()[_0x85bc07(0x1d8)](-0x9),_0x3d17b6=Number(String(Number(_0x3d17b6))));const _0x3bc908=this['authService'][_0x85bc07(0x1b8)](_0x3d17b6);return _0x3bc908;}return null;}const _0x444e68=_0x1c91b1[_0x85bc07(0x1c4)][_0x85bc07(0x1ad)][_0x85bc07(0x1bd)]('\x20');if(_0x444e68[_0x85bc07(0x1c0)]!==0x2||_0x444e68[0x0]!==_0x85bc07(0x1c2))return null;return _0x444e68[0x1];}[_0x53d5d3(0x1d7)](_0x57202e){const _0x50974b=_0x53d5d3;try{return jwt[_0x50974b(0x1aa)](_0x57202e,process[_0x50974b(0x1c7)][_0x50974b(0x1b7)]);}catch(_0x375968){throw new common_1[(_0x50974b(0x1b1))](_0x50974b(0x1ca),common_1[_0x50974b(0x1b4)][_0x50974b(0x1c8)]);}}[_0x53d5d3(0x1c3)](_0x5b8359,_0x58fed1,_0x30a830){const _0x47f32b=_0x53d5d3;if(_0x5b8359||!_0x58fed1){console['log'](_0x47f32b(0x1a7),_0x5b8359);throw _0x5b8359||new common_1['UnauthorizedException']();}return _0x58fed1;}};function _0x1fea(){const _0x1a0ff9=['verify','authService','8gRwhmR','authorization','defineProperty','__metadata','object','HttpException','4899empjIt','2795706yISubJ','HttpStatus','AuthService','checkTokenAuth','JWT_SECRET','createTokenFromFingerprint','50006nfpDAO','jsonwebtoken','AuthGuard','@nestjs/core','split','canActivate','../../modules/auth/auth.service','length','1225fEtrne','Bearer','handleRequest','headers','x-website-domain','RedisCacheService','env','UNAUTHORIZED','7WKRkpd','亲爱的用户,请登录后继续操作,我们正在等您的到来！','function','decorate','2439726ujPvtn','__esModule','2330sDtDwU','metadata','getRequest','jwt','moduleRef','redisCacheService','user','extractToken','validateToken','slice','ModuleRef','globalConfigService','@nestjs/common','getNineAiToken','fingerprint','218NGBwqT','JwtAuthGuard','@nestjs/passport','err:\x20','186736NELWou','145015OFqTPr'];_0x1fea=function(){return _0x1a0ff9;};return _0x1fea();}JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata('design:paramtypes',[redisCache_service_1[_0x53d5d3(0x1c6)],core_1[_0x53d5d3(0x1d9)],globalConfig_service_1['GlobalConfigService'],auth_service_1[_0x53d5d3(0x1b5)]])],JwtAuthGuard),exports[_0x53d5d3(0x1a5)]=JwtAuthGuard;