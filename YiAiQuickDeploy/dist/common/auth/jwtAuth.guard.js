'use strict';const _0x4f4af5=_0x5ade;(function(_0x6a9a1e,_0x1afc51){const _0x5bf884=_0x5ade,_0x37a163=_0x6a9a1e();while(!![]){try{const _0x2184b8=parseInt(_0x5bf884(0x18a))/0x1*(-parseInt(_0x5bf884(0x181))/0x2)+-parseInt(_0x5bf884(0x189))/0x3+-parseInt(_0x5bf884(0x19c))/0x4*(-parseInt(_0x5bf884(0x194))/0x5)+parseInt(_0x5bf884(0x19f))/0x6*(parseInt(_0x5bf884(0x1b3))/0x7)+parseInt(_0x5bf884(0x199))/0x8+-parseInt(_0x5bf884(0x1ad))/0x9+parseInt(_0x5bf884(0x190))/0xa*(-parseInt(_0x5bf884(0x195))/0xb);if(_0x2184b8===_0x1afc51)break;else _0x37a163['push'](_0x37a163['shift']());}catch(_0x2f1710){_0x37a163['push'](_0x37a163['shift']());}}}(_0x525b,0x59be0));function _0x525b(){const _0x53ece7=['../../modules/redisCache/redisCache.service','110bggbPT','metadata','HttpStatus','getNineAiToken','5JXTNeg','360096YmSdsd','defineProperty','getOwnPropertyDescriptor','RedisCacheService','755744aClHOA','@nestjs/passport','object','1898212wqcUEl','亲爱的用户,请登录后继续操作,我们正在等您的到来！','@nestjs/core','1305258zRRzLK','jwt','function','toString','HttpException','__metadata','createTokenFromFingerprint','validateToken','user','getRequest','slice','fingerprint','authService','GlobalConfigService','2556999NDKVJb','AuthGuard','moduleRef','Bearer','env','UnauthorizedException','21whJqJJ','headers','handleRequest','JwtAuthGuard','design:paramtypes','12852mOxOZG','authorization','verify','JWT_SECRET','extractToken','redisCacheService','switchToHttp','err:\x20','186183okoIrq','23VtjwMG','log','../../modules/globalConfig/globalConfig.service','length','__esModule'];_0x525b=function(){return _0x53ece7;};return _0x525b();}var __decorate=this&&this['__decorate']||function(_0xb46aa1,_0x5b6067,_0x280b49,_0x47c342){const _0x381c95=_0x5ade;var _0x273c50=arguments[_0x381c95(0x18d)],_0x37faf1=_0x273c50<0x3?_0x5b6067:_0x47c342===null?_0x47c342=Object[_0x381c95(0x197)](_0x5b6067,_0x280b49):_0x47c342,_0xdb36fb;if(typeof Reflect===_0x381c95(0x19b)&&typeof Reflect['decorate']===_0x381c95(0x1a1))_0x37faf1=Reflect['decorate'](_0xb46aa1,_0x5b6067,_0x280b49,_0x47c342);else{for(var _0x3b505b=_0xb46aa1[_0x381c95(0x18d)]-0x1;_0x3b505b>=0x0;_0x3b505b--)if(_0xdb36fb=_0xb46aa1[_0x3b505b])_0x37faf1=(_0x273c50<0x3?_0xdb36fb(_0x37faf1):_0x273c50>0x3?_0xdb36fb(_0x5b6067,_0x280b49,_0x37faf1):_0xdb36fb(_0x5b6067,_0x280b49))||_0x37faf1;}return _0x273c50>0x3&&_0x37faf1&&Object[_0x381c95(0x196)](_0x5b6067,_0x280b49,_0x37faf1),_0x37faf1;},__metadata=this&&this[_0x4f4af5(0x1a4)]||function(_0x54665b,_0x595f75){const _0x35dd4b=_0x4f4af5;if(typeof Reflect===_0x35dd4b(0x19b)&&typeof Reflect[_0x35dd4b(0x191)]===_0x35dd4b(0x1a1))return Reflect[_0x35dd4b(0x191)](_0x54665b,_0x595f75);};Object[_0x4f4af5(0x196)](exports,_0x4f4af5(0x18e),{'value':!![]}),exports[_0x4f4af5(0x1b6)]=void 0x0;const redisCache_service_1=require(_0x4f4af5(0x18f)),common_1=require('@nestjs/common'),passport_1=require(_0x4f4af5(0x19a)),jwt=require('jsonwebtoken'),core_1=require(_0x4f4af5(0x19e)),globalConfig_service_1=require(_0x4f4af5(0x18c)),auth_service_1=require('../../modules/auth/auth.service');function _0x5ade(_0x26b29c,_0x3ddb84){const _0x525b37=_0x525b();return _0x5ade=function(_0x5ade9b,_0x38c094){_0x5ade9b=_0x5ade9b-0x181;let _0x980243=_0x525b37[_0x5ade9b];return _0x980243;},_0x5ade(_0x26b29c,_0x3ddb84);}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x4f4af5(0x1ae)])(_0x4f4af5(0x1a0)){constructor(_0x1b2856,_0x22b453,_0x2349c1,_0x4e2e2b){const _0x4bbfe9=_0x4f4af5;super(),this['redisCacheService']=_0x1b2856,this[_0x4bbfe9(0x1af)]=_0x22b453,this['globalConfigService']=_0x2349c1,this[_0x4bbfe9(0x1ab)]=_0x4e2e2b;}async['canActivate'](_0x457d50){const _0x174ded=_0x4f4af5;!this[_0x174ded(0x186)]&&(this[_0x174ded(0x186)]=this[_0x174ded(0x1af)]['get'](redisCache_service_1[_0x174ded(0x198)],{'strict':![]}));const _0x4e5d54=_0x457d50[_0x174ded(0x187)]()[_0x174ded(0x1a8)](),_0x560d39=_0x4e5d54[_0x174ded(0x1b4)]['x-website-domain'],_0x253350=this[_0x174ded(0x185)](_0x4e5d54);_0x4e5d54[_0x174ded(0x1a7)]=this[_0x174ded(0x1a6)](_0x253350);const _0x13a038=this['globalConfigService'][_0x174ded(0x193)]();return await this['redisCacheService']['checkTokenAuth'](_0x253350,_0x4e5d54),!![];}['extractToken'](_0x580dac){const _0x3121d2=_0x4f4af5;if(!_0x580dac[_0x3121d2(0x1b4)][_0x3121d2(0x182)]){if(_0x580dac[_0x3121d2(0x1b4)]['fingerprint']){let _0x5db995=_0x580dac[_0x3121d2(0x1b4)][_0x3121d2(0x1aa)];_0x5db995>0x7fffffff&&(_0x5db995=_0x5db995[_0x3121d2(0x1a2)]()[_0x3121d2(0x1a9)](-0x9),_0x5db995=Number(String(Number(_0x5db995))));const _0x948287=this[_0x3121d2(0x1ab)][_0x3121d2(0x1a5)](_0x5db995);return _0x948287;}return null;}const _0x32bbf4=_0x580dac[_0x3121d2(0x1b4)][_0x3121d2(0x182)]['split']('\x20');if(_0x32bbf4[_0x3121d2(0x18d)]!==0x2||_0x32bbf4[0x0]!==_0x3121d2(0x1b0))return null;return _0x32bbf4[0x1];}[_0x4f4af5(0x1a6)](_0x2b4905){const _0x3bf217=_0x4f4af5;try{return jwt[_0x3bf217(0x183)](_0x2b4905,process[_0x3bf217(0x1b1)][_0x3bf217(0x184)]);}catch(_0x19da6a){throw new common_1[(_0x3bf217(0x1a3))](_0x3bf217(0x19d),common_1[_0x3bf217(0x192)]['UNAUTHORIZED']);}}[_0x4f4af5(0x1b5)](_0x1bb846,_0x129789,_0x3b2884){const _0x2a6e16=_0x4f4af5;if(_0x1bb846||!_0x129789){console[_0x2a6e16(0x18b)](_0x2a6e16(0x188),_0x1bb846);throw _0x1bb846||new common_1[(_0x2a6e16(0x1b2))]();}return _0x129789;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x4f4af5(0x1b7),[redisCache_service_1[_0x4f4af5(0x198)],core_1['ModuleRef'],globalConfig_service_1[_0x4f4af5(0x1ac)],auth_service_1['AuthService']])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;