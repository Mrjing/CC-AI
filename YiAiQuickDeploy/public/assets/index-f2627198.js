import{d as oe,o as r,c as d,B as me,u as de,g as ve,b as pe,r as m,e as L,f as ge,w as se,h as he,i as _e,a as e,n as R,F as M,j as N,k as i,l as p,T as xe,t as B,m as z,p as Z,q as a,_ as ee,N as te,s as E,v as ke,C as we,D as ye,E as P,G as be,A as Le,H as $e,z as Ce,I as Ie,L as De,J as ie,K as ce,M as Pe,O as Me,P as Ne}from"./index-58669c41.js";import{_ as Be}from"./titleBar.vue_vue_type_script_setup_true_lang-123250fe.js";import{t as Ee}from"./throttle-5584dbda.js";import{c as ze}from"./index-c94da121.js";import{N as je}from"./InputGroup-aac96321.js";const Se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},We=me('<path d="M432 112V96a48.14 48.14 0 0 0-48-48H64a48.14 48.14 0 0 0-48 48v256a48.14 48.14 0 0 0 48 48h16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></path><rect x="96" y="128" width="400" height="336" rx="45.99" ry="45.99" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><ellipse cx="372.92" cy="219.64" rx="30.77" ry="30.55" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></ellipse><path d="M342.15 372.17L255 285.78a30.93 30.93 0 0 0-42.18-1.21L96 387.64" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M265.23 464l118.59-117.73a31 31 0 0 1 41.46-1.87L496 402.91" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path>',5),Oe=[We],Te=oe({name:"ImagesOutline",render:function(j,$){return r(),d("svg",Se,Oe)}}),Ae={class:"min-h-full overflow-hidden flex flex-col"},He={class:"flex-1 min-h-full p-4 relative"},Ue=["id"],qe=["id","src","onLoad","onError","onClick"],Re={class:"menu p-2 text-[#cbd5e1]"},Ve={class:"prompt"},Fe={class:"flex justify-end items-end space-x-2"},Ge=["onClick"],Je={class:"text-sm dark:text-slate-400"},Ke=e("span",null,"画同款",-1),Qe=["onClick"],Xe={class:"text-sm dark:text-slate-400"},Ye=e("span",null,"使用当前画同款",-1),Ze=["onClick"],et={class:"text-sm dark:text-slate-400"},tt=e("span",null,"复制提示词",-1),st=e("div",{id:"footer",class:"w-full absolute bottom-[350px]"},null,-1),ue=oe({__name:"index",props:{dataList:{},scaleWidth:{},isDrawLike:{type:Boolean},usePropmpt:{type:Boolean},copyPropmpt:{type:Boolean},gap:{default:5},preOrigin:{type:Boolean}},emits:["loadMore","usePropmptDraw"],setup(V,{emit:j}){var w;const $=de(),h=V,k=j,S=(w=ve())==null?void 0:w.appContext.config.globalProperties.$viewerApi,F=pe(),y=m({}),g=m(0),v=m(160),_=m(0),b=m([]),C=m(null),I=m(0),G=L(()=>$.isLogin),W=L(()=>h.scaleWidth?Number(h.scaleWidth)*2+h.gap+150:150),O=ge();function u(){D(),T();const t=_.value,n=v.value,s=[];h.dataList.forEach((f,c)=>{const{width:X,height:Y}=f.fileInfo,ne=n/X,ae=Y*ne+h.gap+g.value,q=y.value[f.id];if(s.length<t)q.style.top="0px",q.style.left=`${(n+h.gap)*c}px`,s.push(ae);else{const le=Math.min.apply(null,s),re=s.findIndex(fe=>fe===le);q.style.top=`${le+0}px`,q.style.left=`${re*(v.value+h.gap)}px`,s[re]+=ae}}),I.value=Math.max(...s)+100}function J(t,n){t&&n&&(y.value[n.id]=t)}function D(){const{showName:t=0,showOther:n=0}={};g.value=[t,n].filter(s=>s).length*15}se(()=>h.scaleWidth,t=>{o()}),se(()=>h.dataList,t=>{t&&ke(()=>{o()})},{immediate:!0});function T(){if(!C.value)return;const t=C.value.clientWidth;_.value=Math.floor(t/W.value);const n=t-_.value*W.value,s=(_.value-1)*h.gap;n-s<0&&(_.value-=1),v.value=Math.floor((t-s)/_.value)}function A(t,n){b.value.push(n.id)}function H(t,n){b.value.push(n.id)}function U(t){if(!G.value)return $.setLoginDialog(!0);const{prompt:n}=t;ze({text:n}),F.success("复制prompt成功")}function K(t){O.push(`/midjourney?mjId=${t.id}`)}function Q(t){const{prompt:n}=t;k("usePropmptDraw",n)}function l(t){const{fileInfo:n}=t,{cosUrl:s}=n;S({options:{},images:[s]})}const x=L(()=>t=>{const{fileInfo:n}=t,{width:s,height:f}=n;return f/(s/v.value)}),o=Ee(function(){u()},200);return he(async()=>{window.addEventListener("resize",o);const t=document.getElementById("footer");new IntersectionObserver((s,f)=>{s.forEach(c=>{c.isIntersecting&&k("loadMore")})}).observe(t)}),_e(()=>{window.removeEventListener("resize",o)}),(t,n)=>(r(),d("div",Ae,[e("div",He,[e("div",{id:"wapper",ref_key:"wapperRef",ref:C,class:"wapper",style:R({height:`${I.value}px`})},[(r(!0),d(M,null,N(t.dataList,(s,f)=>(r(),d("div",{id:s.id,key:f,ref_for:!0,ref:c=>J(c,s),class:"wapper-item",style:R({width:`${v.value}px`})},[i(xe,{name:"img",css:!0},{default:p(()=>[e("img",{id:s.id,class:"item-file rounded-sm",style:R({width:`${v.value}px`,height:`${x.value(s)}px`}),src:t.preOrigin?s.fileInfo.cosUrl:s.fileInfo.thumbImg,loading:"lazy",onLoad:c=>A(c,s),onError:c=>H(c,s),onClick:c=>l(s)},null,44,qe)]),_:2},1024),e("div",Re,[e("div",Ve,B(s.fullPrompt),1),e("div",Fe,[t.isDrawLike?(r(),z(a(te),{key:0,trigger:"hover"},{trigger:p(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>K(s),["stop"])},[e("span",Je,[i(a(ee),{icon:"fluent:draw-image-24-regular",class:"text-sm"})])],8,Ge)]),default:p(()=>[Ke]),_:2},1024)):E("",!0),t.usePropmpt?(r(),z(a(te),{key:1,trigger:"hover"},{trigger:p(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>Q(s),["stop"])},[e("span",Xe,[i(a(ee),{icon:"fluent:draw-image-24-regular",class:"text-sm"})])],8,Qe)]),default:p(()=>[Ye]),_:2},1024)):E("",!0),t.copyPropmpt?(r(),z(a(te),{key:2,trigger:"hover"},{trigger:p(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>U(s),["stop"])},[e("span",et,[i(a(ee),{icon:"tabler:copy",class:"text-sm"})])],8,Ze)]),default:p(()=>[tt]),_:2},1024)):E("",!0)])]),b.value.includes(s.id)?E("",!0):(r(),d("div",{key:0,class:"item-loading",style:R({width:`${v.value}px`,height:`${x.value(s)}px`})},null,4))],12,Ue))),128)),st],4)])]))}});const ot={class:"flex my-5"},nt=e("p",{class:"mx-2 text-[#707384] select-none flex-shrink-0"}," Prompt示例： ",-1),at={class:"text-[#707384]"},lt=e("h4",{class:"text-base mb-2"}," 参数设置 ",-1),rt={class:"flex items-center mt-5"},it=e("span",{class:"mr-2 inline-block w-20 flex-shrink-0"},"图片尺寸:",-1),ct=["onClick"],ut={class:"flex items-center mt-5"},dt=e("span",{class:"mr-2 inline-block w-20 flex-shrink-0"},"图片质量:",-1),pt=["onClick"],ht=e("div",{class:"flex mt-5"},[e("h4",{class:"text-base mr-2 w-20 flex-shrink-0"}," 修饰词参考 "),e("p",{class:"text-[#707384]"}," 您可参考或选用下列各类修饰词丰富您的输入文本，尝试生成更加多样的图像，更多修饰词可参考 Prompt指南 或 自由输入 探索大模型作画更多未知能力 ")],-1),ft={class:"flex mt-5"},mt=e("h4",{class:"text-base mr-2 w-20 flex-shrink-0"}," 图像类型 ",-1),vt=["onClick"],gt={key:0,class:"mt-8 pb-10"},_t=e("div",{class:"flex justify-center"}," ----------- 正在生成中、图片越大数量越多所需时间越多、预计25S ----------- ",-1),xt={class:"flex flex-wrap mt-8"},kt={key:0,class:"min-h-screen"},wt={key:0,class:"min-h-screen"},It=oe({__name:"index",setup(V){const j=L(()=>S.theme),$=de(),h=L(()=>j.value==="dark"?"#fff":"#000"),{isMobile:k}=we(),S=ye(),F=L(()=>$.isLogin),y=m(0),g=m(!1),v=pe(),_=m([]),b=m([]),C=L(()=>S.theme==="dark");se(F,async(l,x)=>{l&&!x&&D()});const I=["超级逼真的未来世界，真实照片，虚幻引擎","帅哥，二次元，赛博朋克风格，精致脸庞","兔子，可爱，高质量，高品质"],G=[{label:"1024x1024",value:"1024x1024"},{label:"1024x1792",value:"1024x1792"},{label:"1792x1024",value:"1792x1024"}],W=[{label:"标准(2积分)",value:"standard"},{label:"优质(4积分)",value:"hd"}],O=["古风","二次元","写实照片","油画","水彩画","油墨画","黑白雕版画","雕塑","3D模型","手绘草图","炭笔画","极简线条画","电影质感","机械感"],u=m({prompt:"",n:1,size:"1024x1024",quality:"standard"});function J(){y.value=y.value+1>=I.length?0:y.value+1}async function D(){const l=await Me({model:"dall-e-3"});l.success&&(_.value=U(l.data))}async function T(){const l=await be({size:999,rec:1,model:"dall-e-3"});if(!l.success)return v.error(l.message);b.value=U(l.data.rows)}function A(){}function H(l){u.value.prompt=l}function U(l){if(!l)return[];const x=[];return l.forEach(o=>{const{id:w,fileInfo:t,prompt:n,thumbImg:s}=o;let f=null;if(typeof t=="string")try{f=JSON.parse(t)}catch{f={}}else f=t||{};const{width:c,height:X,cosUrl:Y}=f;x.push({id:w,prompt:n,fullPrompt:n,fileInfo:{thumbImg:s,width:c,height:X,cosUrl:Y}})}),x.filter(o=>o.fileInfo&&o.fileInfo.width)}async function K(){if(!u.value.prompt)return v.error("请输入您想要生成的图片描述信息！");try{g.value=!0,await Ne(u.value),v.success("生成图片成完成、前往我的生成查看图片！"),await D(),g.value=!1}catch{g.value=!1}}function Q(l){l==="mine"&&D(),l==="all"&&T()}return he(()=>{T()}),(l,x)=>(r(),d("div",{class:P(["main min-h-screen bg-center dark:bg-[#2F2E34]",[C.value?"darkBg":"lightBg",a(k)?"px-3":"px-10"]])},[i(a(Be),{title:"DALL-E绘画",des:"基于DALL-E的绘画、速度较快、同步等待到结束后在我的绘画中可以看到结果！",padding:a(k)?2:20},null,8,["padding"]),e("div",{class:P(a(k)?["px-2"]:["px-20"])},[e("div",ot,[e("b",{class:"text-primary cursor-pointer select-none flex-shrink-0",onClick:J},"换示例"),nt,e("p",at,B(I[y.value]),1)]),i(a(je),null,{default:p(()=>[i(a(Le),{value:u.value.prompt,"onUpdate:value":x[0]||(x[0]=o=>u.value.prompt=o),disabled:g.value,clearable:"",placeholder:"请输入您想要生成的图片描述信息、可以参考上面的示例文字、我们将会对其转为英文绘画、请知悉！"},null,8,["value","disabled"]),i(a($e),{type:"success",loading:g.value,disabled:g.value,onClick:K},{icon:p(()=>[i(a(Ce),null,{default:p(()=>[i(a(Te))]),_:1})]),default:p(()=>[Ie(" 生成图片 ")]),_:1},8,["loading","disabled"])]),_:1}),e("div",{class:P(["mt-5 py-4 bg-[#e7eaf380] dark:bg-[#2c2c32] rounded-lg",a(k)?"px-0":"px-4"])},[lt,e("div",rt,[it,e("div",null,[(r(),d(M,null,N(G,o=>e("span",{key:o.value,class:P(["rounded ml-2 select-none cursor-pointer inline-block mb-2",[o.value===u.value.size?["text-primary","bg-[#0d6efd1c]"]:["bg-[#bfc4d033]"],a(k)?"px-1.5 py-0.5":"px-3 py-1"]]),onClick:w=>u.value.size=o.value},B(o.label),11,ct)),64))])]),e("div",ut,[dt,e("div",null,[(r(),d(M,null,N(W,o=>e("span",{key:o.value,class:P(["py-0.5 px-2.5 rounded ml-2 select-none cursor-pointer inline-block mb-2",o.value===u.value.quality?["text-primary","bg-[#0d6efd1c]"]:["bg-[#bfc4d033]"]]),onClick:w=>u.value.quality=o.value},B(o.label),11,pt)),64))])]),ht,e("div",ft,[mt,e("div",null,[(r(),d(M,null,N(O,(o,w)=>e("span",{key:o,class:"cursor-pointer hover:text-primary",onClick:t=>u.value.prompt+=u.value.prompt?`，${o}`:o},B(`${o} ${w+1===O.length?"":"、"}`),9,vt)),64))])])],2),g.value?(r(),d("div",gt,[_t,e("div",xt,[(r(!0),d(M,null,N(u.value.n,o=>(r(),d("div",{class:"w-44 h-44 border rounded-md relative ml-4 mt-4",key:o},[i(De,{"text-color":h.value,words:["图","片","绘","制","中"]},null,8,["text-color"])]))),128))])])):E("",!0),i(a(Pe),{type:"line",animated:"",class:"mt-5","onUpdate:value":Q},{default:p(()=>[i(a(ie),{name:"all",tab:"公共生成"},{default:p(()=>[b.value.length?(r(),d("div",kt,[i(ue,{onLoadMore:A,usePropmpt:"",gap:8,preOrigin:"",onUsePropmptDraw:H,dataList:b.value,scaleWidth:50},null,8,["dataList"])])):(r(),z(a(ce),{key:1,size:"huge",class:"mt-20",description:"暂无数据哟~"}))]),_:1}),i(a(ie),{name:"mine",tab:"我的生成"},{default:p(()=>[_.value.length?(r(),d("div",wt,[i(ue,{onLoadMore:A,usePropmpt:"",gap:8,preOrigin:"",onUsePropmptDraw:H,dataList:_.value,scaleWidth:50},null,8,["dataList"])])):(r(),z(a(ce),{key:1,size:"huge",class:"mt-20",description:"暂无数据哟~"}))]),_:1})]),_:1})],2)],2))}});export{It as default};
